import{u as j,C as A,x as P,r as d,K as R,d as x,D as B,L as E,c as i,o as a,a as e,y as u,M as q,F as y,h as g,A as _,f as D,t as m,g as H,j as O,z as T,N as $,m as z}from"./main-DmsOSjqV.js";import{u as G}from"./listings-DsPliTSu.js";import{_ as K}from"./ListingCard-BW338Uij.js";import"./dayjs.min-Bof1u0Bp.js";import"./relativeTime-Ckc_g6N8.js";import"./SparklesIcon-B1IhDDIx.js";import"./BoltIcon-B9-sSpPA.js";import"./MapPinIcon-CMxz0EB0.js";import"./ClockIcon-eSH_VvUn.js";const Q={class:"min-h-screen bg-gray-50"},I={class:"container-app py-6"},J={class:"flex flex-col lg:flex-row gap-6"},W={class:"lg:w-64 flex-shrink-0"},X={class:"card p-4 sticky top-20"},Y={class:"mb-6"},Z=["value"],ee={class:"mb-6"},te={class:"mb-6"},se={class:"flex items-center gap-2"},le={class:"mb-6"},oe={class:"space-y-2"},ae=["onUpdate:modelValue","value"],ie={class:"ml-2 text-sm text-gray-600"},ne={class:"flex-1"},re={class:"flex items-center justify-between mb-4"},ue={class:"text-xl font-bold text-gray-900"},ce={class:"text-sm text-gray-500"},de={key:0,class:"grid grid-cols-2 md:grid-cols-3 gap-4"},me={key:1,class:"grid grid-cols-2 md:grid-cols-3 gap-4"},pe={key:2,class:"card p-12 text-center"},ve={key:3,class:"mt-6 text-center"},ye=["disabled"],Le={__name:"Search",setup(ge){const p=j(),C=A(),L=P(),M=G(),c=d(!1),n=d([]),b=d(0),f=d(1),h=d(1),l=R({q:"",category:"",city:"",min_price:"",max_price:"",condition:"",sort:"newest"}),V=[{value:"",label:"All Conditions"},{value:"new",label:"New"},{value:"like_new",label:"Like New"},{value:"good",label:"Good"},{value:"fair",label:"Fair"}],F=x(()=>L.categories),w=x(()=>l.q),N=x(()=>f.value<h.value),r=async(o=!1)=>{c.value=!0;try{const t={...l,page:o?f.value+1:1};Object.keys(t).forEach(v=>{t[v]||delete t[v]});const s=await M.fetchListings(t,o);o?n.value=[...n.value,...s.data]:n.value=s.data,b.value=s.meta.total,f.value=s.meta.current_page,h.value=s.meta.last_page,C.replace({query:t})}finally{c.value=!1}},S=()=>{r(!0)},U=()=>{r()},k=()=>{Object.keys(l).forEach(o=>{l[o]=o==="sort"?"newest":""}),r()};return B(()=>{const o=p.query;o.q&&(l.q=o.q),o.category&&(l.category=o.category),o.city&&(l.city=o.city),o.min_price&&(l.min_price=o.min_price),o.max_price&&(l.max_price=o.max_price),o.condition&&(l.condition=o.condition),o.sort&&(l.sort=o.sort),r()}),E(()=>p.query,()=>{p.query.q!==l.q&&(l.q=p.query.q||"",r())}),(o,t)=>(a(),i("div",Q,[e("div",I,[e("div",J,[e("aside",W,[e("div",X,[e("div",{class:"flex items-center justify-between mb-4"},[t[5]||(t[5]=e("h3",{class:"font-semibold text-gray-900"},"Filters",-1)),e("button",{onClick:k,class:"text-sm text-primary-600 hover:underline"}," Clear all ")]),e("div",Y,[t[7]||(t[7]=e("h4",{class:"font-medium text-gray-700 mb-2"},"Category",-1)),u(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>l.category=s),class:"input text-sm"},[t[6]||(t[6]=e("option",{value:""},"All Categories",-1)),(a(!0),i(y,null,g(F.value,s=>(a(),i("option",{key:s.id,value:s.slug},m(s.name),9,Z))),128))],512),[[q,l.category]])]),e("div",ee,[t[8]||(t[8]=e("h4",{class:"font-medium text-gray-700 mb-2"},"Location",-1)),u(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>l.city=s),type:"text",placeholder:"Enter city",class:"input text-sm"},null,512),[[_,l.city]])]),e("div",te,[t[10]||(t[10]=e("h4",{class:"font-medium text-gray-700 mb-2"},"Price Range",-1)),e("div",se,[u(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>l.min_price=s),type:"number",placeholder:"Min",class:"input text-sm"},null,512),[[_,l.min_price]]),t[9]||(t[9]=e("span",{class:"text-gray-400"},"-",-1)),u(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>l.max_price=s),type:"number",placeholder:"Max",class:"input text-sm"},null,512),[[_,l.max_price]])])]),e("div",le,[t[11]||(t[11]=e("h4",{class:"font-medium text-gray-700 mb-2"},"Condition",-1)),e("div",oe,[(a(),i(y,null,g(V,s=>e("label",{key:s.value,class:"flex items-center"},[u(e("input",{type:"radio","onUpdate:modelValue":v=>l.condition=v,value:s.value,class:"text-primary-600"},null,8,ae),[[$,l.condition]]),e("span",ie,m(s.label),1)])),64))])]),e("button",{onClick:U,class:"btn-primary w-full"}," Apply Filters ")])]),e("main",ne,[e("div",re,[e("div",null,[e("h1",ue,m(w.value?`Results for "${w.value}"`:"All Listings"),1),e("p",ce,m(b.value)+" results found",1)]),u(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>l.sort=s),onChange:r,class:"input w-auto text-sm"},[...t[12]||(t[12]=[e("option",{value:"newest"},"Newest First",-1),e("option",{value:"price_low"},"Price: Low to High",-1),e("option",{value:"price_high"},"Price: High to Low",-1),e("option",{value:"popular"},"Most Popular",-1)])],544),[[q,l.sort]])]),c.value&&!n.value.length?(a(),i("div",de,[(a(),i(y,null,g(9,s=>e("div",{key:s,class:"card p-4"},[...t[13]||(t[13]=[e("div",{class:"skeleton h-40 mb-3"},null,-1),e("div",{class:"skeleton h-4 w-20 mb-2"},null,-1),e("div",{class:"skeleton h-4 w-full mb-2"},null,-1),e("div",{class:"skeleton h-3 w-24"},null,-1)])])),64))])):n.value.length?(a(),i("div",me,[(a(!0),i(y,null,g(n.value,s=>(a(),z(K,{key:s.id,listing:s},null,8,["listing"]))),128))])):(a(),i("div",pe,[H(O(T),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),t[14]||(t[14]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No results found",-1)),t[15]||(t[15]=e("p",{class:"text-gray-500 mb-4"},"Try adjusting your search or filters",-1)),e("button",{onClick:k,class:"btn-primary"}," Clear Filters ")])),N.value?(a(),i("div",ve,[e("button",{onClick:S,disabled:c.value,class:"btn-secondary"},m(c.value?"Loading...":"Load More"),9,ye)])):D("",!0)])])])]))}};export{Le as default};
