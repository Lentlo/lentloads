var _=(k,y,n)=>new Promise((c,s)=>{var d=l=>{try{u(n.next(l))}catch(f){s(f)}},p=l=>{try{u(n.throw(l))}catch(f){s(f)}},u=l=>l.done?c(l.value):Promise.resolve(l.value).then(d,p);u((n=n.apply(k,y)).next())});import{u as V}from"./listings-BycPGJTy.js";import{toast as h}from"./ui-vendor-B7DvqItC.js";import{d as C}from"./dayjs.min-_KBCEsvO.js";import{r as $}from"./relativeTime-2Po48zfX.js";import{c as D,f as P,e as T}from"./main-capacitor-BlsodQL6.js";import{f as v,b as z,o as E,v as O,k as o,l as r,p as t,x,B as m,F as L,I as M,a as g,A as b,y as N,C as S}from"./vue-vendor-Clry8SR-.js";const R={class:"favorites-page min-h-screen bg-gray-50"},q={class:"container-app py-6"},G={class:"flex items-center justify-between mb-6"},H={class:"text-gray-500"},I={key:0,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},J={key:1,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},K=["onClick"],Q={class:"aspect-[4/3] bg-gray-100"},U=["src","alt"],W={key:0,class:"absolute inset-0 bg-black/50 flex items-center justify-center"},X={class:"p-4"},Y={class:"text-lg font-bold text-gray-900"},Z={class:"text-gray-700 font-medium line-clamp-2 mt-1"},ee={class:"flex items-center mt-2 text-sm text-gray-500"},te={class:"text-xs text-gray-400 mt-1"},se={key:2,class:"card p-12 text-center"},ae={key:3,class:"mt-6 text-center"},oe=["disabled"],me={__name:"Favorites",setup(k){C.extend($);const y=V(),n=v(!0),c=v(!1),s=v([]),d=v(0),p=v(1),u=v(1),l=z(()=>p.value<u.value),f=i=>C(i).fromNow(),w=(i=!1)=>_(this,null,function*(){i?c.value=!0:n.value=!0;try{const e=yield y.fetchFavorites();i?s.value=[...s.value,...e.data]:s.value=e.data,d.value=e.meta.total,p.value=e.meta.current_page,u.value=e.meta.last_page}finally{n.value=!1,c.value=!1}}),j=i=>_(this,null,function*(){try{yield y.toggleFavorite(i),s.value=s.value.filter(e=>e.id!==i),d.value--,h.success("Removed from favorites")}catch(e){h.error("Failed to remove from favorites")}}),B=()=>_(this,null,function*(){if(confirm("Are you sure you want to clear all favorites?"))try{yield api.delete("/favorites/clear"),s.value=[],d.value=0,h.success("All favorites cleared")}catch(i){h.error("Failed to clear favorites")}}),A=()=>{w(!0)};return E(()=>{w()}),(i,e)=>{const F=O("router-link");return r(),o("div",R,[t("div",q,[t("div",G,[t("div",null,[e[0]||(e[0]=t("h1",{class:"text-2xl font-bold text-gray-900"},"My Favorites",-1)),t("p",H,m(d.value)+" saved items",1)]),s.value.length?(r(),o("button",{key:0,onClick:B,class:"text-sm text-red-600 hover:underline"}," Clear all ")):x("",!0)]),n.value?(r(),o("div",I,[(r(),o(L,null,M(8,a=>t("div",{key:a,class:"card p-4"},[...e[1]||(e[1]=[t("div",{class:"skeleton h-40 mb-3"},null,-1),t("div",{class:"skeleton h-4 w-20 mb-2"},null,-1),t("div",{class:"skeleton h-4 w-full"},null,-1)])])),64))])):s.value.length?(r(),o("div",J,[(r(!0),o(L,null,M(s.value,a=>(r(),o("div",{key:a.id,class:"card-hover group relative"},[t("button",{onClick:re=>j(a.id),class:"absolute top-2 right-2 z-10 w-8 h-8 bg-white rounded-full shadow flex items-center justify-center opacity-0 group-hover:opacity-100 transition"},[g(b(P),{class:"w-5 h-5 text-gray-600"})],8,K),g(F,{to:`/listing/${a.slug}`},{default:N(()=>[t("div",Q,[t("img",{src:a.primary_image_url,alt:a.title,class:"w-full h-full object-cover"},null,8,U),a.status==="sold"?(r(),o("div",W,[...e[2]||(e[2]=[t("span",{class:"bg-white text-gray-900 px-4 py-2 rounded-lg font-semibold"}," SOLD ",-1)])])):x("",!0)]),t("div",X,[t("p",Y,m(a.formatted_price),1),t("h3",Z,m(a.title),1),t("div",ee,[g(b(T),{class:"w-4 h-4 mr-1"}),S(" "+m(a.location),1)]),t("p",te," Saved "+m(f(a.favorited_at)),1)])]),_:2},1032,["to"])]))),128))])):(r(),o("div",se,[g(b(D),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e[4]||(e[4]=t("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No favorites yet",-1)),e[5]||(e[5]=t("p",{class:"text-gray-500 mb-4"},"Save items you like by clicking the heart icon",-1)),g(F,{to:"/search",class:"btn-primary"},{default:N(()=>[...e[3]||(e[3]=[S(" Browse Listings ",-1)])]),_:1})])),l.value?(r(),o("div",ae,[t("button",{onClick:A,disabled:c.value,class:"btn-secondary"},m(c.value?"Loading...":"Load More"),9,oe)])):x("",!0)])])}}};export{me as default};
