import{l as h,u as D,r as b,D as M,b as C,m as j,n as Y,c as n,o as r,a as t,O as B,w as o,G as y,F as f,j as x,v as u,t as v,q as T,g as I,d as w,e as S,y as O,h as R,f as E,K as U}from"./main-2lsW-tbY.js";import{u as G}from"./listings-M4pNLF7o.js";import{r as W}from"./CameraIcon-7fJPcaf6.js";const $={class:"min-h-screen bg-gray-50 py-6"},K={class:"container-app max-w-3xl"},z={class:"card p-6"},H=["label"],J=["value"],Q={class:"text-sm text-gray-500 mt-1"},X={class:"text-sm text-gray-500 mt-1"},Z={class:"grid grid-cols-2 gap-4"},_={class:"relative"},ee={class:"grid grid-cols-2 gap-4"},te={class:"grid grid-cols-4 gap-4"},le=["src"],se=["onClick"],oe={key:0,class:"aspect-square bg-gray-100 rounded-lg border-2 border-dashed border-gray-300 flex flex-col items-center justify-center cursor-pointer hover:border-primary-500 hover:bg-primary-50"},ie={class:"border-t pt-6"},ae={class:"grid grid-cols-2 gap-4"},ne={class:"border-t pt-6 flex justify-end gap-4"},re=["disabled"],ce={__name:"CreateListing",setup(de){const L=h(),g=D(),P=G(),c=b(!1),p=b([]),m=b([]),l=M({category_id:"",title:"",description:"",price:"",price_type:"fixed",condition:"",brand:"",model:"",city:"",state:""}),F=C(()=>g.categories),V=C(()=>l.category_id&&l.title&&l.description&&l.price!==""&&l.city&&p.value.length>0),q=a=>{const e=Array.from(a.target.files),d=10-p.value.length;e.slice(0,d).forEach(s=>{if(s.type.startsWith("image/")){p.value.push(s);const i=new FileReader;i.onload=k=>{m.value.push(k.target.result)},i.readAsDataURL(s)}})},N=a=>{p.value.splice(a,1),m.value.splice(a,1)},A=async()=>{var a,e;if(V.value){c.value=!0;try{const d={...l,images:p.value};await P.createListing(d),U.success("Your ad has been submitted for review!"),L.push("/my-listings")}catch(d){U.error(((e=(a=d.response)==null?void 0:a.data)==null?void 0:e.message)||"Failed to create listing")}finally{c.value=!1}}};return j(()=>{g.currentLocation&&(l.city=g.currentLocation.city,l.state=g.currentLocation.state)}),(a,e)=>{const d=Y("router-link");return r(),n("div",$,[t("div",K,[t("div",z,[e[29]||(e[29]=t("h1",{class:"text-2xl font-bold text-gray-900 mb-6"},"Post Your Ad",-1)),t("form",{onSubmit:B(A,["prevent"]),class:"space-y-6"},[t("div",null,[e[11]||(e[11]=t("label",{class:"label"},"Category *",-1)),o(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>l.category_id=s),required:"",class:"input"},[e[10]||(e[10]=t("option",{value:""},"Select a category",-1)),(r(!0),n(f,null,x(F.value,s=>(r(),n("optgroup",{key:s.id,label:s.name},[(r(!0),n(f,null,x(s.children,i=>(r(),n("option",{key:i.id,value:i.id},v(i.name),9,J))),128))],8,H))),128))],512),[[y,l.category_id]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"label"},"Title *",-1)),o(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>l.title=s),type:"text",maxlength:"100",required:"",class:"input",placeholder:"What are you selling?"},null,512),[[u,l.title]]),t("p",Q,v(l.title.length)+"/100",1)]),t("div",null,[e[13]||(e[13]=t("label",{class:"label"},"Description *",-1)),o(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=s=>l.description=s),rows:"5",maxlength:"5000",required:"",class:"input",placeholder:"Describe your item in detail..."},null,512),[[u,l.description]]),t("p",X,v(l.description.length)+"/5000",1)]),t("div",Z,[t("div",null,[e[15]||(e[15]=t("label",{class:"label"},"Price *",-1)),t("div",_,[e[14]||(e[14]=t("span",{class:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500"},"â‚¹",-1)),o(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>l.price=s),type:"number",min:"0",required:"",class:"input pl-8",placeholder:"0"},null,512),[[u,l.price]])])]),t("div",null,[e[17]||(e[17]=t("label",{class:"label"},"Price Type",-1)),o(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>l.price_type=s),class:"input"},[...e[16]||(e[16]=[t("option",{value:"fixed"},"Fixed",-1),t("option",{value:"negotiable"},"Negotiable",-1),t("option",{value:"free"},"Free",-1),t("option",{value:"contact"},"Contact for Price",-1)])],512),[[y,l.price_type]])])]),t("div",null,[e[19]||(e[19]=t("label",{class:"label"},"Condition",-1)),o(t("select",{"onUpdate:modelValue":e[5]||(e[5]=s=>l.condition=s),class:"input"},[...e[18]||(e[18]=[T('<option value="">Select condition</option><option value="new">New</option><option value="like_new">Like New</option><option value="good">Good</option><option value="fair">Fair</option><option value="poor">Poor</option>',6)])],512),[[y,l.condition]])]),t("div",ee,[t("div",null,[e[20]||(e[20]=t("label",{class:"label"},"Brand (Optional)",-1)),o(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>l.brand=s),type:"text",class:"input",placeholder:"e.g., Apple"},null,512),[[u,l.brand]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"label"},"Model (Optional)",-1)),o(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>l.model=s),type:"text",class:"input",placeholder:"e.g., iPhone 15"},null,512),[[u,l.model]])])]),t("div",null,[e[23]||(e[23]=t("label",{class:"label"},"Photos * (Max 10)",-1)),t("div",te,[(r(!0),n(f,null,x(m.value,(s,i)=>(r(),n("div",{key:i,class:"relative aspect-square bg-gray-100 rounded-lg overflow-hidden"},[t("img",{src:s,class:"w-full h-full object-cover"},null,8,le),t("button",{type:"button",onClick:k=>N(i),class:"absolute top-1 right-1 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center"},[w(S(E),{class:"w-4 h-4"})],8,se)]))),128)),m.value.length<10?(r(),n("label",oe,[w(S(W),{class:"w-8 h-8 text-gray-400 mb-1"}),e[22]||(e[22]=t("span",{class:"text-sm text-gray-500"},"Add Photo",-1)),t("input",{type:"file",accept:"image/*",multiple:"",class:"hidden",onChange:q},null,32)])):I("",!0)]),e[24]||(e[24]=t("p",{class:"text-sm text-gray-500 mt-2"},"First image will be the cover photo",-1))]),t("div",ie,[e[27]||(e[27]=t("h3",{class:"font-semibold text-gray-900 mb-4"},"Your Location",-1)),t("div",ae,[t("div",null,[e[25]||(e[25]=t("label",{class:"label"},"City *",-1)),o(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>l.city=s),type:"text",required:"",class:"input",placeholder:"Your city"},null,512),[[u,l.city]])]),t("div",null,[e[26]||(e[26]=t("label",{class:"label"},"State",-1)),o(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>l.state=s),type:"text",class:"input",placeholder:"Your state"},null,512),[[u,l.state]])])])]),t("div",ne,[w(d,{to:"/my-listings",class:"btn-secondary"},{default:O(()=>[...e[28]||(e[28]=[R(" Cancel ",-1)])]),_:1}),t("button",{type:"submit",disabled:c.value||!V.value,class:"btn-primary"},v(c.value?"Posting...":"Post Ad"),9,re)])],32)])])])}}};export{ce as default};
