import{C as M,x as q,r as b,K as D,d as k,D as j,e as B,c as a,o as n,a as t,S as T,y as r,M as f,F as x,h as w,A as p,t as y,E,f as I,g as v,j as C,w as R,i as Y,l as $,Q as S}from"./main-s6bW8Jl1.js";import{u as O}from"./listings-BUJ2D12i.js";import{_ as W}from"./LocationPicker-D8Rlb2gZ.js";import{r as G}from"./CameraIcon-D0LOwCaK.js";import"./leaflet-Bln94WRs.js";import"./_commonjsHelpers-Cpj98o6Y.js";const K={class:"min-h-screen bg-gray-50 py-6"},Q={class:"container-app max-w-3xl"},z={class:"card p-6"},H=["label"],J=["value"],X={class:"text-sm text-gray-500 mt-1"},Z={class:"text-sm text-gray-500 mt-1"},ee={class:"grid grid-cols-2 gap-4"},te={class:"relative"},le={class:"grid grid-cols-2 gap-4"},oe={class:"grid grid-cols-4 gap-4"},se=["src"],ie=["onClick"],ae={key:0,class:"aspect-square bg-gray-100 rounded-lg border-2 border-dashed border-gray-300 flex flex-col items-center justify-center cursor-pointer hover:border-primary-500 hover:bg-primary-50"},ne={class:"border-t pt-6"},re={class:"border-t pt-6 flex justify-end gap-4"},de=["disabled"],be={__name:"CreateListing",setup(ue){const U=M(),c=q(),L=O(),g=b(!1),u=b([]),m=b([]),l=D({category_id:"",title:"",description:"",price:"",price_type:"fixed",condition:"",brand:"",model:"",city:"",state:"",locality:"",postal_code:"",latitude:null,longitude:null}),P=k(()=>c.categories),V=k(()=>l.category_id&&l.title&&l.description&&l.price!==""&&l.city&&u.value.length>0),F=s=>{const e=Array.from(s.target.files),d=10-u.value.length;e.slice(0,d).forEach(o=>{if(o.type.startsWith("image/")){u.value.push(o);const i=new FileReader;i.onload=h=>{m.value.push(h.target.result)},i.readAsDataURL(o)}})},A=s=>{u.value.splice(s,1),m.value.splice(s,1)},N=s=>{l.city=s.city,l.state=s.state,l.locality=s.locality,l.postal_code=s.postal_code,l.latitude=s.latitude,l.longitude=s.longitude},_=async()=>{var s,e;if(V.value){g.value=!0;try{const d={...l,images:u.value};await L.createListing(d),S.success("Your ad has been submitted for review!"),U.push("/my-listings")}catch(d){S.error(((e=(s=d.response)==null?void 0:s.data)==null?void 0:e.message)||"Failed to create listing")}finally{g.value=!1}}};return j(()=>{c.currentLocation&&(l.city=c.currentLocation.city,l.state=c.currentLocation.state)}),(s,e)=>{const d=B("router-link");return n(),a("div",K,[t("div",Q,[t("div",z,[e[25]||(e[25]=t("h1",{class:"text-2xl font-bold text-gray-900 mb-6"},"Post Your Ad",-1)),t("form",{onSubmit:T(_,["prevent"]),class:"space-y-6"},[t("div",null,[e[9]||(e[9]=t("label",{class:"label"},"Category *",-1)),r(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>l.category_id=o),required:"",class:"input"},[e[8]||(e[8]=t("option",{value:""},"Select a category",-1)),(n(!0),a(x,null,w(P.value,o=>(n(),a("optgroup",{key:o.id,label:o.name},[(n(!0),a(x,null,w(o.children,i=>(n(),a("option",{key:i.id,value:i.id},y(i.name),9,J))),128))],8,H))),128))],512),[[f,l.category_id]])]),t("div",null,[e[10]||(e[10]=t("label",{class:"label"},"Title *",-1)),r(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>l.title=o),type:"text",maxlength:"100",required:"",class:"input",placeholder:"What are you selling?"},null,512),[[p,l.title]]),t("p",X,y(l.title.length)+"/100",1)]),t("div",null,[e[11]||(e[11]=t("label",{class:"label"},"Description *",-1)),r(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=o=>l.description=o),rows:"5",maxlength:"5000",required:"",class:"input",placeholder:"Describe your item in detail..."},null,512),[[p,l.description]]),t("p",Z,y(l.description.length)+"/5000",1)]),t("div",ee,[t("div",null,[e[13]||(e[13]=t("label",{class:"label"},"Price *",-1)),t("div",te,[e[12]||(e[12]=t("span",{class:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500"},"â‚¹",-1)),r(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>l.price=o),type:"number",min:"0",required:"",class:"input pl-8",placeholder:"0"},null,512),[[p,l.price]])])]),t("div",null,[e[15]||(e[15]=t("label",{class:"label"},"Price Type",-1)),r(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>l.price_type=o),class:"input"},[...e[14]||(e[14]=[t("option",{value:"fixed"},"Fixed",-1),t("option",{value:"negotiable"},"Negotiable",-1),t("option",{value:"free"},"Free",-1),t("option",{value:"contact"},"Contact for Price",-1)])],512),[[f,l.price_type]])])]),t("div",null,[e[17]||(e[17]=t("label",{class:"label"},"Condition",-1)),r(t("select",{"onUpdate:modelValue":e[5]||(e[5]=o=>l.condition=o),class:"input"},[...e[16]||(e[16]=[E('<option value="">Select condition</option><option value="new">New</option><option value="like_new">Like New</option><option value="good">Good</option><option value="fair">Fair</option><option value="poor">Poor</option>',6)])],512),[[f,l.condition]])]),t("div",le,[t("div",null,[e[18]||(e[18]=t("label",{class:"label"},"Brand (Optional)",-1)),r(t("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>l.brand=o),type:"text",class:"input",placeholder:"e.g., Apple"},null,512),[[p,l.brand]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"label"},"Model (Optional)",-1)),r(t("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>l.model=o),type:"text",class:"input",placeholder:"e.g., iPhone 15"},null,512),[[p,l.model]])])]),t("div",null,[e[21]||(e[21]=t("label",{class:"label"},"Photos * (Max 10)",-1)),t("div",oe,[(n(!0),a(x,null,w(m.value,(o,i)=>(n(),a("div",{key:i,class:"relative aspect-square bg-gray-100 rounded-lg overflow-hidden"},[t("img",{src:o,class:"w-full h-full object-cover"},null,8,se),t("button",{type:"button",onClick:h=>A(i),class:"absolute top-1 right-1 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center"},[v(C($),{class:"w-4 h-4"})],8,ie)]))),128)),m.value.length<10?(n(),a("label",ae,[v(C(G),{class:"w-8 h-8 text-gray-400 mb-1"}),e[20]||(e[20]=t("span",{class:"text-sm text-gray-500"},"Add Photo",-1)),t("input",{type:"file",accept:"image/*",multiple:"",class:"hidden",onChange:F},null,32)])):I("",!0)]),e[22]||(e[22]=t("p",{class:"text-sm text-gray-500 mt-2"},"First image will be the cover photo",-1))]),t("div",ne,[e[23]||(e[23]=t("h3",{class:"font-semibold text-gray-900 mb-4"},"Your Location",-1)),v(W,{"initial-city":l.city,"initial-state":l.state,"onUpdate:location":N},null,8,["initial-city","initial-state"])]),t("div",re,[v(d,{to:"/my-listings",class:"btn-secondary"},{default:R(()=>[...e[24]||(e[24]=[Y(" Cancel ",-1)])]),_:1}),t("button",{type:"submit",disabled:g.value||!V.value,class:"btn-primary"},y(g.value?"Posting...":"Post Ad"),9,de)])],32)])])])}}};export{be as default};
