import{c as i,o as r,a as s,u as A,H as D,I as E,d as p,e as V,A as H,f as z,h as n,w as g,k as l,j as b,V as F,g as h,L as k,O as I,W as L,n as c,F as U,i as Z,q as $,t as _,D as G}from"./main-rx1Mbjb2.js";import{_ as W}from"./LoadingSpinner-Bo3NK-cG.js";import{r as Y}from"./CheckCircleIcon-Dv51bjGj.js";import{r as O}from"./ExclamationCircleIcon-B75bpiFg.js";import{r as q}from"./LockClosedIcon-bEH2fmAI.js";import{r as N}from"./EyeIcon-SSXbZMTX.js";import{r as R}from"./EyeSlashIcon-BUFrew1j.js";function J(S,w){return r(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25Z"})])}const K={class:"min-h-screen bg-gray-50 flex items-center justify-center p-4"},Q={class:"w-full max-w-md"},X={class:"text-center mb-8"},ee={class:"card p-8"},se={key:0,class:"text-center"},te={class:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4"},ae={key:1,class:"text-center"},re={class:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4"},oe={key:2},le={class:"text-center mb-6"},ne={class:"w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-4"},ie={class:"relative"},de=["type"],ue={class:"relative"},pe=["type"],me={key:0,class:"space-y-2"},ce={class:"flex gap-1"},we={key:1,class:"text-sm text-red-600"},fe=["disabled"],_e={__name:"ResetPassword",setup(S){const w=A();D();const t=E({email:"",password:"",password_confirmation:"",token:""}),f=p(!1),v=p(!1),m=p(!1),C=p(!1),x=p(!1),d=p(""),j=["","Weak","Fair","Good","Strong"],M=["","bg-red-500","bg-yellow-500","bg-blue-500","bg-green-500"],B=["","text-red-600","text-yellow-600","text-blue-600","text-green-600"],y=V(()=>{const o=t.password;if(!o)return 0;let e=0;return o.length>=8&&e++,/[a-z]/.test(o)&&/[A-Z]/.test(o)&&e++,/\d/.test(o)&&e++,/[^a-zA-Z0-9]/.test(o)&&e++,e}),P=V(()=>t.password.length>=8&&t.password===t.password_confirmation),T=async()=>{var o,e,u;if(!P.value){t.password!==t.password_confirmation&&(d.value="Passwords do not match");return}d.value="",m.value=!0;try{await G.post("/auth/reset-password",t),C.value=!0}catch(a){((o=a.response)==null?void 0:o.status)===400||((e=a.response)==null?void 0:e.status)===422?(d.value=a.response.data.message||"Invalid or expired reset link",(u=a.response.data.errors)!=null&&u.token&&(x.value=!0)):d.value="Something went wrong. Please try again."}finally{m.value=!1}};return H(()=>{t.token=w.query.token||w.params.token||"",t.email=w.query.email||"",t.token||(x.value=!0)}),(o,e)=>{const u=z("router-link");return r(),i("div",K,[s("div",Q,[s("div",X,[n(u,{to:"/",class:"inline-block"},{default:g(()=>[...e[5]||(e[5]=[s("h1",{class:"text-3xl font-bold text-primary-600"},"Lentloads",-1)])]),_:1})]),s("div",ee,[C.value?(r(),i("div",se,[s("div",te,[n(l(Y),{class:"w-8 h-8 text-green-600"})]),e[7]||(e[7]=s("h2",{class:"text-xl font-bold text-gray-900 mb-2"},"Password Reset!",-1)),e[8]||(e[8]=s("p",{class:"text-gray-500 mb-6"}," Your password has been successfully reset. You can now log in with your new password. ",-1)),n(u,{to:"/login",class:"btn-primary w-full"},{default:g(()=>[...e[6]||(e[6]=[b(" Go to Login ",-1)])]),_:1})])):x.value?(r(),i("div",ae,[s("div",re,[n(l(O),{class:"w-8 h-8 text-red-600"})]),e[10]||(e[10]=s("h2",{class:"text-xl font-bold text-gray-900 mb-2"},"Invalid or Expired Link",-1)),e[11]||(e[11]=s("p",{class:"text-gray-500 mb-6"}," This password reset link is invalid or has expired. Please request a new one. ",-1)),n(u,{to:"/forgot-password",class:"btn-primary w-full"},{default:g(()=>[...e[9]||(e[9]=[b(" Request New Link ",-1)])]),_:1})])):(r(),i("div",oe,[s("div",le,[s("div",ne,[n(l(J),{class:"w-8 h-8 text-primary-600"})]),e[12]||(e[12]=s("h2",{class:"text-xl font-bold text-gray-900"},"Set new password",-1)),e[13]||(e[13]=s("p",{class:"text-gray-500 mt-1"}," Enter your new password below ",-1))]),s("form",{onSubmit:F(T,["prevent"]),class:"space-y-4"},[s("div",null,[e[14]||(e[14]=s("label",{class:"label"},"Email address",-1)),k(s("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>t.email=a),type:"email",class:"input bg-gray-50",readonly:""},null,512),[[I,t.email]])]),s("div",null,[e[15]||(e[15]=s("label",{class:"label"},"New Password",-1)),s("div",ie,[n(l(q),{class:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),k(s("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>t.password=a),type:f.value?"text":"password",class:"input pl-10 pr-10",placeholder:"Minimum 8 characters",required:"",minlength:"8"},null,8,de),[[L,t.password]]),s("button",{type:"button",onClick:e[2]||(e[2]=a=>f.value=!f.value),class:"absolute right-3 top-1/2 -translate-y-1/2"},[f.value?(r(),c(l(R),{key:1,class:"w-5 h-5 text-gray-400"})):(r(),c(l(N),{key:0,class:"w-5 h-5 text-gray-400"}))])])]),s("div",null,[e[16]||(e[16]=s("label",{class:"label"},"Confirm New Password",-1)),s("div",ue,[n(l(q),{class:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),k(s("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>t.password_confirmation=a),type:v.value?"text":"password",class:"input pl-10 pr-10",placeholder:"Confirm your password",required:""},null,8,pe),[[L,t.password_confirmation]]),s("button",{type:"button",onClick:e[4]||(e[4]=a=>v.value=!v.value),class:"absolute right-3 top-1/2 -translate-y-1/2"},[v.value?(r(),c(l(R),{key:1,class:"w-5 h-5 text-gray-400"})):(r(),c(l(N),{key:0,class:"w-5 h-5 text-gray-400"}))])])]),t.password?(r(),i("div",me,[s("div",ce,[(r(),i(U,null,Z(4,a=>s("div",{key:a,class:$(["h-1 flex-1 rounded",a<=y.value?M[y.value]:"bg-gray-200"])},null,2)),64))]),s("p",{class:$(["text-xs",B[y.value]])},_(j[y.value]),3)])):h("",!0),d.value?(r(),i("p",we,_(d.value),1)):h("",!0),s("button",{type:"submit",disabled:m.value||!P.value,class:"btn-primary w-full"},[m.value?(r(),c(W,{key:0,class:"mr-2"})):h("",!0),b(" "+_(m.value?"Resetting...":"Reset Password"),1)],8,fe)],32)]))])])])}}};export{_e as default};
