import{u as S,x as D,r as l,d as $,H as j,y as A,e as E,c as o,o as s,a as t,f as B,g as M,w as y,i as _,t as u,J,K,F as x,h as f,B as V,m as F}from"./main-CQnRCcw5.js";import{L as R}from"./ListingCard-BbBUT8JT.js";import"./listings-DNbKQ79n.js";import"./dayjs.min-CUz-Fjy8.js";import"./relativeTime-BU1bjuJH.js";import"./SparklesIcon-CoRNfyI5.js";import"./BoltIcon-B05Xwsrf.js";const T={class:"min-h-screen bg-gray-50 py-6"},U={class:"container-app"},q={class:"flex items-center gap-2 text-sm mb-4"},z={class:"text-gray-900"},G={class:"flex items-center justify-between mb-6"},I={class:"text-2xl font-bold text-gray-900"},O={class:"text-gray-500"},Q={key:0,class:"flex flex-wrap gap-2 mb-6"},W={key:1,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},X={key:2,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},Y={key:3,class:"card p-12 text-center"},Z={key:4,class:"mt-6 text-center"},ee=["disabled"],de={__name:"CategoryListings",setup(te){const g=S();D();const d=l(!0),n=l(null),i=l([]),p=l("newest"),v=l(1),h=l(1),w=l(0),H=$(()=>v.value<h.value),k=async()=>{try{const r=await V.get(`/categories/${g.params.slug}`);n.value=r.data.data.category}catch{console.error("Failed to fetch category")}},c=async(r=!1)=>{d.value=!0;try{const e=await V.get("/listings",{params:{category:g.params.slug,sort:p.value,page:r?v.value+1:1}});r?i.value=[...i.value,...e.data.data]:i.value=e.data.data,w.value=e.data.meta.total,v.value=e.data.meta.current_page,h.value=e.data.meta.last_page}finally{d.value=!1}},P=()=>{c(!0)};return j(()=>g.params.slug,()=>{k(),c()}),A(()=>{k(),c()}),(r,e)=>{var b,C,L,N;const m=E("router-link");return s(),o("div",T,[t("div",U,[t("nav",q,[M(m,{to:"/",class:"text-gray-500 hover:text-gray-700"},{default:y(()=>[...e[1]||(e[1]=[_("Home",-1)])]),_:1}),e[3]||(e[3]=t("span",{class:"text-gray-400"},"/",-1)),M(m,{to:"/categories",class:"text-gray-500 hover:text-gray-700"},{default:y(()=>[...e[2]||(e[2]=[_("Categories",-1)])]),_:1}),e[4]||(e[4]=t("span",{class:"text-gray-400"},"/",-1)),t("span",z,u((b=n.value)==null?void 0:b.name),1)]),t("div",G,[t("div",null,[t("h1",I,u((C=n.value)==null?void 0:C.name),1),t("p",O,u(w.value)+" ads found",1)]),J(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>p.value=a),onChange:c,class:"input w-auto"},[...e[5]||(e[5]=[t("option",{value:"newest"},"Newest First",-1),t("option",{value:"price_low"},"Price: Low to High",-1),t("option",{value:"price_high"},"Price: High to Low",-1)])],544),[[K,p.value]])]),(N=(L=n.value)==null?void 0:L.children)!=null&&N.length?(s(),o("div",Q,[(s(!0),o(x,null,f(n.value.children,a=>(s(),F(m,{key:a.id,to:`/category/${a.slug}`,class:"px-4 py-2 bg-white rounded-full border hover:border-primary-500 hover:text-primary-600 text-sm"},{default:y(()=>[_(u(a.name),1)]),_:2},1032,["to"]))),128))])):B("",!0),d.value?(s(),o("div",W,[(s(),o(x,null,f(8,a=>t("div",{key:a,class:"card p-4"},[...e[6]||(e[6]=[t("div",{class:"skeleton h-40 mb-3"},null,-1),t("div",{class:"skeleton h-4 w-20 mb-2"},null,-1),t("div",{class:"skeleton h-4 w-full"},null,-1)])])),64))])):i.value.length?(s(),o("div",X,[(s(!0),o(x,null,f(i.value,a=>(s(),F(R,{key:a.id,listing:a},null,8,["listing"]))),128))])):(s(),o("div",Y,[...e[7]||(e[7]=[t("p",{class:"text-gray-500"},"No listings in this category yet",-1)])])),H.value?(s(),o("div",Z,[t("button",{onClick:P,disabled:d.value,class:"btn-secondary"}," Load More ",8,ee)])):B("",!0)])])}}};export{de as default};
