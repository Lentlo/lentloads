var v=(k,g,i)=>new Promise((r,f)=>{var c=l=>{try{u(i.next(l))}catch(a){f(a)}},m=l=>{try{u(i.throw(l))}catch(a){f(a)}},u=l=>l.done?r(l.value):Promise.resolve(l.value).then(c,m);u((i=i.apply(k,g)).next())});import{u as E,b as F,f as y,r as w,o as T,k as V,l as U,p as t,x as z,a as G,C as R,A as $,L as A,D as o,E as d,B as S,S as P}from"./vue-vendor-Clry8SR-.js";import{d as I,b as N}from"./main-capacitor-pPhQb7CI.js";import{toast as n}from"./ui-vendor-B7DvqItC.js";import{r as J}from"./CameraIcon-BkELbqiK.js";const L={class:"settings-page min-h-screen bg-gray-50"},O={class:"container-app py-6 max-w-2xl"},Z={class:"card p-6 mb-6"},q={class:"flex items-center gap-4 mb-6"},H=["src","alt"],K={class:"btn-secondary cursor-pointer"},Q=["value"],W={class:"grid grid-cols-2 gap-4"},Y=["disabled"],_={class:"card p-6 mb-6"},ee=["disabled"],te={class:"card p-6 mb-6"},se={class:"space-y-4"},le={class:"flex items-center justify-between"},ae={class:"relative inline-flex items-center cursor-pointer"},re={class:"flex items-center justify-between"},oe={class:"relative inline-flex items-center cursor-pointer"},ne={class:"flex items-center justify-between"},ie={class:"relative inline-flex items-center cursor-pointer"},de={class:"card p-6 border-red-200"},ue={class:"flex items-center justify-between"},pe={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},fe={class:"relative bg-white rounded-xl p-6 w-full max-w-md"},ce={class:"mb-4"},me={class:"flex gap-2"},be=["disabled"],Pe={__name:"Settings",setup(k){const g=E(),i=I(),r=F(()=>i.user),f=y(!1),c=y(!1),m=y(!1),u=y(""),l=w({name:"",phone:"",bio:"",city:"",state:""}),a=w({current_password:"",password:"",password_confirmation:""}),p=w({email:!0,push:!0,messages:!0});T(()=>{r.value&&(l.name=r.value.name||"",l.phone=r.value.phone||"",l.bio=r.value.bio||"",l.city=r.value.city||"",l.state=r.value.state||"",r.value.notification_preferences&&Object.assign(p,r.value.notification_preferences))});const X=b=>v(this,null,function*(){const e=b.target.files[0];if(e){if(e.size>2*1024*1024){n.error("Image size must be less than 2MB");return}try{yield i.updateAvatar(e),n.success("Profile photo updated")}catch(x){n.error("Failed to update photo")}}}),D=()=>v(this,null,function*(){f.value=!0;try{yield i.updateProfile(l),n.success("Profile updated")}catch(b){n.error("Failed to update profile")}finally{f.value=!1}}),M=()=>v(this,null,function*(){if(a.password!==a.password_confirmation){n.error("Passwords do not match");return}c.value=!0;try{yield i.changePassword(a),n.success("Password updated"),a.current_password="",a.password="",a.password_confirmation=""}catch(b){n.error("Failed to update password")}finally{c.value=!1}}),j=()=>v(this,null,function*(){try{yield N.put("/notifications/preferences",p),n.success("Preferences saved")}catch(b){n.error("Failed to save preferences")}}),B=()=>v(this,null,function*(){try{yield N.delete("/auth/account",{data:{password:u.value}}),n.success("Account deleted"),i.clearAuth(),g.push("/")}catch(b){n.error("Failed to delete account")}});return(b,e)=>{var x,h,C;return U(),V("div",L,[t("div",O,[e[38]||(e[38]=t("h1",{class:"text-2xl font-bold text-gray-900 mb-6"},"Account Settings",-1)),t("div",Z,[e[24]||(e[24]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Profile Information",-1)),t("div",q,[t("img",{src:(x=r.value)==null?void 0:x.avatar_url,alt:(h=r.value)==null?void 0:h.name,class:"w-20 h-20 rounded-full object-cover"},null,8,H),t("div",null,[t("label",K,[G($(J),{class:"w-4 h-4 mr-2"}),e[15]||(e[15]=R(" Change Photo ",-1)),t("input",{type:"file",accept:"image/*",class:"hidden",onChange:X},null,32)]),e[16]||(e[16]=t("p",{class:"text-sm text-gray-500 mt-1"},"JPG, PNG. Max 2MB",-1))])]),t("form",{onSubmit:A(D,["prevent"]),class:"space-y-4"},[t("div",null,[e[17]||(e[17]=t("label",{class:"label"},"Full Name",-1)),o(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>l.name=s),type:"text",class:"input"},null,512),[[d,l.name]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"label"},"Email",-1)),t("input",{value:(C=r.value)==null?void 0:C.email,type:"email",class:"input bg-gray-50",disabled:""},null,8,Q),e[19]||(e[19]=t("p",{class:"text-sm text-gray-500 mt-1"},"Email cannot be changed",-1))]),t("div",null,[e[20]||(e[20]=t("label",{class:"label"},"Phone Number",-1)),o(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>l.phone=s),type:"tel",class:"input",placeholder:"+91 XXXXX XXXXX"},null,512),[[d,l.phone]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"label"},"Bio",-1)),o(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=s=>l.bio=s),rows:"3",class:"input",placeholder:"Tell buyers about yourself..."},null,512),[[d,l.bio]])]),t("div",W,[t("div",null,[e[22]||(e[22]=t("label",{class:"label"},"City",-1)),o(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>l.city=s),type:"text",class:"input"},null,512),[[d,l.city]])]),t("div",null,[e[23]||(e[23]=t("label",{class:"label"},"State",-1)),o(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>l.state=s),type:"text",class:"input"},null,512),[[d,l.state]])])]),t("button",{type:"submit",disabled:f.value,class:"btn-primary"},S(f.value?"Saving...":"Save Changes"),9,Y)],32)]),t("div",_,[e[28]||(e[28]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Change Password",-1)),t("form",{onSubmit:A(M,["prevent"]),class:"space-y-4"},[t("div",null,[e[25]||(e[25]=t("label",{class:"label"},"Current Password",-1)),o(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>a.current_password=s),type:"password",class:"input"},null,512),[[d,a.current_password]])]),t("div",null,[e[26]||(e[26]=t("label",{class:"label"},"New Password",-1)),o(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>a.password=s),type:"password",class:"input"},null,512),[[d,a.password]])]),t("div",null,[e[27]||(e[27]=t("label",{class:"label"},"Confirm New Password",-1)),o(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>a.password_confirmation=s),type:"password",class:"input"},null,512),[[d,a.password_confirmation]])]),t("button",{type:"submit",disabled:c.value,class:"btn-primary"},S(c.value?"Updating...":"Update Password"),9,ee)],32)]),t("div",te,[e[35]||(e[35]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Notification Preferences",-1)),t("div",se,[t("div",le,[e[30]||(e[30]=t("div",null,[t("p",{class:"font-medium text-gray-900"},"Email notifications"),t("p",{class:"text-sm text-gray-500"},"Receive updates via email")],-1)),t("label",ae,[o(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>p.email=s),type:"checkbox",class:"sr-only peer"},null,512),[[P,p.email]]),e[29]||(e[29]=t("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-600"},null,-1))])]),t("div",re,[e[32]||(e[32]=t("div",null,[t("p",{class:"font-medium text-gray-900"},"Push notifications"),t("p",{class:"text-sm text-gray-500"},"Receive push notifications")],-1)),t("label",oe,[o(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>p.push=s),type:"checkbox",class:"sr-only peer"},null,512),[[P,p.push]]),e[31]||(e[31]=t("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-600"},null,-1))])]),t("div",ne,[e[34]||(e[34]=t("div",null,[t("p",{class:"font-medium text-gray-900"},"Message alerts"),t("p",{class:"text-sm text-gray-500"},"Get notified when you receive messages")],-1)),t("label",ie,[o(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>p.messages=s),type:"checkbox",class:"sr-only peer"},null,512),[[P,p.messages]]),e[33]||(e[33]=t("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-600"},null,-1))])])]),t("button",{onClick:j,class:"btn-primary mt-4"}," Save Preferences ")]),t("div",de,[e[37]||(e[37]=t("h2",{class:"text-lg font-semibold text-red-600 mb-4"},"Danger Zone",-1)),t("div",ue,[e[36]||(e[36]=t("div",null,[t("p",{class:"font-medium text-gray-900"},"Delete Account"),t("p",{class:"text-sm text-gray-500"},"Permanently delete your account and all data")],-1)),t("button",{onClick:e[11]||(e[11]=s=>m.value=!0),class:"btn-danger"}," Delete Account ")])])]),m.value?(U(),V("div",pe,[t("div",{class:"absolute inset-0 bg-black/50",onClick:e[12]||(e[12]=s=>m.value=!1)}),t("div",fe,[e[40]||(e[40]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-2"},"Delete Account",-1)),e[41]||(e[41]=t("p",{class:"text-gray-500 mb-4"}," This action cannot be undone. All your listings, messages, and data will be permanently deleted. ",-1)),t("div",ce,[e[39]||(e[39]=t("label",{class:"label"},"Enter your password to confirm",-1)),o(t("input",{"onUpdate:modelValue":e[13]||(e[13]=s=>u.value=s),type:"password",class:"input"},null,512),[[d,u.value]])]),t("div",me,[t("button",{onClick:e[14]||(e[14]=s=>m.value=!1),class:"btn-secondary flex-1"}," Cancel "),t("button",{onClick:B,class:"btn-danger flex-1",disabled:!u.value}," Delete Account ",8,be)])])])):z("",!0)])}}};export{Pe as default};
