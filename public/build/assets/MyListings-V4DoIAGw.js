var $=(i,v,m)=>new Promise((g,d)=>{var p=f=>{try{h(m.next(f))}catch(u){d(u)}},b=f=>{try{h(m.throw(f))}catch(u){d(u)}},h=f=>f.done?g(f.value):Promise.resolve(f.value).then(p,b);h((m=m.apply(i,v)).next())});import{u as E}from"./listings-CGtpfsfK.js";import{toast as k}from"./ui-vendor-P7jBoO03.js";import{_ as B,i as I,j as T,c as H}from"./main-capacitor-DexhVPa1.js";import{k as a,l as n,p as t,b as R,a as o,A as c,B as r,D as A,f as w,s as Y,o as q,v as G,z as J,x as L,y as C,F as S,I as j,C as _}from"./vue-vendor-JbibKI1S.js";import{r as K}from"./ExclamationCircleIcon-B7tz-xwJ.js";import{r as O}from"./CheckCircleIcon-DzEVpD5H.js";import{a as Q,r as U}from"./ClockIcon-Bph0mNDI.js";import{r as W}from"./EyeIcon-r2nJLjIJ.js";import{r as X}from"./PencilIcon-CwqDPvi_.js";import{r as tt}from"./CheckIcon-C37w7-s6.js";import{r as st}from"./TrashIcon-BsF74vMz.js";function et(i,v){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"})])}function nt(i,v){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})])}function at(i,v){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z"})])}function ot(i,v){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 0 0-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 0 0-16.536-1.84M7.5 14.25 5.106 5.272M6 20.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Zm12.75 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"})])}const lt={class:"fixed inset-0 z-50 flex items-end sm:items-center justify-center"},it={class:"relative bg-white w-full sm:max-w-sm sm:rounded-xl rounded-t-2xl p-6 animate-slide-up safe-area-bottom"},rt={class:"text-center"},ct={key:0,class:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4"},dt={key:1,class:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4"},ut={key:2,class:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-4"},vt={class:"text-lg font-semibold text-gray-900 mb-2"},mt={class:"text-gray-500 text-sm"},ft={class:"flex gap-3 mt-6"},gt={__name:"ConfirmModal",props:{title:{type:String,default:"Confirm Action"},message:{type:String,default:"Are you sure you want to proceed?"},confirmText:{type:String,default:"Confirm"},cancelText:{type:String,default:"Cancel"},confirmClass:{type:String,default:null},type:{type:String,default:"info",validator:i=>["info","warning","danger"].includes(i)}},emits:["confirm","cancel"],setup(i){const v=i,m=R(()=>v.type==="danger"?"btn-danger":"btn-primary");return(g,d)=>(n(),a("div",lt,[t("div",{class:"absolute inset-0 bg-black/50",onClick:d[0]||(d[0]=p=>g.$emit("cancel"))}),t("div",it,[t("div",rt,[i.type==="danger"?(n(),a("div",ct,[o(c(nt),{class:"w-6 h-6 text-red-600"})])):i.type==="warning"?(n(),a("div",dt,[o(c(K),{class:"w-6 h-6 text-yellow-600"})])):(n(),a("div",ut,[o(c(at),{class:"w-6 h-6 text-primary-600"})])),t("h3",vt,r(i.title),1),t("p",mt,r(i.message),1)]),t("div",ft,[t("button",{onClick:d[1]||(d[1]=p=>g.$emit("cancel")),class:"btn-secondary flex-1"},r(i.cancelText),1),t("button",{onClick:d[2]||(d[2]=p=>g.$emit("confirm")),class:A([i.confirmClass||m.value,"flex-1"])},r(i.confirmText),3)])])]))}},pt=B(gt,[["__scopeId","data-v-b1b2a972"]]),_t={class:"my-listings-page"},ht={class:"container-app py-6"},wt={class:"page-header"},yt={class:"stats-grid"},kt={class:"stat-card"},bt={class:"stat-icon bg-blue-100 text-blue-600"},xt={class:"stat-info"},$t={class:"stat-value"},Ct={class:"stat-card"},Mt={class:"stat-icon bg-green-100 text-green-600"},Lt={class:"stat-info"},St={class:"stat-value"},jt={class:"stat-card"},At={class:"stat-icon bg-yellow-100 text-yellow-600"},Tt={class:"stat-info"},Bt={class:"stat-value"},Pt={class:"stat-card"},Dt={class:"stat-icon bg-purple-100 text-purple-600"},Nt={class:"stat-info"},Ft={class:"stat-value"},Zt={class:"filters-row"},Vt=["onClick"],zt={class:"count"},Et={key:0,class:"listings-container"},It={key:1,class:"listings-container"},Ht=["src","alt"],Rt={class:"listing-content"},Yt={class:"listing-price"},qt={class:"listing-stats"},Gt={class:"listing-actions"},Jt=["onClick"],Kt=["onClick"],Ot=["onClick"],Qt={key:2,class:"empty-state"},Ut={class:"empty-icon"},Wt={key:3,class:"pagination"},Xt=["onClick"],ts={__name:"MyListings",setup(i){const v=E(),m=w(!0),g=w([]),d=w("all"),p=w(1),b=w(1),h=w(!1),f=w(null),u=w([{label:"All",value:"all",count:0},{label:"Active",value:"active",count:0},{label:"Pending",value:"pending",count:0},{label:"Sold",value:"sold",count:0},{label:"Expired",value:"expired",count:0}]),P=l=>({active:"status-active",pending:"status-pending",sold:"status-sold",expired:"status-expired",rejected:"status-rejected"})[l]||"status-default",D=l=>(l==null?void 0:l.replace(/\s*\(Negotiable\)/gi,"").trim())||"",y=()=>$(this,null,function*(){m.value=!0;try{const l={page:p.value};d.value!=="all"&&(l.status=d.value);const s=yield v.fetchMyListings(l);g.value=s.data,b.value=s.meta.last_page,u.value[0].count=s.meta.total,s.counts&&(u.value[1].count=s.counts.active||0,u.value[2].count=s.counts.pending||0,u.value[3].count=s.counts.sold||0,u.value[4].count=s.counts.expired||0)}finally{m.value=!1}}),N=l=>$(this,null,function*(){try{yield v.markAsSold(l.id),k.success("Listing marked as sold!"),y()}catch(s){k.error("Failed to update listing")}}),F=l=>$(this,null,function*(){try{yield v.renewListing(l.id),k.success("Listing renewed for 30 days!"),y()}catch(s){k.error("Failed to renew listing")}}),Z=l=>{f.value=l,h.value=!0},V=()=>$(this,null,function*(){try{yield v.deleteListing(f.value.id),k.success("Listing deleted"),h.value=!1,y()}catch(l){k.error("Failed to delete listing")}}),z=l=>{p.value=l,y()};return Y(d,()=>{p.value=1,y()}),q(()=>{y()}),(l,s)=>{const x=G("router-link");return n(),a("div",_t,[t("div",ht,[t("div",wt,[s[2]||(s[2]=t("div",null,[t("h1",null,"My Listings"),t("p",null,"Manage your ads")],-1)),o(x,{to:"/sell",class:"post-btn"},{default:C(()=>[o(c(I),{class:"w-5 h-5"}),s[1]||(s[1]=t("span",null,"Post New Ad",-1))]),_:1})]),t("div",yt,[t("div",kt,[t("div",bt,[o(c(T),{class:"w-6 h-6"})]),t("div",xt,[t("span",$t,r(u.value[0].count),1),s[3]||(s[3]=t("span",{class:"stat-label"},"Total Listings",-1))])]),t("div",Ct,[t("div",Mt,[o(c(O),{class:"w-6 h-6"})]),t("div",Lt,[t("span",St,r(u.value[1].count),1),s[4]||(s[4]=t("span",{class:"stat-label"},"Active",-1))])]),t("div",jt,[t("div",At,[o(c(Q),{class:"w-6 h-6"})]),t("div",Tt,[t("span",Bt,r(u.value[2].count),1),s[5]||(s[5]=t("span",{class:"stat-label"},"Pending",-1))])]),t("div",Pt,[t("div",Dt,[o(c(ot),{class:"w-6 h-6"})]),t("div",Nt,[t("span",Ft,r(u.value[3].count),1),s[6]||(s[6]=t("span",{class:"stat-label"},"Sold",-1))])])]),t("div",Zt,[(n(!0),a(S,null,j(u.value,e=>(n(),a("button",{key:e.value,onClick:M=>d.value=e.value,class:A(["filter-btn",{active:d.value===e.value}])},[_(r(e.label)+" ",1),t("span",zt,r(e.count),1)],10,Vt))),128))]),m.value?(n(),a("div",Et,[(n(),a(S,null,j(3,e=>t("div",{key:e,class:"listing-card-skeleton"},[...s[7]||(s[7]=[t("div",{class:"skeleton h-40 rounded-lg"},null,-1),t("div",{class:"skeleton h-5 w-2/3 mt-3"},null,-1),t("div",{class:"skeleton h-4 w-1/3 mt-2"},null,-1)])])),64))])):g.value.length?(n(),a("div",It,[(n(!0),a(S,null,j(g.value,e=>(n(),a("div",{key:e.id,class:"listing-card"},[o(x,{to:`/listing/${e.slug}`,class:"listing-image"},{default:C(()=>[t("img",{src:e.primary_image_url,alt:e.title},null,8,Ht),t("span",{class:A(["status-badge",P(e.status)])},r(e.status),3)]),_:2},1032,["to"]),t("div",Rt,[o(x,{to:`/listing/${e.slug}`,class:"listing-title"},{default:C(()=>[_(r(e.title),1)]),_:2},1032,["to"]),t("p",Yt,r(D(e.formatted_price)),1),t("div",qt,[t("span",null,[o(c(W),{class:"w-4 h-4"}),_(" "+r(e.views_count),1)]),t("span",null,[o(c(H),{class:"w-4 h-4"}),_(" "+r(e.favorites_count),1)]),t("span",null,[o(c(U),{class:"w-4 h-4"}),_(" "+r(e.contacts_count||0),1)])]),t("div",Gt,[o(x,{to:`/listing/${e.id}/edit`,class:"action-btn edit"},{default:C(()=>[o(c(X),{class:"w-4 h-4"}),s[8]||(s[8]=_(" Edit ",-1))]),_:1},8,["to"]),e.status==="active"?(n(),a("button",{key:0,onClick:M=>N(e),class:"action-btn sold"},[o(c(tt),{class:"w-4 h-4"}),s[9]||(s[9]=_(" Mark Sold ",-1))],8,Jt)):L("",!0),e.status==="expired"||e.status==="sold"?(n(),a("button",{key:1,onClick:M=>F(e),class:"action-btn renew"},[o(c(et),{class:"w-4 h-4"}),s[10]||(s[10]=_(" Renew ",-1))],8,Kt)):L("",!0),t("button",{onClick:M=>Z(e),class:"action-btn delete"},[o(c(st),{class:"w-4 h-4"})],8,Ot)])])]))),128))])):(n(),a("div",Qt,[t("div",Ut,[o(c(T),{class:"w-16 h-16"})]),s[12]||(s[12]=t("h3",null,"No listings yet",-1)),s[13]||(s[13]=t("p",null,"Start selling by posting your first ad",-1)),o(x,{to:"/sell",class:"btn-primary"},{default:C(()=>[...s[11]||(s[11]=[_(" Post Your First Ad ",-1)])]),_:1})])),b.value>1?(n(),a("div",Wt,[(n(!0),a(S,null,j(b.value,e=>(n(),a("button",{key:e,onClick:M=>z(e),class:A(["page-btn",{active:p.value===e}])},r(e),11,Xt))),128))])):L("",!0)]),h.value?(n(),J(pt,{key:0,title:"Delete Listing",message:"Are you sure you want to delete this listing? This action cannot be undone.",confirmText:"Delete",confirmClass:"btn-danger",onConfirm:V,onCancel:s[0]||(s[0]=e=>h.value=!1)})):L("",!0)])}}},ms=B(ts,[["__scopeId","data-v-26b6f378"]]);export{ms as default};
