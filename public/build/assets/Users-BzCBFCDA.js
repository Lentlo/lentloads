import{c as r,o as d,a as t,k as L,r as i,A as T,l as z,g as $,w as v,d as b,e as p,v as V,C as y,F as H,i as I,t as n,M as J,j as f,E as B,H as m}from"./main-CccGz_zE.js";import{d as q}from"./dayjs.min-Bof1u0Bp.js";import{d as G}from"./debounce-CA4cRjAU.js";import{r as K}from"./MagnifyingGlassIcon-qiMtPc2a.js";import{r as O}from"./EyeIcon-B3n5wCRs.js";import{r as Q}from"./PencilIcon-CnwqKAMb.js";import{r as W}from"./CheckCircleIcon-CJccwlJ4.js";function X(j,S){return d(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M18.364 18.364A9 9 0 0 0 5.636 5.636m12.728 12.728A9 9 0 0 1 5.636 5.636m12.728 12.728L5.636 5.636"})])}const Z={class:"p-6"},tt={class:"card p-4 mb-6"},et={class:"flex flex-wrap gap-4"},st={class:"flex-1 min-w-[200px]"},at={class:"relative"},lt={class:"card overflow-hidden"},ot={class:"w-full"},nt={class:"divide-y"},rt={key:0},dt={key:1},it={class:"px-4 py-3"},ut={class:"flex items-center gap-3"},pt=["src","alt"],ct={class:"font-medium text-gray-900"},vt={class:"text-sm text-gray-500"},mt={class:"px-4 py-3 text-gray-600"},bt={class:"px-4 py-3"},xt={class:"px-4 py-3"},gt={class:"px-4 py-3 text-gray-600"},yt={class:"px-4 py-3"},ft={class:"flex items-center gap-2"},ht=["onClick"],_t=["onClick"],wt=["onClick"],kt=["onClick"],Ut={key:0,class:"p-4 border-t flex items-center justify-between"},Ct={class:"text-sm text-gray-500"},$t={class:"flex gap-2"},St=["disabled"],Mt=["disabled"],At={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},Vt={class:"relative bg-white rounded-xl p-6 w-full max-w-md"},Bt={class:"flex gap-2"},jt=["disabled"],Lt={__name:"Users",setup(j){const S=L(),h=i(!0),x=i(!1),_=i([]),w=i(""),o=i(1),g=i(1),k=i(20),U=i(0),l=i(null),c=T({role:"",status:""}),N=a=>q(a).format("MMM D, YYYY"),E=a=>({active:"bg-green-100 text-green-800",suspended:"bg-yellow-100 text-yellow-800",banned:"bg-red-100 text-red-800"})[a]||"bg-gray-100 text-gray-800",u=async()=>{h.value=!0;try{const a=await f.get("/admin/users",{params:{page:o.value,search:w.value,role:c.role,status:c.status}});_.value=a.data.data,o.value=a.data.meta.current_page,g.value=a.data.meta.last_page,k.value=a.data.meta.per_page,U.value=a.data.meta.total}finally{h.value=!1}},M=G(()=>{o.value=1,u()},300),A=a=>{a>=1&&a<=g.value&&(o.value=a,u())},F=a=>{S.push(`/user/${a.id}`)},P=a=>{l.value={...a}},D=async()=>{x.value=!0;try{await f.put(`/admin/users/${l.value.id}`,{name:l.value.name,role:l.value.role,status:l.value.status}),m.success("User updated"),l.value=null,u()}catch{m.error("Failed to update user")}finally{x.value=!1}},R=async a=>{if(confirm(`Ban ${a.name}? They will no longer be able to access the platform.`))try{await f.post(`/admin/users/${a.id}/ban`),m.success("User banned"),u()}catch{m.error("Failed to ban user")}},Y=async a=>{try{await f.post(`/admin/users/${a.id}/unban`),m.success("User unbanned"),u()}catch{m.error("Failed to unban user")}};return z(()=>{u()}),(a,e)=>(d(),r("div",Z,[e[22]||(e[22]=t("div",{class:"flex items-center justify-between mb-6"},[t("h1",{class:"text-2xl font-bold text-gray-900"},"Manage Users")],-1)),t("div",tt,[t("div",et,[t("div",st,[t("div",at,[b(p(K),{class:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),v(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>w.value=s),type:"text",placeholder:"Search users...",class:"input pl-10",onInput:e[1]||(e[1]=(...s)=>p(M)&&p(M)(...s))},null,544),[[V,w.value]])])]),v(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>c.role=s),onChange:u,class:"input w-auto"},[...e[11]||(e[11]=[t("option",{value:""},"All Roles",-1),t("option",{value:"user"},"User",-1),t("option",{value:"admin"},"Admin",-1)])],544),[[y,c.role]]),v(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>c.status=s),onChange:u,class:"input w-auto"},[...e[12]||(e[12]=[t("option",{value:""},"All Status",-1),t("option",{value:"active"},"Active",-1),t("option",{value:"suspended"},"Suspended",-1),t("option",{value:"banned"},"Banned",-1)])],544),[[y,c.status]])])]),t("div",lt,[t("table",ot,[e[15]||(e[15]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-900"},"User"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-900"},"Email"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-900"},"Role"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-900"},"Status"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-900"},"Joined"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-900"},"Actions")])],-1)),t("tbody",nt,[h.value?(d(),r("tr",rt,[...e[13]||(e[13]=[t("td",{colspan:"6",class:"px-4 py-8 text-center text-gray-500"}," Loading... ",-1)])])):_.value.length?$("",!0):(d(),r("tr",dt,[...e[14]||(e[14]=[t("td",{colspan:"6",class:"px-4 py-8 text-center text-gray-500"}," No users found ",-1)])])),(d(!0),r(H,null,I(_.value,s=>(d(),r("tr",{key:s.id,class:"hover:bg-gray-50"},[t("td",it,[t("div",ut,[t("img",{src:s.avatar_url,alt:s.name,class:"w-10 h-10 rounded-full object-cover"},null,8,pt),t("div",null,[t("p",ct,n(s.name),1),t("p",vt,n(s.phone||"No phone"),1)])])]),t("td",mt,n(s.email),1),t("td",bt,[t("span",{class:B(["badge",s.role==="admin"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"])},n(s.role),3)]),t("td",xt,[t("span",{class:B(["badge",E(s.status)])},n(s.status),3)]),t("td",gt,n(N(s.created_at)),1),t("td",yt,[t("div",ft,[t("button",{onClick:C=>F(s),class:"p-1 text-gray-600 hover:bg-gray-100 rounded",title:"View"},[b(p(O),{class:"w-5 h-5"})],8,ht),t("button",{onClick:C=>P(s),class:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Edit"},[b(p(Q),{class:"w-5 h-5"})],8,_t),s.status!=="banned"?(d(),r("button",{key:0,onClick:C=>R(s),class:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Ban"},[b(p(X),{class:"w-5 h-5"})],8,wt)):(d(),r("button",{key:1,onClick:C=>Y(s),class:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Unban"},[b(p(W),{class:"w-5 h-5"})],8,kt))])])]))),128))])]),g.value>1?(d(),r("div",Ut,[t("p",Ct," Showing "+n((o.value-1)*k.value+1)+" to "+n(Math.min(o.value*k.value,U.value))+" of "+n(U.value)+" users ",1),t("div",$t,[t("button",{onClick:e[4]||(e[4]=s=>A(o.value-1)),disabled:o.value===1,class:"btn-secondary btn-sm"}," Previous ",8,St),t("button",{onClick:e[5]||(e[5]=s=>A(o.value+1)),disabled:o.value===g.value,class:"btn-secondary btn-sm"}," Next ",8,Mt)])])):$("",!0)]),l.value?(d(),r("div",At,[t("div",{class:"absolute inset-0 bg-black/50",onClick:e[6]||(e[6]=s=>l.value=null)}),t("div",Vt,[e[21]||(e[21]=t("h3",{class:"text-lg font-semibold mb-4"},"Edit User",-1)),t("form",{onSubmit:J(D,["prevent"]),class:"space-y-4"},[t("div",null,[e[16]||(e[16]=t("label",{class:"label"},"Name",-1)),v(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>l.value.name=s),type:"text",class:"input"},null,512),[[V,l.value.name]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"label"},"Role",-1)),v(t("select",{"onUpdate:modelValue":e[8]||(e[8]=s=>l.value.role=s),class:"input"},[...e[17]||(e[17]=[t("option",{value:"user"},"User",-1),t("option",{value:"admin"},"Admin",-1)])],512),[[y,l.value.role]])]),t("div",null,[e[20]||(e[20]=t("label",{class:"label"},"Status",-1)),v(t("select",{"onUpdate:modelValue":e[9]||(e[9]=s=>l.value.status=s),class:"input"},[...e[19]||(e[19]=[t("option",{value:"active"},"Active",-1),t("option",{value:"suspended"},"Suspended",-1),t("option",{value:"banned"},"Banned",-1)])],512),[[y,l.value.status]])]),t("div",Bt,[t("button",{type:"button",onClick:e[10]||(e[10]=s=>l.value=null),class:"btn-secondary flex-1"}," Cancel "),t("button",{type:"submit",class:"btn-primary flex-1",disabled:x.value},n(x.value?"Saving...":"Save"),9,jt)])],32)])])):$("",!0)]))}};export{Lt as default};
