import{c as o,o as a,a as s,_ as se,u as ie,C as le,x as ae,b as oe,r as c,K as ne,d as k,D as re,L as de,f as u,g as m,j as p,t as n,y as r,M as U,G as ce,i as $,l as F,F as g,h as y,A as f,z as ue,p as M,B as D,N as L,O as me,m as pe}from"./main-DT8B7HGo.js";import{u as ve}from"./listings-BZKQrY8d.js";import{_ as xe}from"./ListingCard-COa5Z0jy.js";import"./dayjs.min-iy57P9mS.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./relativeTime-D5nU98bY.js";import"./SparklesIcon-BlNEuoGk.js";import"./BoltIcon-B81Yt4ox.js";import"./MapPinIcon-oeVfKid2.js";import"./ClockIcon-Bw8_75LN.js";function ge(P,C){return a(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0m3 0a1.5 1.5 0 1 0-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-9.75 0h9.75"})])}function E(P,C){return a(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0 1 11.186 0Z"})])}const ye={class:"min-h-screen bg-gray-50"},fe={class:"container-app py-4"},be={class:"lg:hidden mb-4"},_e={class:"flex items-center gap-2 overflow-x-auto pb-2 scrollbar-hide"},he={key:0,class:"w-5 h-5 bg-primary-600 text-white text-xs rounded-full flex items-center justify-center"},ke={class:"relative flex-shrink-0"},we={key:0,class:"px-3 py-2 bg-primary-100 text-primary-700 rounded-full text-sm flex items-center gap-1 flex-shrink-0"},Ce={key:1,class:"px-3 py-2 bg-primary-100 text-primary-700 rounded-full text-sm flex items-center gap-1 flex-shrink-0"},Se={key:2,class:"px-3 py-2 bg-primary-100 text-primary-700 rounded-full text-sm flex items-center gap-1 flex-shrink-0"},qe={class:"flex flex-col lg:flex-row gap-6"},$e={class:"hidden lg:block lg:w-64 flex-shrink-0"},Fe={class:"card p-4 sticky top-20"},Me={class:"mb-5"},Ve=["value"],Ne={class:"mb-5"},Ue={class:"mb-5"},Le={class:"flex items-center gap-2"},Pe={class:"mb-5"},Ae={class:"space-y-2"},je=["onUpdate:modelValue","value"],Be={class:"ml-2 text-sm text-gray-600"},Ke={class:"flex-1"},Re={class:"flex items-center justify-between mb-4"},He={class:"text-lg lg:text-xl font-bold text-gray-900"},Te={class:"text-sm text-gray-500"},ze={class:"hidden lg:flex items-center gap-3"},De={key:0,class:"grid grid-cols-2 md:grid-cols-3 gap-3"},Ee={key:1,class:"grid grid-cols-2 md:grid-cols-3 gap-3"},Ge={key:2,class:"card p-8 text-center"},Ie={key:3,class:"mt-6 text-center"},Oe=["disabled"],Ye={key:0,class:"filter-modal lg:hidden"},Ze={class:"filter-sheet"},Je={class:"filter-header"},We={class:"flex items-center gap-2"},Xe={class:"filter-content"},Qe={class:"mb-6"},et={class:"flex flex-wrap gap-2"},tt=["onClick"],st={class:"mb-6"},it={class:"mb-6"},lt={class:"flex flex-wrap gap-2 mb-3"},at=["onClick"],ot={class:"flex items-center gap-3"},nt={class:"mb-6"},rt={class:"flex flex-wrap gap-2"},dt=["onClick"],ct={class:"filter-actions"},ut={key:1,class:"fixed inset-0 z-50 flex items-end sm:items-center justify-center"},mt={class:"relative bg-white w-full sm:max-w-sm sm:rounded-xl rounded-t-2xl p-6 safe-area-bottom animate-slide-up"},pt={class:"mb-4"},vt={class:"flex gap-3"},xt=["disabled"],gt={__name:"Search",setup(P){const C=ie(),G=le(),I=ae(),O=oe();ve();const w=c(!1),b=c([]),A=c(0),V=c(1),j=c(1),x=c(!1),_=c(!1),h=c(""),S=c(!1),t=ne({q:"",category:"",city:"",min_price:"",max_price:"",condition:"",sort:"newest"}),B=[{value:"",label:"All"},{value:"new",label:"New"},{value:"like_new",label:"Like New"},{value:"good",label:"Good"},{value:"fair",label:"Fair"}],Y=[{label:"Under ₹1K",min:"",max:1e3},{label:"₹1K - ₹5K",min:1e3,max:5e3},{label:"₹5K - ₹10K",min:5e3,max:1e4},{label:"₹10K+",min:1e4,max:""}],q=k(()=>I.categories),K=k(()=>O.isAuthenticated),R=k(()=>t.q),Z=k(()=>V.value<j.value),H=k(()=>{let l=0;return t.category&&l++,t.city&&l++,(t.min_price||t.max_price)&&l++,t.condition&&l++,l}),T=k(()=>t.q||t.category||t.city||t.min_price||t.max_price||t.condition),J=l=>{const e=q.value.find(i=>i.slug===l);return(e==null?void 0:e.name)||l},W=l=>{t.min_price=l.min,t.max_price=l.max},z=l=>{t[l]="",d()},X=()=>{t.min_price="",t.max_price="",d()},d=async(l=!1)=>{w.value=!0;try{const e={page:l?V.value+1:1,sort:t.sort};t.q&&(e.q=t.q),t.category&&(e.category=t.category),t.city&&(e.city=t.city),t.min_price&&(e.min_price=t.min_price),t.max_price&&(e.max_price=t.max_price),t.condition&&(e.condition=t.condition);const i=await D.get("/listings",{params:e});l?b.value=[...b.value,...i.data.data]:b.value=i.data.data,A.value=i.data.meta.total,V.value=i.data.meta.current_page,j.value=i.data.meta.last_page;const v={...e};delete v.page,e.page>1&&(v.page=e.page),G.replace({query:v})}catch{L.error("Failed to fetch listings")}finally{w.value=!1}},Q=()=>d(!0),ee=()=>{x.value=!1,d()},N=()=>{t.category="",t.city="",t.min_price="",t.max_price="",t.condition="",t.sort="newest",x.value=!1,d()},te=async()=>{var l;if(h.value){S.value=!0;try{await D.post("/saved-searches",{name:h.value,query:t.q||null,category_id:((l=q.value.find(e=>e.slug===t.category))==null?void 0:l.id)||null,city:t.city||null,min_price:t.min_price||null,max_price:t.max_price||null,condition:t.condition||null}),L.success("Search saved! You'll be notified of new listings."),_.value=!1,h.value=""}catch{L.error("Failed to save search")}finally{S.value=!1}}};return re(()=>{const l=C.query;l.q&&(t.q=l.q),l.category&&(t.category=l.category),l.city&&(t.city=l.city),l.min_price&&(t.min_price=l.min_price),l.max_price&&(t.max_price=l.max_price),l.condition&&(t.condition=l.condition),l.sort&&(t.sort=l.sort),d()}),de(()=>C.query,l=>{let e=!1;l.q!==t.q&&(t.q=l.q||"",e=!0),l.category!==t.category&&(t.category=l.category||"",e=!0),l.city!==t.city&&(t.city=l.city||"",e=!0),l.min_price!==t.min_price&&(t.min_price=l.min_price||"",e=!0),l.max_price!==t.max_price&&(t.max_price=l.max_price||"",e=!0),l.condition!==t.condition&&(t.condition=l.condition||"",e=!0),l.sort!==t.sort&&l.sort&&(t.sort=l.sort,e=!0),e&&d()},{deep:!0}),(l,e)=>(a(),o("div",ye,[s("div",fe,[s("div",be,[s("div",_e,[s("button",{onClick:e[0]||(e[0]=i=>x.value=!0),class:"flex items-center gap-2 px-4 py-2.5 bg-white rounded-full border shadow-sm flex-shrink-0"},[m(p(ge),{class:"w-5 h-5 text-gray-600"}),e[20]||(e[20]=s("span",{class:"text-sm font-medium"},"Filters",-1)),H.value>0?(a(),o("span",he,n(H.value),1)):u("",!0)]),s("div",ke,[r(s("select",{"onUpdate:modelValue":e[1]||(e[1]=i=>t.sort=i),onChange:d,class:"appearance-none px-4 py-2.5 pr-8 bg-white rounded-full border shadow-sm text-sm font-medium"},[...e[21]||(e[21]=[s("option",{value:"newest"},"Newest",-1),s("option",{value:"price_low"},"Price: Low",-1),s("option",{value:"price_high"},"Price: High",-1)])],544),[[U,t.sort]]),m(p(ce),{class:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"})]),t.category?(a(),o("span",we,[$(n(J(t.category))+" ",1),s("button",{onClick:e[2]||(e[2]=i=>z("category"))},[m(p(F),{class:"w-4 h-4"})])])):u("",!0),t.city?(a(),o("span",Ce,[$(n(t.city)+" ",1),s("button",{onClick:e[3]||(e[3]=i=>z("city"))},[m(p(F),{class:"w-4 h-4"})])])):u("",!0),t.min_price||t.max_price?(a(),o("span",Se,[$(" ₹"+n(t.min_price||0)+" - "+n(t.max_price||"∞")+" ",1),s("button",{onClick:X},[m(p(F),{class:"w-4 h-4"})])])):u("",!0)])]),s("div",qe,[s("aside",$e,[s("div",Fe,[s("div",{class:"flex items-center justify-between mb-4"},[e[22]||(e[22]=s("h3",{class:"font-semibold text-gray-900"},"Filters",-1)),s("button",{onClick:N,class:"text-sm text-primary-600 hover:underline"}," Clear all ")]),s("div",Me,[e[24]||(e[24]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Category",-1)),r(s("select",{"onUpdate:modelValue":e[4]||(e[4]=i=>t.category=i),class:"input text-sm"},[e[23]||(e[23]=s("option",{value:""},"All Categories",-1)),(a(!0),o(g,null,y(q.value,i=>(a(),o("option",{key:i.id,value:i.slug},n(i.name),9,Ve))),128))],512),[[U,t.category]])]),s("div",Ne,[e[25]||(e[25]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"City",-1)),r(s("input",{"onUpdate:modelValue":e[5]||(e[5]=i=>t.city=i),type:"text",placeholder:"Enter city",class:"input text-sm"},null,512),[[f,t.city]])]),s("div",Ue,[e[27]||(e[27]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Price Range",-1)),s("div",Le,[r(s("input",{"onUpdate:modelValue":e[6]||(e[6]=i=>t.min_price=i),type:"number",placeholder:"Min",class:"input text-sm"},null,512),[[f,t.min_price]]),e[26]||(e[26]=s("span",{class:"text-gray-400"},"-",-1)),r(s("input",{"onUpdate:modelValue":e[7]||(e[7]=i=>t.max_price=i),type:"number",placeholder:"Max",class:"input text-sm"},null,512),[[f,t.max_price]])])]),s("div",Pe,[e[28]||(e[28]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Condition",-1)),s("div",Ae,[(a(),o(g,null,y(B,i=>s("label",{key:i.value,class:"flex items-center"},[r(s("input",{type:"radio","onUpdate:modelValue":v=>t.condition=v,value:i.value,class:"text-primary-600"},null,8,je),[[me,t.condition]]),s("span",Be,n(i.label),1)])),64))])]),s("button",{onClick:d,class:"btn-primary w-full mb-3"}," Apply Filters "),K.value&&T.value?(a(),o("button",{key:0,onClick:e[8]||(e[8]=i=>_.value=!0),class:"btn-secondary w-full text-sm"},[m(p(E),{class:"w-4 h-4 mr-2"}),e[29]||(e[29]=$(" Save This Search ",-1))])):u("",!0)])]),s("main",Ke,[s("div",Re,[s("div",null,[s("h1",He,n(R.value?`"${R.value}"`:"All Listings"),1),s("p",Te,n(A.value)+" results",1)]),s("div",ze,[r(s("select",{"onUpdate:modelValue":e[9]||(e[9]=i=>t.sort=i),onChange:d,class:"input w-auto text-sm"},[...e[30]||(e[30]=[s("option",{value:"newest"},"Newest First",-1),s("option",{value:"price_low"},"Price: Low to High",-1),s("option",{value:"price_high"},"Price: High to Low",-1)])],544),[[U,t.sort]])])]),w.value&&!b.value.length?(a(),o("div",De,[(a(),o(g,null,y(6,i=>s("div",{key:i,class:"card p-3"},[...e[31]||(e[31]=[s("div",{class:"skeleton aspect-square mb-2 rounded-lg"},null,-1),s("div",{class:"skeleton h-4 w-16 mb-1"},null,-1),s("div",{class:"skeleton h-4 w-full mb-1"},null,-1),s("div",{class:"skeleton h-3 w-20"},null,-1)])])),64))])):b.value.length?(a(),o("div",Ee,[(a(!0),o(g,null,y(b.value,i=>(a(),pe(xe,{key:i.id,listing:i},null,8,["listing"]))),128))])):(a(),o("div",Ge,[m(p(ue),{class:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e[32]||(e[32]=s("h3",{class:"font-medium text-gray-900 mb-1"},"No results found",-1)),e[33]||(e[33]=s("p",{class:"text-sm text-gray-500 mb-4"},"Try adjusting your filters",-1)),s("button",{onClick:N,class:"btn-primary"},"Clear Filters")])),Z.value?(a(),o("div",Ie,[s("button",{onClick:Q,disabled:w.value,class:"btn-secondary"},n(w.value?"Loading...":"Load More"),9,Oe)])):u("",!0)])])]),x.value?(a(),o("div",Ye,[s("div",{class:"filter-backdrop",onClick:e[10]||(e[10]=i=>x.value=!1)}),s("div",Ze,[s("div",Je,[e[34]||(e[34]=s("h3",{class:"text-lg font-semibold"},"Filters",-1)),s("div",We,[s("button",{onClick:N,class:"text-sm text-primary-600 font-medium"},"Clear all"),s("button",{onClick:e[11]||(e[11]=i=>x.value=!1),class:"p-2 hover:bg-gray-100 rounded-full"},[m(p(F),{class:"w-5 h-5"})])])]),s("div",Xe,[s("div",Qe,[e[35]||(e[35]=s("h4",{class:"font-medium text-gray-900 mb-3"},"Category",-1)),s("div",et,[s("button",{onClick:e[12]||(e[12]=i=>t.category=""),class:M(["px-4 py-2 rounded-full border text-sm transition",t.category?"hover:bg-gray-50":"border-primary-500 bg-primary-50 text-primary-700"])}," All ",2),(a(!0),o(g,null,y(q.value,i=>(a(),o("button",{key:i.id,onClick:v=>t.category=i.slug,class:M(["px-4 py-2 rounded-full border text-sm transition",t.category===i.slug?"border-primary-500 bg-primary-50 text-primary-700":"hover:bg-gray-50"])},n(i.name),11,tt))),128))])]),s("div",st,[e[36]||(e[36]=s("h4",{class:"font-medium text-gray-900 mb-3"},"City",-1)),r(s("input",{"onUpdate:modelValue":e[13]||(e[13]=i=>t.city=i),type:"text",placeholder:"Enter city name",class:"input"},null,512),[[f,t.city]])]),s("div",it,[e[38]||(e[38]=s("h4",{class:"font-medium text-gray-900 mb-3"},"Price Range",-1)),s("div",lt,[(a(),o(g,null,y(Y,i=>s("button",{key:i.label,onClick:v=>W(i),class:M(["px-3 py-2 text-sm border rounded-full transition",String(t.min_price)===String(i.min)&&String(t.max_price)===String(i.max)?"border-primary-500 bg-primary-50 text-primary-700":"hover:bg-gray-50"])},n(i.label),11,at)),64))]),s("div",ot,[r(s("input",{"onUpdate:modelValue":e[14]||(e[14]=i=>t.min_price=i),type:"number",placeholder:"Min",class:"input text-center"},null,512),[[f,t.min_price]]),e[37]||(e[37]=s("span",{class:"text-gray-400"},"to",-1)),r(s("input",{"onUpdate:modelValue":e[15]||(e[15]=i=>t.max_price=i),type:"number",placeholder:"Max",class:"input text-center"},null,512),[[f,t.max_price]])])]),s("div",nt,[e[39]||(e[39]=s("h4",{class:"font-medium text-gray-900 mb-3"},"Condition",-1)),s("div",rt,[(a(),o(g,null,y(B,i=>s("button",{key:i.value,onClick:v=>t.condition=i.value,class:M(["px-4 py-2 rounded-full border text-sm transition",t.condition===i.value?"border-primary-500 bg-primary-50 text-primary-700":"hover:bg-gray-50"])},n(i.label),11,dt)),64))])])]),s("div",ct,[K.value&&T.value?(a(),o("button",{key:0,onClick:e[16]||(e[16]=i=>{_.value=!0,x.value=!1}),class:"btn-secondary"},[m(p(E),{class:"w-4 h-4"})])):u("",!0),s("button",{onClick:ee,class:"btn-primary flex-1"}," Show Results ")])])])):u("",!0),_.value?(a(),o("div",ut,[s("div",{class:"absolute inset-0 bg-black/50",onClick:e[17]||(e[17]=i=>_.value=!1)}),s("div",mt,[e[41]||(e[41]=s("h3",{class:"text-lg font-semibold mb-4"},"Save This Search",-1)),e[42]||(e[42]=s("p",{class:"text-sm text-gray-500 mb-4"},"Get notified when new listings match your search criteria.",-1)),s("div",pt,[e[40]||(e[40]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Search Name",-1)),r(s("input",{"onUpdate:modelValue":e[18]||(e[18]=i=>h.value=i),type:"text",class:"input",placeholder:"e.g., iPhone in Mumbai"},null,512),[[f,h.value]])]),s("div",vt,[s("button",{onClick:e[19]||(e[19]=i=>_.value=!1),class:"btn-secondary flex-1"},"Cancel"),s("button",{onClick:te,disabled:!h.value||S.value,class:"btn-primary flex-1"},n(S.value?"Saving...":"Save Search"),9,xt)])])])):u("",!0)]))}},$t=se(gt,[["__scopeId","data-v-2388eb31"]]);export{$t as default};
