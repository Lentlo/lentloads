import{_ as E,C as M,r as _,D as B,e as I,c as o,o as i,a as t,f as y,F as w,h as S,g as r,j as d,w as U,i as f,z as h,S as z,l as R,y as C,A as T,B as m,N as p,t as v,p as b,k as j,M as A}from"./main-D2LYTPc_.js";import{r as G}from"./BookmarkIcon-DQpm8Mls.js";import{r as L}from"./MapPinIcon-BnvZGxdN.js";import{r as P,a as W}from"./TrashIcon-diF1WIlo.js";import{r as H}from"./EnvelopeIcon-DEwKisrK.js";const J={class:"saved-searches-page"},K={class:"container-app py-6"},O={key:0,class:"searches-list"},Q={key:1,class:"searches-list"},X={class:"search-header"},Y={class:"search-info"},Z={class:"search-name"},ee={class:"search-tags"},te={key:0,class:"tag primary"},se={key:1,class:"tag"},ae={key:2,class:"tag"},ne={key:3,class:"tag"},oe={class:"search-actions"},ie=["onClick"],le=["onClick"],re=["onClick"],de={class:"notification-settings"},ce={class:"notification-toggles"},ue=["checked","onChange"],pe=["checked","onChange"],ve=["onUpdate:modelValue","onChange"],ye={key:2,class:"empty-state"},me={class:"empty-icon"},_e={class:"modal-content"},fe={class:"modal-header"},he={class:"modal-body"},ge={class:"modal-footer"},ke={__name:"SavedSearches",setup(we){const $=M(),g=_(!0),c=_([]),n=_(null),x=async()=>{try{const s=await m.get("/saved-searches");c.value=s.data.data.map(e=>({...e,notify_push:e.notify_push??!0,notify_email:e.notify_email??!0}))}finally{g.value=!1}},q=s=>{var l;const e={};s.query&&(e.q=s.query),s.category_id&&(e.category=(l=s.category)==null?void 0:l.slug),s.city&&(e.city=s.city),s.min_price&&(e.min_price=s.min_price),s.max_price&&(e.max_price=s.max_price),$.push({path:"/search",query:e})},N=s=>{n.value={...s}},F=async()=>{try{await m.put(`/saved-searches/${n.value.id}`,{name:n.value.name});const s=c.value.findIndex(e=>e.id===n.value.id);s!==-1&&(c.value[s].name=n.value.name),n.value=null,p.success("Search updated")}catch{p.error("Failed to update search")}},V=async s=>{if(confirm("Delete this saved search?"))try{await m.delete(`/saved-searches/${s}`),c.value=c.value.filter(e=>e.id!==s),p.success("Search deleted")}catch{p.error("Failed to delete search")}},k=async(s,e)=>{const l=e==="push"?"notify_push":"notify_email";s[l]=!s[l];try{await m.put(`/saved-searches/${s.id}`,{[l]:s[l]})}catch{s[l]=!s[l],p.error("Failed to update notification settings")}},D=async s=>{try{await m.put(`/saved-searches/${s.id}`,{notify_frequency:s.notify_frequency})}catch{p.error("Failed to update frequency")}};return B(()=>{x()}),(s,e)=>{const l=I("router-link");return i(),o("div",J,[t("div",K,[e[11]||(e[11]=t("div",{class:"page-header"},[t("div",null,[t("h1",null,"Saved Searches"),t("p",null,"Get notified when new items match your criteria")])],-1)),g.value?(i(),o("div",O,[(i(),o(w,null,S(3,a=>t("div",{key:a,class:"search-card-skeleton"},[...e[4]||(e[4]=[t("div",{class:"skeleton h-6 w-1/3 mb-3"},null,-1),t("div",{class:"skeleton h-4 w-2/3 mb-4"},null,-1),t("div",{class:"skeleton h-10 w-full"},null,-1)])])),64))])):c.value.length?(i(),o("div",Q,[(i(!0),o(w,null,S(c.value,a=>(i(),o("div",{key:a.id,class:"search-card"},[t("div",X,[t("div",Y,[t("h3",Z,v(a.name),1),t("div",ee,[a.query?(i(),o("span",te,[r(d(h),{class:"w-3 h-3"}),f(" "+v(a.query),1)])):y("",!0),a.category?(i(),o("span",se,v(a.category.name),1)):y("",!0),a.city?(i(),o("span",ae,[r(d(L),{class:"w-3 h-3"}),f(" "+v(a.city),1)])):y("",!0),a.min_price||a.max_price?(i(),o("span",ne," ₹"+v(a.min_price||0)+" - ₹"+v(a.max_price||"∞"),1)):y("",!0)])]),t("div",oe,[t("button",{onClick:u=>q(a),class:"action-btn primary",title:"Run search"},[r(d(h),{class:"w-5 h-5"})],8,ie),t("button",{onClick:u=>N(a),class:"action-btn",title:"Edit"},[r(d(P),{class:"w-5 h-5"})],8,le),t("button",{onClick:u=>V(a.id),class:"action-btn danger",title:"Delete"},[r(d(W),{class:"w-5 h-5"})],8,re)])]),t("div",de,[t("div",ce,[t("label",{class:b(["toggle-item",{active:a.notify_push}])},[t("input",{type:"checkbox",checked:a.notify_push,onChange:u=>k(a,"push")},null,40,ue),r(d(j),{class:"w-4 h-4"}),e[5]||(e[5]=t("span",null,"Push",-1))],2),t("label",{class:b(["toggle-item",{active:a.notify_email}])},[t("input",{type:"checkbox",checked:a.notify_email,onChange:u=>k(a,"email")},null,40,pe),r(d(H),{class:"w-4 h-4"}),e[6]||(e[6]=t("span",null,"Email",-1))],2)]),C(t("select",{"onUpdate:modelValue":u=>a.notify_frequency=u,onChange:u=>D(a),class:"frequency-select"},[...e[7]||(e[7]=[t("option",{value:"instant"},"Instant",-1),t("option",{value:"daily"},"Daily",-1),t("option",{value:"weekly"},"Weekly",-1)])],40,ve),[[A,a.notify_frequency]])])]))),128))])):(i(),o("div",ye,[t("div",me,[r(d(G),{class:"w-16 h-16"})]),e[9]||(e[9]=t("h3",null,"No saved searches",-1)),e[10]||(e[10]=t("p",null,"Save a search to get notified when new items are posted",-1)),r(l,{to:"/search",class:"btn-primary"},{default:U(()=>[r(d(h),{class:"w-5 h-5"}),e[8]||(e[8]=f(" Start Searching ",-1))]),_:1})]))]),n.value?(i(),o("div",{key:0,class:"modal-overlay",onClick:e[3]||(e[3]=z(a=>n.value=null,["self"]))},[t("div",_e,[t("div",fe,[e[12]||(e[12]=t("h3",null,"Edit Saved Search",-1)),t("button",{onClick:e[0]||(e[0]=a=>n.value=null),class:"modal-close"},[r(d(R),{class:"w-6 h-6"})])]),t("div",he,[e[13]||(e[13]=t("label",{class:"input-label"},"Search Name",-1)),C(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>n.value.name=a),type:"text",class:"input",placeholder:"Enter a name"},null,512),[[T,n.value.name]])]),t("div",ge,[t("button",{onClick:e[2]||(e[2]=a=>n.value=null),class:"btn-secondary"},"Cancel"),t("button",{onClick:F,class:"btn-primary"},"Save Changes")])])])):y("",!0)])}}},qe=E(ke,[["__scopeId","data-v-b11a6631"]]);export{qe as default};
