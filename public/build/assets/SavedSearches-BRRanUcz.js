import{C as D,r as f,D as j,e as B,c as n,o,a as t,f as y,F as b,h,g as p,j as v,z as k,w as E,i as g,y as w,A as M,B as m,Q as c,t as u,M as U}from"./main-s6bW8Jl1.js";import{r as z,a as I}from"./TrashIcon-BHKRTPA_.js";const R={class:"min-h-screen bg-gray-50 py-6"},T={class:"container-app max-w-2xl"},A={key:0,class:"space-y-4"},G={key:1,class:"space-y-4"},L={class:"flex items-start justify-between"},P={class:"flex-1"},Q={class:"font-semibold text-gray-900"},W={class:"flex flex-wrap gap-2 mt-2"},H={key:0,class:"badge-primary"},J={key:1,class:"badge bg-gray-100 text-gray-700"},K={key:2,class:"badge bg-gray-100 text-gray-700"},O={key:3,class:"badge bg-gray-100 text-gray-700"},X={class:"flex items-center gap-2"},Y=["onClick"],Z=["onClick"],ee=["onClick"],te={class:"flex items-center gap-4 mt-4 pt-4 border-t"},se={class:"flex items-center gap-2 text-sm"},ae=["checked","onChange"],ne={class:"flex items-center gap-2 text-sm"},oe=["checked","onChange"],ie=["onUpdate:modelValue","onChange"],le={key:2,class:"card p-12 text-center"},re={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},de={class:"relative bg-white rounded-xl p-6 w-full max-w-md"},ce={class:"space-y-4"},ue={class:"flex gap-2"},ve={__name:"SavedSearches",setup(ye){const C=D(),_=f(!0),r=f([]),i=f(null),S=async()=>{try{const s=await m.get("/saved-searches");r.value=s.data.data}finally{_.value=!1}},$=s=>{var l;const e={};s.query&&(e.q=s.query),s.category_id&&(e.category=(l=s.category)==null?void 0:l.slug),s.city&&(e.city=s.city),s.min_price&&(e.min_price=s.min_price),s.max_price&&(e.max_price=s.max_price),C.push({path:"/search",query:e})},q=s=>{i.value={...s}},F=async()=>{try{await m.put(`/saved-searches/${i.value.id}`,{name:i.value.name});const s=r.value.findIndex(e=>e.id===i.value.id);s!==-1&&(r.value[s].name=i.value.name),i.value=null,c.success("Search updated")}catch{c.error("Failed to update search")}},N=async s=>{if(confirm("Delete this saved search?"))try{await m.delete(`/saved-searches/${s}`),r.value=r.value.filter(e=>e.id!==s),c.success("Search deleted")}catch{c.error("Failed to delete search")}},x=async(s,e)=>{const l=e==="push"?"notify_push":"notify_email";s[l]=!s[l];try{await m.put(`/saved-searches/${s.id}`,{[l]:s[l]})}catch{s[l]=!s[l],c.error("Failed to update notification settings")}},V=async s=>{try{await m.put(`/saved-searches/${s.id}`,{notify_frequency:s.notify_frequency})}catch{c.error("Failed to update frequency")}};return j(()=>{S()}),(s,e)=>{const l=B("router-link");return o(),n("div",R,[t("div",T,[e[10]||(e[10]=t("div",{class:"flex items-center justify-between mb-6"},[t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900"},"Saved Searches"),t("p",{class:"text-gray-500"},"Get notified when new items match your criteria")])],-1)),_.value?(o(),n("div",A,[(o(),n(b,null,h(3,a=>t("div",{key:a,class:"card p-4"},[...e[3]||(e[3]=[t("div",{class:"skeleton h-5 w-1/3 mb-2"},null,-1),t("div",{class:"skeleton h-4 w-2/3"},null,-1)])])),64))])):r.value.length?(o(),n("div",G,[(o(!0),n(b,null,h(r.value,a=>(o(),n("div",{key:a.id,class:"card p-4"},[t("div",L,[t("div",P,[t("h3",Q,u(a.name),1),t("div",W,[a.query?(o(),n("span",H,' "'+u(a.query)+'" ',1)):y("",!0),a.category?(o(),n("span",J,u(a.category.name),1)):y("",!0),a.city?(o(),n("span",K,u(a.city),1)):y("",!0),a.min_price||a.max_price?(o(),n("span",O," ₹"+u(a.min_price||0)+" - ₹"+u(a.max_price||"∞"),1)):y("",!0)])]),t("div",X,[t("button",{onClick:d=>$(a),class:"p-2 text-primary-600 hover:bg-primary-50 rounded",title:"Run search"},[p(v(k),{class:"w-5 h-5"})],8,Y),t("button",{onClick:d=>q(a),class:"p-2 text-gray-600 hover:bg-gray-100 rounded",title:"Edit"},[p(v(z),{class:"w-5 h-5"})],8,Z),t("button",{onClick:d=>N(a.id),class:"p-2 text-red-600 hover:bg-red-50 rounded",title:"Delete"},[p(v(I),{class:"w-5 h-5"})],8,ee)])]),t("div",te,[t("label",se,[t("input",{type:"checkbox",checked:a.notify_push,onChange:d=>x(a,"push"),class:"rounded text-primary-600"},null,40,ae),e[4]||(e[4]=g(" Push notifications ",-1))]),t("label",ne,[t("input",{type:"checkbox",checked:a.notify_email,onChange:d=>x(a,"email"),class:"rounded text-primary-600"},null,40,oe),e[5]||(e[5]=g(" Email notifications ",-1))]),w(t("select",{"onUpdate:modelValue":d=>a.notify_frequency=d,onChange:d=>V(a),class:"text-sm border rounded px-2 py-1"},[...e[6]||(e[6]=[t("option",{value:"instant"},"Instant",-1),t("option",{value:"daily"},"Daily",-1),t("option",{value:"weekly"},"Weekly",-1)])],40,ie),[[U,a.notify_frequency]])])]))),128))])):(o(),n("div",le,[p(v(k),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e[8]||(e[8]=t("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No saved searches",-1)),e[9]||(e[9]=t("p",{class:"text-gray-500 mb-4"}," Save a search to get notified when new items are posted ",-1)),p(l,{to:"/search",class:"btn-primary"},{default:E(()=>[...e[7]||(e[7]=[g(" Start Searching ",-1)])]),_:1})]))]),i.value?(o(),n("div",re,[t("div",{class:"absolute inset-0 bg-black/50",onClick:e[0]||(e[0]=a=>i.value=null)}),t("div",de,[e[12]||(e[12]=t("h3",{class:"text-lg font-semibold mb-4"},"Edit Saved Search",-1)),t("div",ce,[t("div",null,[e[11]||(e[11]=t("label",{class:"label"},"Name",-1)),w(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>i.value.name=a),type:"text",class:"input"},null,512),[[M,i.value.name]])]),t("div",ue,[t("button",{onClick:e[2]||(e[2]=a=>i.value=null),class:"btn-secondary flex-1"}," Cancel "),t("button",{onClick:F,class:"btn-primary flex-1"}," Save ")])])])])):y("",!0)])}}};export{ve as default};
