import{u as H,x as S,r as l,d as $,L as j,D as A,e as E,c as o,o as s,a as e,f as N,g as B,w as y,i as _,t as u,y as R,M as T,F as x,h as f,B as V,m as F}from"./main-D2LYTPc_.js";import{L as U}from"./ListingCard-DG0THier.js";import"./listings-Cva7YYCu.js";import"./dayjs.min-iy57P9mS.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./relativeTime-D5nU98bY.js";import"./SparklesIcon-B2mT40aJ.js";import"./BoltIcon-Cm5lx0Dj.js";import"./MapPinIcon-BnvZGxdN.js";const q={class:"min-h-screen bg-gray-50 py-6"},z={class:"container-app"},G={class:"flex items-center gap-2 text-sm mb-4"},I={class:"text-gray-900"},J={class:"flex items-center justify-between mb-6"},K={class:"text-2xl font-bold text-gray-900"},O={class:"text-gray-500"},Q={key:0,class:"flex flex-wrap gap-2 mb-6"},W={key:1,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},X={key:2,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},Y={key:3,class:"card p-12 text-center"},Z={key:4,class:"mt-6 text-center"},tt=["disabled"],ut={__name:"CategoryListings",setup(et){const g=H();S();const d=l(!0),n=l(null),i=l([]),p=l("newest"),v=l(1),h=l(1),w=l(0),P=$(()=>v.value<h.value),k=async()=>{try{const r=await V.get(`/categories/${g.params.slug}`);n.value=r.data.data.category}catch{console.error("Failed to fetch category")}},c=async(r=!1)=>{d.value=!0;try{const t=await V.get("/listings",{params:{category:g.params.slug,sort:p.value,page:r?v.value+1:1}});r?i.value=[...i.value,...t.data.data]:i.value=t.data.data,w.value=t.data.meta.total,v.value=t.data.meta.current_page,h.value=t.data.meta.last_page}finally{d.value=!1}},D=()=>{c(!0)};return j(()=>g.params.slug,()=>{k(),c()}),A(()=>{k(),c()}),(r,t)=>{var b,C,L,M;const m=E("router-link");return s(),o("div",q,[e("div",z,[e("nav",G,[B(m,{to:"/",class:"text-gray-500 hover:text-gray-700"},{default:y(()=>[...t[1]||(t[1]=[_("Home",-1)])]),_:1}),t[3]||(t[3]=e("span",{class:"text-gray-400"},"/",-1)),B(m,{to:"/categories",class:"text-gray-500 hover:text-gray-700"},{default:y(()=>[...t[2]||(t[2]=[_("Categories",-1)])]),_:1}),t[4]||(t[4]=e("span",{class:"text-gray-400"},"/",-1)),e("span",I,u((b=n.value)==null?void 0:b.name),1)]),e("div",J,[e("div",null,[e("h1",K,u((C=n.value)==null?void 0:C.name),1),e("p",O,u(w.value)+" ads found",1)]),R(e("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>p.value=a),onChange:c,class:"input w-auto"},[...t[5]||(t[5]=[e("option",{value:"newest"},"Newest First",-1),e("option",{value:"price_low"},"Price: Low to High",-1),e("option",{value:"price_high"},"Price: High to Low",-1)])],544),[[T,p.value]])]),(M=(L=n.value)==null?void 0:L.children)!=null&&M.length?(s(),o("div",Q,[(s(!0),o(x,null,f(n.value.children,a=>(s(),F(m,{key:a.id,to:`/category/${a.slug}`,class:"px-4 py-2 bg-white rounded-full border hover:border-primary-500 hover:text-primary-600 text-sm"},{default:y(()=>[_(u(a.name),1)]),_:2},1032,["to"]))),128))])):N("",!0),d.value?(s(),o("div",W,[(s(),o(x,null,f(8,a=>e("div",{key:a,class:"card p-4"},[...t[6]||(t[6]=[e("div",{class:"skeleton h-40 mb-3"},null,-1),e("div",{class:"skeleton h-4 w-20 mb-2"},null,-1),e("div",{class:"skeleton h-4 w-full"},null,-1)])])),64))])):i.value.length?(s(),o("div",X,[(s(!0),o(x,null,f(i.value,a=>(s(),F(U,{key:a.id,listing:a},null,8,["listing"]))),128))])):(s(),o("div",Y,[...t[7]||(t[7]=[e("p",{class:"text-gray-500"},"No listings in this category yet",-1)])])),P.value?(s(),o("div",Z,[e("button",{onClick:D,disabled:d.value,class:"btn-secondary"}," Load More ",8,tt)])):N("",!0)])])}}};export{ut as default};
