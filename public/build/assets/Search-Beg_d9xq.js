import{c as o,o as a,a as t,_ as se,u as le,C as ie,x as ae,b as oe,r as d,K as ne,d as _,D as re,L as ue,f as c,g as m,j as p,t as n,y as r,M as U,G as de,i as C,l as M,F as y,h as f,A as g,z as ce,p as V,N as j,B as me,O as pe,m as ve}from"./main-ic6Y-wVz.js";import{u as xe}from"./listings-CeCJz1KE.js";import{_ as ye}from"./ListingCard-Cuov-xYM.js";import"./dayjs.min-iy57P9mS.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./relativeTime-D5nU98bY.js";import"./SparklesIcon-DcFpBC3-.js";import"./BoltIcon-C6J91Xk5.js";import"./MapPinIcon-yPBkqx-C.js";import"./ClockIcon-By1ykGMY.js";function fe(A,S){return a(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0m3 0a1.5 1.5 0 1 0-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-9.75 0h9.75"})])}function E(A,S){return a(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0 1 11.186 0Z"})])}const ge={class:"min-h-screen bg-gray-50"},be={class:"container-app py-4"},he={class:"lg:hidden mb-4"},ke={class:"flex items-center gap-2 overflow-x-auto pb-2 scrollbar-hide"},_e={key:0,class:"w-5 h-5 bg-primary-600 text-white text-xs rounded-full flex items-center justify-center"},we={class:"relative flex-shrink-0"},Ce={key:0,class:"px-3 py-2 bg-primary-100 text-primary-700 rounded-full text-sm flex items-center gap-1 flex-shrink-0"},Se={key:1,class:"px-3 py-2 bg-primary-100 text-primary-700 rounded-full text-sm flex items-center gap-1 flex-shrink-0"},$e={key:2,class:"px-3 py-2 bg-primary-100 text-primary-700 rounded-full text-sm flex items-center gap-1 flex-shrink-0"},Fe={class:"flex flex-col lg:flex-row gap-6"},Me={class:"hidden lg:block lg:w-64 flex-shrink-0"},Ve={class:"card p-4 sticky top-20"},qe={class:"mb-5"},Le=["value"],Ne={class:"mb-5"},Ue={class:"mb-5"},je={class:"flex items-center gap-2"},Ae={class:"mb-5"},Pe={class:"space-y-2"},Be=["onUpdate:modelValue","value"],Ke={class:"ml-2 text-sm text-gray-600"},Re={class:"flex-1"},He={class:"flex items-center justify-between mb-4"},Te={class:"text-lg lg:text-xl font-bold text-gray-900"},ze={class:"text-sm text-gray-500"},Ee={class:"hidden lg:flex items-center gap-3"},De={key:0,class:"grid grid-cols-2 md:grid-cols-3 gap-3"},Ge={key:1,class:"grid grid-cols-2 md:grid-cols-3 gap-3"},Oe={key:2,class:"card p-8 text-center"},Ie={key:3,class:"mt-6 text-center"},Ye=["disabled"],Ze={key:0,class:"fixed inset-0 z-50 flex items-end justify-center lg:hidden"},Je={class:"relative bg-white w-full rounded-t-2xl max-h-[85vh] flex flex-col animate-slide-up"},Qe={class:"flex items-center justify-between p-4 border-b flex-shrink-0"},We={class:"flex items-center gap-2"},Xe={class:"flex-1 overflow-y-auto p-4 space-y-6"},et={class:"flex flex-wrap gap-2"},tt=["onClick"],st={class:"flex flex-wrap gap-2 mb-3"},lt=["onClick"],it={class:"flex items-center gap-3"},at={class:"flex flex-wrap gap-2"},ot=["onClick"],nt={class:"p-4 border-t bg-gray-50 flex-shrink-0 safe-area-bottom"},rt={class:"flex gap-3"},ut={key:1,class:"fixed inset-0 z-50 flex items-end sm:items-center justify-center"},dt={class:"relative bg-white w-full sm:max-w-sm sm:rounded-xl rounded-t-2xl p-6 safe-area-bottom animate-slide-up"},ct={class:"mb-4"},mt={class:"flex gap-3"},pt=["disabled"],vt={__name:"Search",setup(A){const S=le(),D=ie(),G=ae(),O=oe(),I=xe(),w=d(!1),b=d([]),q=d(0),L=d(1),P=d(1),x=d(!1),h=d(!1),k=d(""),$=d(!1),s=ne({q:"",category:"",city:"",min_price:"",max_price:"",condition:"",sort:"newest"}),B=[{value:"",label:"All"},{value:"new",label:"New"},{value:"like_new",label:"Like New"},{value:"good",label:"Good"},{value:"fair",label:"Fair"}],Y=[{label:"Under ₹1K",min:"",max:1e3},{label:"₹1K - ₹5K",min:1e3,max:5e3},{label:"₹5K - ₹10K",min:5e3,max:1e4},{label:"₹10K+",min:1e4,max:""}],F=_(()=>G.categories),K=_(()=>O.isAuthenticated),R=_(()=>s.q),Z=_(()=>L.value<P.value),H=_(()=>{let i=0;return s.category&&i++,s.city&&i++,(s.min_price||s.max_price)&&i++,s.condition&&i++,i}),T=_(()=>s.q||s.category||s.city||s.min_price||s.max_price||s.condition),J=i=>{const e=F.value.find(l=>l.slug===i);return(e==null?void 0:e.name)||i},Q=i=>{s.min_price=i.min,s.max_price=i.max},z=i=>{s[i]="",u()},W=()=>{s.min_price="",s.max_price="",u()},u=async(i=!1)=>{w.value=!0;try{const e={...s,page:i?L.value+1:1};Object.keys(e).forEach(v=>{(e[v]===""||e[v]===null)&&delete e[v]});const l=await I.fetchListings(e,i);i?b.value=[...b.value,...l.data]:b.value=l.data,q.value=l.meta.total,L.value=l.meta.current_page,P.value=l.meta.last_page,D.replace({query:e})}catch{j.error("Failed to fetch listings")}finally{w.value=!1}},X=()=>u(!0),ee=()=>{x.value=!1,u()},N=()=>{s.category="",s.city="",s.min_price="",s.max_price="",s.condition="",s.sort="newest",x.value=!1,u()},te=async()=>{var i;if(k.value){$.value=!0;try{await me.post("/saved-searches",{name:k.value,query:s.q||null,category_id:((i=F.value.find(e=>e.slug===s.category))==null?void 0:i.id)||null,city:s.city||null,min_price:s.min_price||null,max_price:s.max_price||null,condition:s.condition||null}),j.success("Search saved! You'll be notified of new listings."),h.value=!1,k.value=""}catch{j.error("Failed to save search")}finally{$.value=!1}}};return re(()=>{const i=S.query;i.q&&(s.q=i.q),i.category&&(s.category=i.category),i.city&&(s.city=i.city),i.min_price&&(s.min_price=i.min_price),i.max_price&&(s.max_price=i.max_price),i.condition&&(s.condition=i.condition),i.sort&&(s.sort=i.sort),u()}),ue(()=>S.query.q,i=>{i!==s.q&&(s.q=i||"",u())}),(i,e)=>(a(),o("div",ge,[t("div",be,[t("div",he,[t("div",ke,[t("button",{onClick:e[0]||(e[0]=l=>x.value=!0),class:"flex items-center gap-2 px-4 py-2.5 bg-white rounded-full border shadow-sm flex-shrink-0"},[m(p(fe),{class:"w-5 h-5 text-gray-600"}),e[20]||(e[20]=t("span",{class:"text-sm font-medium"},"Filters",-1)),H.value>0?(a(),o("span",_e,n(H.value),1)):c("",!0)]),t("div",we,[r(t("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>s.sort=l),onChange:u,class:"appearance-none px-4 py-2.5 pr-8 bg-white rounded-full border shadow-sm text-sm font-medium"},[...e[21]||(e[21]=[t("option",{value:"newest"},"Newest",-1),t("option",{value:"price_low"},"Price: Low",-1),t("option",{value:"price_high"},"Price: High",-1)])],544),[[U,s.sort]]),m(p(de),{class:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"})]),s.category?(a(),o("span",Ce,[C(n(J(s.category))+" ",1),t("button",{onClick:e[2]||(e[2]=l=>z("category"))},[m(p(M),{class:"w-4 h-4"})])])):c("",!0),s.city?(a(),o("span",Se,[C(n(s.city)+" ",1),t("button",{onClick:e[3]||(e[3]=l=>z("city"))},[m(p(M),{class:"w-4 h-4"})])])):c("",!0),s.min_price||s.max_price?(a(),o("span",$e,[C(" ₹"+n(s.min_price||0)+" - "+n(s.max_price||"∞")+" ",1),t("button",{onClick:W},[m(p(M),{class:"w-4 h-4"})])])):c("",!0)])]),t("div",Fe,[t("aside",Me,[t("div",Ve,[t("div",{class:"flex items-center justify-between mb-4"},[e[22]||(e[22]=t("h3",{class:"font-semibold text-gray-900"},"Filters",-1)),t("button",{onClick:N,class:"text-sm text-primary-600 hover:underline"}," Clear all ")]),t("div",qe,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Category",-1)),r(t("select",{"onUpdate:modelValue":e[4]||(e[4]=l=>s.category=l),class:"input text-sm"},[e[23]||(e[23]=t("option",{value:""},"All Categories",-1)),(a(!0),o(y,null,f(F.value,l=>(a(),o("option",{key:l.id,value:l.slug},n(l.name),9,Le))),128))],512),[[U,s.category]])]),t("div",Ne,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"City",-1)),r(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>s.city=l),type:"text",placeholder:"Enter city",class:"input text-sm"},null,512),[[g,s.city]])]),t("div",Ue,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Price Range",-1)),t("div",je,[r(t("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>s.min_price=l),type:"number",placeholder:"Min",class:"input text-sm"},null,512),[[g,s.min_price]]),e[26]||(e[26]=t("span",{class:"text-gray-400"},"-",-1)),r(t("input",{"onUpdate:modelValue":e[7]||(e[7]=l=>s.max_price=l),type:"number",placeholder:"Max",class:"input text-sm"},null,512),[[g,s.max_price]])])]),t("div",Ae,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Condition",-1)),t("div",Pe,[(a(),o(y,null,f(B,l=>t("label",{key:l.value,class:"flex items-center"},[r(t("input",{type:"radio","onUpdate:modelValue":v=>s.condition=v,value:l.value,class:"text-primary-600"},null,8,Be),[[pe,s.condition]]),t("span",Ke,n(l.label),1)])),64))])]),t("button",{onClick:u,class:"btn-primary w-full mb-3"}," Apply Filters "),K.value&&T.value?(a(),o("button",{key:0,onClick:e[8]||(e[8]=l=>h.value=!0),class:"btn-secondary w-full text-sm"},[m(p(E),{class:"w-4 h-4 mr-2"}),e[29]||(e[29]=C(" Save This Search ",-1))])):c("",!0)])]),t("main",Re,[t("div",He,[t("div",null,[t("h1",Te,n(R.value?`"${R.value}"`:"All Listings"),1),t("p",ze,n(q.value)+" results",1)]),t("div",Ee,[r(t("select",{"onUpdate:modelValue":e[9]||(e[9]=l=>s.sort=l),onChange:u,class:"input w-auto text-sm"},[...e[30]||(e[30]=[t("option",{value:"newest"},"Newest First",-1),t("option",{value:"price_low"},"Price: Low to High",-1),t("option",{value:"price_high"},"Price: High to Low",-1)])],544),[[U,s.sort]])])]),w.value&&!b.value.length?(a(),o("div",De,[(a(),o(y,null,f(6,l=>t("div",{key:l,class:"card p-3"},[...e[31]||(e[31]=[t("div",{class:"skeleton aspect-square mb-2 rounded-lg"},null,-1),t("div",{class:"skeleton h-4 w-16 mb-1"},null,-1),t("div",{class:"skeleton h-4 w-full mb-1"},null,-1),t("div",{class:"skeleton h-3 w-20"},null,-1)])])),64))])):b.value.length?(a(),o("div",Ge,[(a(!0),o(y,null,f(b.value,l=>(a(),ve(ye,{key:l.id,listing:l},null,8,["listing"]))),128))])):(a(),o("div",Oe,[m(p(ce),{class:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e[32]||(e[32]=t("h3",{class:"font-medium text-gray-900 mb-1"},"No results found",-1)),e[33]||(e[33]=t("p",{class:"text-sm text-gray-500 mb-4"},"Try adjusting your filters",-1)),t("button",{onClick:N,class:"btn-primary"},"Clear Filters")])),Z.value?(a(),o("div",Ie,[t("button",{onClick:X,disabled:w.value,class:"btn-secondary"},n(w.value?"Loading...":"Load More"),9,Ye)])):c("",!0)])])]),x.value?(a(),o("div",Ze,[t("div",{class:"absolute inset-0 bg-black/50",onClick:e[10]||(e[10]=l=>x.value=!1)}),t("div",Je,[t("div",Qe,[e[34]||(e[34]=t("h3",{class:"text-lg font-semibold"},"Filters",-1)),t("div",We,[t("button",{onClick:N,class:"text-sm text-primary-600"},"Clear"),t("button",{onClick:e[11]||(e[11]=l=>x.value=!1),class:"p-2 hover:bg-gray-100 rounded-full"},[m(p(M),{class:"w-5 h-5"})])])]),t("div",Xe,[t("div",null,[e[35]||(e[35]=t("h4",{class:"font-medium text-gray-900 mb-3"},"Category",-1)),t("div",et,[t("button",{onClick:e[12]||(e[12]=l=>s.category=""),class:V(["px-4 py-2 rounded-full border text-sm transition",s.category?"hover:bg-gray-50":"border-primary-500 bg-primary-50 text-primary-700"])}," All ",2),(a(!0),o(y,null,f(F.value,l=>(a(),o("button",{key:l.id,onClick:v=>s.category=l.slug,class:V(["px-4 py-2 rounded-full border text-sm transition",s.category===l.slug?"border-primary-500 bg-primary-50 text-primary-700":"hover:bg-gray-50"])},n(l.name),11,tt))),128))])]),t("div",null,[e[36]||(e[36]=t("h4",{class:"font-medium text-gray-900 mb-3"},"City",-1)),r(t("input",{"onUpdate:modelValue":e[13]||(e[13]=l=>s.city=l),type:"text",placeholder:"Enter city name",class:"input"},null,512),[[g,s.city]])]),t("div",null,[e[38]||(e[38]=t("h4",{class:"font-medium text-gray-900 mb-3"},"Price Range",-1)),t("div",st,[(a(),o(y,null,f(Y,l=>t("button",{key:l.label,onClick:v=>Q(l),class:V(["px-3 py-2 text-sm border rounded-full transition",s.min_price==l.min&&s.max_price==l.max?"border-primary-500 bg-primary-50 text-primary-700":"hover:bg-gray-50"])},n(l.label),11,lt)),64))]),t("div",it,[r(t("input",{"onUpdate:modelValue":e[14]||(e[14]=l=>s.min_price=l),type:"number",placeholder:"Min",class:"input text-center"},null,512),[[g,s.min_price]]),e[37]||(e[37]=t("span",{class:"text-gray-400"},"to",-1)),r(t("input",{"onUpdate:modelValue":e[15]||(e[15]=l=>s.max_price=l),type:"number",placeholder:"Max",class:"input text-center"},null,512),[[g,s.max_price]])])]),t("div",null,[e[39]||(e[39]=t("h4",{class:"font-medium text-gray-900 mb-3"},"Condition",-1)),t("div",at,[(a(),o(y,null,f(B,l=>t("button",{key:l.value,onClick:v=>s.condition=l.value,class:V(["px-4 py-2 rounded-full border text-sm transition",s.condition===l.value?"border-primary-500 bg-primary-50 text-primary-700":"hover:bg-gray-50"])},n(l.label),11,ot)),64))])])]),t("div",nt,[t("div",rt,[K.value&&T.value?(a(),o("button",{key:0,onClick:e[16]||(e[16]=l=>{h.value=!0,x.value=!1}),class:"btn-secondary flex-1"},[m(p(E),{class:"w-4 h-4 mr-1"}),e[40]||(e[40]=C(" Save ",-1))])):c("",!0),t("button",{onClick:ee,class:"btn-primary flex-1"}," Show "+n(q.value)+" Results ",1)])])])])):c("",!0),h.value?(a(),o("div",ut,[t("div",{class:"absolute inset-0 bg-black/50",onClick:e[17]||(e[17]=l=>h.value=!1)}),t("div",dt,[e[42]||(e[42]=t("h3",{class:"text-lg font-semibold mb-4"},"Save This Search",-1)),e[43]||(e[43]=t("p",{class:"text-sm text-gray-500 mb-4"},"Get notified when new listings match your search criteria.",-1)),t("div",ct,[e[41]||(e[41]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Search Name",-1)),r(t("input",{"onUpdate:modelValue":e[18]||(e[18]=l=>k.value=l),type:"text",class:"input",placeholder:"e.g., iPhone in Mumbai"},null,512),[[g,k.value]])]),t("div",mt,[t("button",{onClick:e[19]||(e[19]=l=>h.value=!1),class:"btn-secondary flex-1"},"Cancel"),t("button",{onClick:te,disabled:!k.value||$.value,class:"btn-primary flex-1"},n($.value?"Saving...":"Save Search"),9,pt)])])])):c("",!0)]))}},St=se(vt,[["__scopeId","data-v-9ddf9cac"]]);export{St as default};
