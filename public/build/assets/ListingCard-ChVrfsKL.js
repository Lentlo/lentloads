import{_ as F,b as L,r as N,d as l,e as $,m as S,o,w as B,a as s,c as n,f as c,g as d,j as u,p as h,S as M,D as j,t as r,I as D}from"./main-CiloBcIY.js";import{u as I}from"./listings-C2Q8YkpN.js";import{d as p}from"./dayjs.min-CGwYmnBf.js";import{r as V}from"./relativeTime-B6fBnRv1.js";import{r as E}from"./SparklesIcon-DMpjJaUI.js";import{r as z}from"./BoltIcon-DnasuLOT.js";const A={class:"card-image"},P=["src","alt"],R={key:0,class:"badge-featured"},q={key:1,class:"badge-urgent"},G={class:"card-content"},O={class:"price-row"},T={class:"price"},U={key:0,class:"condition-badge"},H={class:"card-title"},J={class:"meta-row"},K={class:"location"},Q={key:0,class:"distance"},W={key:1,class:"time"},X={__name:"ListingCard",props:{listing:{type:Object,required:!0},showFavorite:{type:Boolean,default:!0}},setup(i){p.extend(V);const a=i,v=L(),_=I(),g=N(a.listing.is_favorited||!1),w=l(()=>{var e;return(a.listing.formatted_price||`â‚¹${(e=a.listing.price)==null?void 0:e.toLocaleString()}`).replace(/\s*\(Negotiable\)/gi,"").trim()}),f=l(()=>{const t=a.listing.condition;return t?{new:"New",like_new:"Like New",good:"Good",fair:"Fair",poor:"Poor"}[t.toLowerCase()]||t.replace(/_/g," "):""}),y=l(()=>{const e=(a.listing.location||a.listing.city||"").split(",")[0].trim();return e.length>15?e.substring(0,15)+"...":e}),m=l(()=>{const t=a.listing.distance;return t==null?"":t<1?`${Math.round(t*1e3)}m away`:t<10?`${t.toFixed(1)} km`:`${Math.round(t)} km`}),k=async()=>{if(!v.isAuthenticated)return;const t=await _.toggleFavorite(a.listing.id);g.value=t.is_favorited},b=t=>{if(!t)return"Recently";const e=p(t);return e.isValid()?e.fromNow():"Recently"},C=t=>{t.target.dataset.fallback||(t.target.dataset.fallback="true",t.target.src="https://placehold.co/400x400/e2e8f0/64748b?text=No+Image")};return(t,e)=>{const x=$("router-link");return o(),S(x,{to:`/listing/${i.listing.slug}`,class:"listing-card group"},{default:B(()=>[s("div",A,[s("img",{src:i.listing.primary_image_url,alt:i.listing.title,class:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105",loading:"lazy",onError:C},null,40,P),i.listing.is_featured?(o(),n("div",R,[d(u(E),{class:"w-3 h-3"}),e[0]||(e[0]=s("span",null,"Featured",-1))])):c("",!0),i.listing.is_urgent?(o(),n("div",q,[d(u(z),{class:"w-3 h-3"}),e[1]||(e[1]=s("span",null,"Urgent",-1))])):c("",!0),i.showFavorite?(o(),n("button",{key:2,onClick:M(k,["prevent"]),class:h(["btn-favorite",{"is-favorited":g.value}])},[d(u(j),{class:h(["w-5 h-5",g.value?"fill-current":""])},null,8,["class"])],2)):c("",!0)]),s("div",G,[s("div",O,[s("span",T,r(w.value),1),f.value?(o(),n("span",U,r(f.value),1)):c("",!0)]),s("h3",H,r(i.listing.title),1),s("div",J,[s("span",K,[d(u(D),{class:"w-3.5 h-3.5"}),s("span",null,r(y.value),1)]),m.value?(o(),n("span",Q,r(m.value),1)):(o(),n("span",W,r(b(i.listing.published_at||i.listing.created_at)),1))])])]),_:1},8,["to"])}}},at=F(X,[["__scopeId","data-v-fde42dff"]]);export{at as L};
