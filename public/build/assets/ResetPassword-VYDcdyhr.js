import{c as i,o as a,a as s,u as I,H as A,I as D,d as p,e as L,A as E,f as H,h as n,w as g,k as l,j as b,V as z,g as k,L as h,O as U,W as $,n as c,F as Z,i as G,q,t as _,D as W}from"./main-BdLjsYX5.js";import{_ as Y}from"./LoadingSpinner-Cc5uihe_.js";import{r as O}from"./CheckCircleIcon-BHeAchP9.js";import{r as J}from"./ExclamationCircleIcon-Cf5Q-jGp.js";import{r as N}from"./LockClosedIcon-Dqt_Ia_O.js";import{r as R}from"./EyeIcon-CbrMZm3d.js";import{r as S}from"./EyeSlashIcon-C-2g7y6x.js";function K(j,w){return a(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25Z"})])}const Q={class:"min-h-screen bg-gray-50 flex items-center justify-center p-4"},X={class:"w-full max-w-md"},ee={class:"text-center mb-8"},se={class:"card p-8"},te={key:0,class:"text-center"},oe={class:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4"},re={key:1,class:"text-center"},ae={class:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4"},le={key:2},ne={class:"text-center mb-6"},ie={class:"w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-4"},de={class:"relative"},ue=["type"],pe={class:"relative"},me=["type"],ce={key:0,class:"space-y-2"},we={class:"flex gap-1"},fe={key:1,class:"text-sm text-red-600"},ve=["disabled"],Ce={__name:"ResetPassword",setup(j){const w=I();A();const o=D({email:"",password:"",password_confirmation:"",token:""}),f=p(!1),v=p(!1),m=p(!1),C=p(!1),x=p(!1),d=p(""),M=["","Weak","Fair","Good","Strong"],T=["","bg-red-500","bg-yellow-500","bg-blue-500","bg-green-500"],B=["","text-red-600","text-yellow-600","text-blue-600","text-green-600"],y=L(()=>{const r=o.password;if(!r)return 0;let e=0;return r.length>=8&&e++,/[a-z]/.test(r)&&/[A-Z]/.test(r)&&e++,/\d/.test(r)&&e++,/[^a-zA-Z0-9]/.test(r)&&e++,e}),P=L(()=>o.password.length>=8&&o.password===o.password_confirmation),V=r=>{r&&setTimeout(()=>{r.scrollIntoView({behavior:"smooth",block:"center"})},300)},F=async()=>{var r,e,u;if(!P.value){o.password!==o.password_confirmation&&(d.value="Passwords do not match");return}d.value="",m.value=!0;try{await W.post("/auth/reset-password",o),C.value=!0}catch(t){((r=t.response)==null?void 0:r.status)===400||((e=t.response)==null?void 0:e.status)===422?(d.value=t.response.data.message||"Invalid or expired reset link",(u=t.response.data.errors)!=null&&u.token&&(x.value=!0)):d.value="Something went wrong. Please try again."}finally{m.value=!1}};return E(()=>{o.token=w.query.token||w.params.token||"",o.email=w.query.email||"",o.token||(x.value=!0)}),(r,e)=>{const u=H("router-link");return a(),i("div",Q,[s("div",X,[s("div",ee,[n(u,{to:"/",class:"inline-block"},{default:g(()=>[...e[7]||(e[7]=[s("h1",{class:"text-3xl font-bold text-primary-600"},"Lentloads",-1)])]),_:1})]),s("div",se,[C.value?(a(),i("div",te,[s("div",oe,[n(l(O),{class:"w-8 h-8 text-green-600"})]),e[9]||(e[9]=s("h2",{class:"text-xl font-bold text-gray-900 mb-2"},"Password Reset!",-1)),e[10]||(e[10]=s("p",{class:"text-gray-500 mb-6"}," Your password has been successfully reset. You can now log in with your new password. ",-1)),n(u,{to:"/login",class:"btn-primary w-full"},{default:g(()=>[...e[8]||(e[8]=[b(" Go to Login ",-1)])]),_:1})])):x.value?(a(),i("div",re,[s("div",ae,[n(l(J),{class:"w-8 h-8 text-red-600"})]),e[12]||(e[12]=s("h2",{class:"text-xl font-bold text-gray-900 mb-2"},"Invalid or Expired Link",-1)),e[13]||(e[13]=s("p",{class:"text-gray-500 mb-6"}," This password reset link is invalid or has expired. Please request a new one. ",-1)),n(u,{to:"/forgot-password",class:"btn-primary w-full"},{default:g(()=>[...e[11]||(e[11]=[b(" Request New Link ",-1)])]),_:1})])):(a(),i("div",le,[s("div",ne,[s("div",ie,[n(l(K),{class:"w-8 h-8 text-primary-600"})]),e[14]||(e[14]=s("h2",{class:"text-xl font-bold text-gray-900"},"Set new password",-1)),e[15]||(e[15]=s("p",{class:"text-gray-500 mt-1"}," Enter your new password below ",-1))]),s("form",{onSubmit:z(F,["prevent"]),class:"space-y-4"},[s("div",null,[e[16]||(e[16]=s("label",{class:"label"},"Email address",-1)),h(s("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>o.email=t),type:"email",class:"input bg-gray-50",readonly:""},null,512),[[U,o.email]])]),s("div",null,[e[17]||(e[17]=s("label",{class:"label"},"New Password",-1)),s("div",de,[n(l(N),{class:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),h(s("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>o.password=t),type:f.value?"text":"password",class:"input pl-10 pr-10",placeholder:"Minimum 8 characters",required:"",minlength:"8",onFocus:e[2]||(e[2]=t=>V(t.target))},null,40,ue),[[$,o.password]]),s("button",{type:"button",onClick:e[3]||(e[3]=t=>f.value=!f.value),class:"absolute right-3 top-1/2 -translate-y-1/2"},[f.value?(a(),c(l(S),{key:1,class:"w-5 h-5 text-gray-400"})):(a(),c(l(R),{key:0,class:"w-5 h-5 text-gray-400"}))])])]),s("div",null,[e[18]||(e[18]=s("label",{class:"label"},"Confirm New Password",-1)),s("div",pe,[n(l(N),{class:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),h(s("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>o.password_confirmation=t),type:v.value?"text":"password",class:"input pl-10 pr-10",placeholder:"Confirm your password",required:"",onFocus:e[5]||(e[5]=t=>V(t.target))},null,40,me),[[$,o.password_confirmation]]),s("button",{type:"button",onClick:e[6]||(e[6]=t=>v.value=!v.value),class:"absolute right-3 top-1/2 -translate-y-1/2"},[v.value?(a(),c(l(S),{key:1,class:"w-5 h-5 text-gray-400"})):(a(),c(l(R),{key:0,class:"w-5 h-5 text-gray-400"}))])])]),o.password?(a(),i("div",ce,[s("div",we,[(a(),i(Z,null,G(4,t=>s("div",{key:t,class:q(["h-1 flex-1 rounded",t<=y.value?T[y.value]:"bg-gray-200"])},null,2)),64))]),s("p",{class:q(["text-xs",B[y.value]])},_(M[y.value]),3)])):k("",!0),d.value?(a(),i("p",fe,_(d.value),1)):k("",!0),s("button",{type:"submit",disabled:m.value||!P.value,class:"btn-primary w-full"},[m.value?(a(),c(Y,{key:0,class:"mr-2"})):k("",!0),b(" "+_(m.value?"Resetting...":"Reset Password"),1)],8,ve)],32)]))])])])}}};export{Ce as default};
