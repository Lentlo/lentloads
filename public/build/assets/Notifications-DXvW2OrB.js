import{C as M,r as n,d as B,D as S,c as o,o as s,a,f as u,F as _,h as f,g as I,j as F,k as y,t as m,B as p,p as x,m as L,n as V,Q as O}from"./main-DmsOSjqV.js";import{d as h}from"./dayjs.min-Bof1u0Bp.js";import{r as P}from"./relativeTime-Ckc_g6N8.js";import{r as R}from"./ShoppingBagIcon-Bj9rB4w_.js";import{r as z}from"./ExclamationCircleIcon-tDS7XF9v.js";import{r as A}from"./CheckCircleIcon-Cvg07Ek_.js";import{r as E}from"./ChatBubbleLeftIcon-Tf4PrBoQ.js";const Q={class:"min-h-screen bg-gray-50 py-6"},T={class:"container-app max-w-2xl"},Y={class:"flex items-center justify-between mb-6"},q={key:0,class:"space-y-2"},G={key:1,class:"space-y-2"},H=["onClick"],J={class:"flex-1 min-w-0"},K={class:"text-gray-900"},U={class:"text-sm text-gray-500 mt-1"},W={key:0,class:"w-2 h-2 bg-primary-600 rounded-full"},X={key:2,class:"card p-12 text-center"},Z={key:3,class:"mt-6 text-center"},ee=["disabled"],ie={__name:"Notifications",setup(te){h.extend(P);const k=M(),c=n(!0),d=n(!1),l=n([]),i=n(1),g=n(1),b=B(()=>i.value<g.value),w=e=>h(e).fromNow(),C=e=>({message:E,favorite:O,listing_approved:A,listing_rejected:z,sold:R})[e]||y,N=e=>({message:"bg-blue-100 text-blue-600",favorite:"bg-red-100 text-red-600",listing_approved:"bg-green-100 text-green-600",listing_rejected:"bg-red-100 text-red-600",sold:"bg-purple-100 text-purple-600"})[e]||"bg-gray-100 text-gray-600",v=async(e=!1)=>{e?d.value=!0:c.value=!0;try{const t=await p.get("/notifications",{params:{page:e?i.value+1:1}});e?l.value=[...l.value,...t.data.data]:l.value=t.data.data,i.value=t.data.meta.current_page,g.value=t.data.meta.last_page}finally{c.value=!1,d.value=!1}},$=async e=>{e.read_at||(await p.post(`/notifications/${e.id}/read`),e.read_at=new Date().toISOString()),e.data.url&&k.push(e.data.url)},j=async()=>{try{await p.post("/notifications/read-all"),l.value=l.value.map(e=>({...e,read_at:e.read_at||new Date().toISOString()}))}catch{console.error("Failed to mark all as read")}},D=()=>{v(!0)};return S(()=>{v()}),(e,t)=>(s(),o("div",Q,[a("div",T,[a("div",Y,[t[0]||(t[0]=a("h1",{class:"text-2xl font-bold text-gray-900"},"Notifications",-1)),l.value.length?(s(),o("button",{key:0,onClick:j,class:"text-sm text-primary-600 hover:underline"}," Mark all as read ")):u("",!0)]),c.value?(s(),o("div",q,[(s(),o(_,null,f(5,r=>a("div",{key:r,class:"card p-4 flex gap-4"},[...t[1]||(t[1]=[a("div",{class:"skeleton w-10 h-10 rounded-full"},null,-1),a("div",{class:"flex-1"},[a("div",{class:"skeleton h-4 w-3/4 mb-2"}),a("div",{class:"skeleton h-3 w-1/4"})],-1)])])),64))])):l.value.length?(s(),o("div",G,[(s(!0),o(_,null,f(l.value,r=>(s(),o("div",{key:r.id,class:x(["card p-4 flex gap-4 cursor-pointer hover:shadow-md transition",r.read_at?"":"bg-primary-50 border-primary-200"]),onClick:ae=>$(r)},[a("div",{class:x(["w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0",N(r.data.type)])},[(s(),L(V(C(r.data.type)),{class:"w-5 h-5"}))],2),a("div",J,[a("p",K,m(r.data.message),1),a("p",U,m(w(r.created_at)),1)]),r.read_at?u("",!0):(s(),o("div",W))],10,H))),128))])):(s(),o("div",X,[I(F(y),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),t[2]||(t[2]=a("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No notifications",-1)),t[3]||(t[3]=a("p",{class:"text-gray-500"},"You're all caught up!",-1))])),b.value?(s(),o("div",Z,[a("button",{onClick:D,disabled:d.value,class:"btn-secondary"},m(d.value?"Loading...":"Load More"),9,ee)])):u("",!0)])]))}};export{ie as default};
