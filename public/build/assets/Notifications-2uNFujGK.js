var p=(v,d,i)=>new Promise((r,c)=>{var m=l=>{try{u(i.next(l))}catch(g){c(g)}},x=l=>{try{u(i.throw(l))}catch(g){c(g)}},u=l=>l.done?r(l.value):Promise.resolve(l.value).then(m,x);u((i=i.apply(v,d)).next())});import{k as n,l as o,p as s,u as E,f as _,b as k,o as F,x as b,F as C,I as $,B as y,a as N,A as j,J as O,H as h,z as P,K as R,L as T}from"./vue-vendor-Clry8SR-.js";import{l as M,b as f,f as J,c as K}from"./main-capacitor-rPhIOL4v.js";import{d as B}from"./dayjs.min-VXSoyYVV.js";import{r as U}from"./relativeTime-BN4FbP67.js";import{r as S}from"./CheckCircleIcon-CSRmO4e-.js";import{r as W,a as A}from"./ClockIcon-BKZzCkR-.js";import"./ui-vendor-B7DvqItC.js";function q(v,d){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"}),s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 6h.008v.008H6V6Z"})])}function I(v,d){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}const G={class:"notifications-page min-h-screen bg-gray-50"},Q={class:"container-app py-4 max-w-2xl"},X={class:"flex items-center justify-between mb-4"},Y={key:0,class:"space-y-3"},ee={key:1,class:"space-y-2"},te=["onClick"],se={class:"flex gap-3"},ae={class:"flex-1 min-w-0"},re={class:"text-xs text-gray-500 mt-1"},oe=["onClick"],ne={key:0,class:"text-center pt-4"},ie=["disabled"],le={key:2,class:"card p-12 text-center"},fe={__name:"Notifications",setup(v){B.extend(U);const d=E(),i=_(!0),r=_([]),c=_(1),m=_(1),x=k(()=>c.value<m.value),u=k(()=>r.value.some(e=>!e.read_at)),l=e=>B(e).fromNow(),g=e=>({listing_approved:S,listing_rejected:I,listing_pending:A,listing_expired:A,new_message:W,new_offer:q,offer_accepted:S,offer_rejected:I,new_favorite:K})[e]||M,L=e=>({listing_approved:"bg-green-100 text-green-600",listing_rejected:"bg-red-100 text-red-600",listing_pending:"bg-yellow-100 text-yellow-600",listing_expired:"bg-gray-100 text-gray-600",new_message:"bg-blue-100 text-blue-600",new_offer:"bg-purple-100 text-purple-600",offer_accepted:"bg-green-100 text-green-600",offer_rejected:"bg-red-100 text-red-600",new_favorite:"bg-pink-100 text-pink-600"})[e]||"bg-gray-100 text-gray-600",w=(e=!1)=>p(this,null,function*(){i.value=!0;try{const t=yield f.get("/notifications",{params:{page:e?c.value+1:1}}),a=t.data.data;e?r.value=[...r.value,...a]:r.value=a,c.value=t.data.meta.current_page,m.value=t.data.meta.last_page}finally{i.value=!1}}),V=()=>w(!0),D=e=>p(this,null,function*(){if(!e.read_at)try{yield f.post(`/notifications/${e.id}/read`),e.read_at=new Date().toISOString()}catch(a){}const t=e.data;t.listing_slug?d.push(`/listing/${t.listing_slug}`):t.conversation_uuid&&d.push(`/messages/${t.conversation_uuid}`)}),H=()=>p(this,null,function*(){try{yield f.post("/notifications/read-all"),r.value.forEach(e=>e.read_at=new Date().toISOString())}catch(e){}}),Z=e=>p(this,null,function*(){try{yield f.delete(`/notifications/${e}`),r.value=r.value.filter(t=>t.id!==e)}catch(t){}});return F(()=>w()),(e,t)=>(o(),n("div",G,[s("div",Q,[s("div",X,[t[0]||(t[0]=s("h1",{class:"text-xl font-bold text-gray-900"},"Notifications",-1)),r.value.length&&u.value?(o(),n("button",{key:0,onClick:H,class:"text-sm text-primary-600 hover:underline"}," Mark all as read ")):b("",!0)]),i.value&&!r.value.length?(o(),n("div",Y,[(o(),n(C,null,$(5,a=>s("div",{key:a,class:"card p-4"},[...t[1]||(t[1]=[O('<div class="flex gap-3"><div class="skeleton w-10 h-10 rounded-full"></div><div class="flex-1"><div class="skeleton h-4 w-3/4 mb-2"></div><div class="skeleton h-3 w-1/2"></div></div></div>',1)])])),64))])):r.value.length?(o(),n("div",ee,[(o(!0),n(C,null,$(r.value,a=>(o(),n("div",{key:a.id,onClick:z=>D(a),class:h(["card p-4 cursor-pointer hover:bg-gray-50 transition",a.read_at?"":"border-l-4 border-l-primary-500 bg-primary-50/30"])},[s("div",se,[s("div",{class:h(["w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0",L(a.data.type)])},[(o(),P(R(g(a.data.type)),{class:"w-5 h-5"}))],2),s("div",ae,[s("p",{class:h(["text-sm text-gray-900",a.read_at?"":"font-medium"])},y(a.data.message),3),s("p",re,y(l(a.created_at)),1)]),s("button",{onClick:T(z=>Z(a.id),["stop"]),class:"p-1 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded"},[N(j(J),{class:"w-4 h-4"})],8,oe)])],10,te))),128)),x.value?(o(),n("div",ne,[s("button",{onClick:V,disabled:i.value,class:"btn-secondary"},y(i.value?"Loading...":"Load More"),9,ie)])):b("",!0)])):(o(),n("div",le,[N(j(M),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),t[2]||(t[2]=s("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No notifications yet",-1)),t[3]||(t[3]=s("p",{class:"text-gray-500"},"We'll notify you about your listings and messages",-1))]))])]))}};export{fe as default};
