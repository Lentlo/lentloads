import{l as S,r as n,b as D,m as I,c as l,o as s,a,g as u,F as _,j as y,d as B,e as F,S as f,t as m,k as p,I as x,p as L,A as V,M as A}from"./main-Cx-ihLLO.js";import{d as h}from"./dayjs.min-Bof1u0Bp.js";import{r as O}from"./relativeTime-Ckc_g6N8.js";import{r as P}from"./ShoppingBagIcon-CQaHhQzl.js";import{r as R}from"./ExclamationCircleIcon-OYYlFPrP.js";import{r as z}from"./CheckCircleIcon-CMjgFuzh.js";import{r as E}from"./ChatBubbleLeftIcon-DZRSXmNg.js";const T={class:"min-h-screen bg-gray-50 py-6"},Y={class:"container-app max-w-2xl"},q={class:"flex items-center justify-between mb-6"},G={key:0,class:"space-y-2"},H={key:1,class:"space-y-2"},J=["onClick"],K={class:"flex-1 min-w-0"},Q={class:"text-gray-900"},U={class:"text-sm text-gray-500 mt-1"},W={key:0,class:"w-2 h-2 bg-primary-600 rounded-full"},X={key:2,class:"card p-12 text-center"},Z={key:3,class:"mt-6 text-center"},ee=["disabled"],ie={__name:"Notifications",setup(te){h.extend(O);const b=S(),c=n(!0),d=n(!1),o=n([]),i=n(1),g=n(1),k=D(()=>i.value<g.value),w=e=>h(e).fromNow(),C=e=>({message:E,favorite:A,listing_approved:z,listing_rejected:R,sold:P})[e]||f,N=e=>({message:"bg-blue-100 text-blue-600",favorite:"bg-red-100 text-red-600",listing_approved:"bg-green-100 text-green-600",listing_rejected:"bg-red-100 text-red-600",sold:"bg-purple-100 text-purple-600"})[e]||"bg-gray-100 text-gray-600",v=async(e=!1)=>{e?d.value=!0:c.value=!0;try{const t=await p.get("/notifications",{params:{page:e?i.value+1:1}});e?o.value=[...o.value,...t.data.data]:o.value=t.data.data,i.value=t.data.meta.current_page,g.value=t.data.meta.last_page}finally{c.value=!1,d.value=!1}},M=async e=>{e.read_at||(await p.post(`/notifications/${e.id}/read`),e.read_at=new Date().toISOString()),e.data.url&&b.push(e.data.url)},$=async()=>{try{await p.post("/notifications/read-all"),o.value=o.value.map(e=>({...e,read_at:e.read_at||new Date().toISOString()}))}catch{console.error("Failed to mark all as read")}},j=()=>{v(!0)};return I(()=>{v()}),(e,t)=>(s(),l("div",T,[a("div",Y,[a("div",q,[t[0]||(t[0]=a("h1",{class:"text-2xl font-bold text-gray-900"},"Notifications",-1)),o.value.length?(s(),l("button",{key:0,onClick:$,class:"text-sm text-primary-600 hover:underline"}," Mark all as read ")):u("",!0)]),c.value?(s(),l("div",G,[(s(),l(_,null,y(5,r=>a("div",{key:r,class:"card p-4 flex gap-4"},[...t[1]||(t[1]=[a("div",{class:"skeleton w-10 h-10 rounded-full"},null,-1),a("div",{class:"flex-1"},[a("div",{class:"skeleton h-4 w-3/4 mb-2"}),a("div",{class:"skeleton h-3 w-1/4"})],-1)])])),64))])):o.value.length?(s(),l("div",H,[(s(!0),l(_,null,y(o.value,r=>(s(),l("div",{key:r.id,class:x(["card p-4 flex gap-4 cursor-pointer hover:shadow-md transition",r.read_at?"":"bg-primary-50 border-primary-200"]),onClick:ae=>M(r)},[a("div",{class:x(["w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0",N(r.data.type)])},[(s(),L(V(C(r.data.type)),{class:"w-5 h-5"}))],2),a("div",K,[a("p",Q,m(r.data.message),1),a("p",U,m(w(r.created_at)),1)]),r.read_at?u("",!0):(s(),l("div",W))],10,J))),128))])):(s(),l("div",X,[B(F(f),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),t[2]||(t[2]=a("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No notifications",-1)),t[3]||(t[3]=a("p",{class:"text-gray-500"},"You're all caught up!",-1))])),k.value?(s(),l("div",Z,[a("button",{onClick:j,disabled:d.value,class:"btn-secondary"},m(d.value?"Loading...":"Load More"),9,ee)])):u("",!0)])]))}};export{ie as default};
