import{c as i,o as a,a as s,u as E,D as z,L as D,r as p,d as V,E as A,e as F,g as n,w as g,j as l,i as b,T as H,f as h,z as k,B as U,V as L,m as c,F as Z,h as G,p as $,t as _,C as I}from"./main-BcQgb7cf.js";import{_ as Y}from"./LoadingSpinner-B1Y8Axy0.js";import{r as W}from"./CheckCircleIcon-C6yG_kJE.js";import{r as J}from"./ExclamationCircleIcon-5beKc2hX.js";import{r as N}from"./LockClosedIcon-Cz75ySN2.js";import{r as R}from"./EyeIcon-B01ZSI1s.js";import{r as S}from"./EyeSlashIcon-B4WlhwBq.js";function K(j,w){return a(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25Z"})])}const O={class:"min-h-screen bg-gray-50 flex items-center justify-center p-4"},Q={class:"w-full max-w-md"},X={class:"text-center mb-8"},ee={class:"card p-8"},se={key:0,class:"text-center"},te={class:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4"},re={key:1,class:"text-center"},ae={class:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4"},oe={key:2},le={class:"text-center mb-6"},ne={class:"w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-4"},ie={class:"relative"},de=["type"],ue={class:"relative"},pe=["type"],me={key:0,class:"space-y-2"},ce={class:"flex gap-1"},we={key:1,class:"text-sm text-red-600"},fe=["disabled"],_e={__name:"ResetPassword",setup(j){const w=E();z();const t=D({email:"",password:"",password_confirmation:"",token:""}),f=p(!1),v=p(!1),m=p(!1),C=p(!1),x=p(!1),d=p(""),q=["","Weak","Fair","Good","Strong"],B=["","bg-red-500","bg-yellow-500","bg-blue-500","bg-green-500"],M=["","text-red-600","text-yellow-600","text-blue-600","text-green-600"],y=V(()=>{const o=t.password;if(!o)return 0;let e=0;return o.length>=8&&e++,/[a-z]/.test(o)&&/[A-Z]/.test(o)&&e++,/\d/.test(o)&&e++,/[^a-zA-Z0-9]/.test(o)&&e++,e}),P=V(()=>t.password.length>=8&&t.password===t.password_confirmation),T=async()=>{var o,e,u;if(!P.value){t.password!==t.password_confirmation&&(d.value="Passwords do not match");return}d.value="",m.value=!0;try{await I.post("/auth/reset-password",t),C.value=!0}catch(r){((o=r.response)==null?void 0:o.status)===400||((e=r.response)==null?void 0:e.status)===422?(d.value=r.response.data.message||"Invalid or expired reset link",(u=r.response.data.errors)!=null&&u.token&&(x.value=!0)):d.value="Something went wrong. Please try again."}finally{m.value=!1}};return A(()=>{t.token=w.query.token||w.params.token||"",t.email=w.query.email||"",t.token||(x.value=!0)}),(o,e)=>{const u=F("router-link");return a(),i("div",O,[s("div",Q,[s("div",X,[n(u,{to:"/",class:"inline-block"},{default:g(()=>[...e[5]||(e[5]=[s("h1",{class:"text-3xl font-bold text-primary-600"},"Lentloads",-1)])]),_:1})]),s("div",ee,[C.value?(a(),i("div",se,[s("div",te,[n(l(W),{class:"w-8 h-8 text-green-600"})]),e[7]||(e[7]=s("h2",{class:"text-xl font-bold text-gray-900 mb-2"},"Password Reset!",-1)),e[8]||(e[8]=s("p",{class:"text-gray-500 mb-6"}," Your password has been successfully reset. You can now log in with your new password. ",-1)),n(u,{to:"/login",class:"btn-primary w-full"},{default:g(()=>[...e[6]||(e[6]=[b(" Go to Login ",-1)])]),_:1})])):x.value?(a(),i("div",re,[s("div",ae,[n(l(J),{class:"w-8 h-8 text-red-600"})]),e[10]||(e[10]=s("h2",{class:"text-xl font-bold text-gray-900 mb-2"},"Invalid or Expired Link",-1)),e[11]||(e[11]=s("p",{class:"text-gray-500 mb-6"}," This password reset link is invalid or has expired. Please request a new one. ",-1)),n(u,{to:"/forgot-password",class:"btn-primary w-full"},{default:g(()=>[...e[9]||(e[9]=[b(" Request New Link ",-1)])]),_:1})])):(a(),i("div",oe,[s("div",le,[s("div",ne,[n(l(K),{class:"w-8 h-8 text-primary-600"})]),e[12]||(e[12]=s("h2",{class:"text-xl font-bold text-gray-900"},"Set new password",-1)),e[13]||(e[13]=s("p",{class:"text-gray-500 mt-1"}," Enter your new password below ",-1))]),s("form",{onSubmit:H(T,["prevent"]),class:"space-y-4"},[s("div",null,[e[14]||(e[14]=s("label",{class:"label"},"Email address",-1)),k(s("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>t.email=r),type:"email",class:"input bg-gray-50",readonly:""},null,512),[[U,t.email]])]),s("div",null,[e[15]||(e[15]=s("label",{class:"label"},"New Password",-1)),s("div",ie,[n(l(N),{class:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),k(s("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>t.password=r),type:f.value?"text":"password",class:"input pl-10 pr-10",placeholder:"Minimum 8 characters",required:"",minlength:"8"},null,8,de),[[L,t.password]]),s("button",{type:"button",onClick:e[2]||(e[2]=r=>f.value=!f.value),class:"absolute right-3 top-1/2 -translate-y-1/2"},[f.value?(a(),c(l(S),{key:1,class:"w-5 h-5 text-gray-400"})):(a(),c(l(R),{key:0,class:"w-5 h-5 text-gray-400"}))])])]),s("div",null,[e[16]||(e[16]=s("label",{class:"label"},"Confirm New Password",-1)),s("div",ue,[n(l(N),{class:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),k(s("input",{"onUpdate:modelValue":e[3]||(e[3]=r=>t.password_confirmation=r),type:v.value?"text":"password",class:"input pl-10 pr-10",placeholder:"Confirm your password",required:""},null,8,pe),[[L,t.password_confirmation]]),s("button",{type:"button",onClick:e[4]||(e[4]=r=>v.value=!v.value),class:"absolute right-3 top-1/2 -translate-y-1/2"},[v.value?(a(),c(l(S),{key:1,class:"w-5 h-5 text-gray-400"})):(a(),c(l(R),{key:0,class:"w-5 h-5 text-gray-400"}))])])]),t.password?(a(),i("div",me,[s("div",ce,[(a(),i(Z,null,G(4,r=>s("div",{key:r,class:$(["h-1 flex-1 rounded",r<=y.value?B[y.value]:"bg-gray-200"])},null,2)),64))]),s("p",{class:$(["text-xs",M[y.value]])},_(q[y.value]),3)])):h("",!0),d.value?(a(),i("p",we,_(d.value),1)):h("",!0),s("button",{type:"submit",disabled:m.value||!P.value,class:"btn-primary w-full"},[m.value?(a(),c(Y,{key:0,class:"mr-2"})):h("",!0),b(" "+_(m.value?"Resetting...":"Reset Password"),1)],8,fe)],32)]))])])])}}};export{_e as default};
