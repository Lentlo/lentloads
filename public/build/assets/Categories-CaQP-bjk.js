import{r as g,K as I,d as K,D as Q,c as i,o,a as e,f as w,g as c,i as V,j as p,U as j,F as $,h as U,t as a,S as G,y as r,A as x,M as A,P as T,B as F,Q as y}from"./main-s6bW8Jl1.js";import{r as B,a as D}from"./TrashIcon-BHKRTPA_.js";const H={class:"p-6"},J={class:"flex items-center justify-between mb-6"},O={class:"card"},R={key:0,class:"p-8 text-center text-gray-500"},W={key:1,class:"p-8 text-center text-gray-500"},X={key:2,class:"divide-y"},Y={class:"flex items-center justify-between"},Z={class:"flex items-center gap-3"},ee={class:"text-2xl"},te={class:"font-semibold text-gray-900"},se={class:"text-sm text-gray-500"},le={key:0},ne={class:"flex items-center gap-2"},ie=["onClick"],oe=["onClick"],ae=["onClick"],de={key:0,class:"mt-3 ml-10 space-y-2"},re={class:"flex items-center gap-3"},ue={class:"font-medium text-gray-900"},ce={class:"text-sm text-gray-500"},pe={class:"flex items-center gap-2"},me=["onClick"],ve=["onClick"],be={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},_e={class:"relative bg-white rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto"},fe={class:"text-lg font-semibold mb-4"},ge={key:0},xe=["value"],ye={class:"flex items-center gap-4"},Ce={class:"flex items-center gap-2"},he={class:"flex items-center gap-2"},ke={class:"border-t pt-4"},we=["onUpdate:modelValue"],Ve=["onUpdate:modelValue"],$e=["onClick"],Ue={class:"flex gap-2 pt-4"},Fe=["disabled"],Ne={__name:"Categories",setup(Me){const M=g(!0),C=g(!1),h=g([]),v=g(!1),b=g(null),s=I({name:"",slug:"",icon:"",parent_id:null,description:"",is_active:!0,is_featured:!1,custom_fields:[]}),E=K(()=>h.value.filter(n=>!n.parent_id)),S=async()=>{M.value=!0;try{const n=await F.get("/admin/categories");h.value=n.data.data}finally{M.value=!1}},k=(n=null,t=null)=>{b.value=n,n?(s.name=n.name,s.slug=n.slug,s.icon=n.icon||"",s.parent_id=n.parent_id,s.description=n.description||"",s.is_active=n.is_active,s.is_featured=n.is_featured,s.custom_fields=n.custom_fields||[]):(s.name="",s.slug="",s.icon="",s.parent_id=t,s.description="",s.is_active=!0,s.is_featured=!1,s.custom_fields=[]),v.value=!0},L=()=>{s.custom_fields.push({name:"",type:"text",options:[]})},P=n=>{s.custom_fields.splice(n,1)},q=async()=>{var n;C.value=!0;try{const t={name:s.name,slug:s.slug||null,icon:s.icon||null,parent_id:s.parent_id,description:s.description||null,is_active:s.is_active,is_featured:s.is_featured,custom_fields:s.custom_fields.filter(m=>m.name)};(n=b.value)!=null&&n.id?(await F.put(`/admin/categories/${b.value.id}`,t),y.success("Category updated")):(await F.post("/admin/categories",t),y.success("Category created")),v.value=!1,S()}catch{y.error("Failed to save category")}finally{C.value=!1}},N=async n=>{var _;const m=((_=n.children)==null?void 0:_.length)>0?`Delete "${n.name}" and all its subcategories? This cannot be undone.`:`Delete "${n.name}"? This cannot be undone.`;if(confirm(m))try{await F.delete(`/admin/categories/${n.id}`),y.success("Category deleted"),S()}catch{y.error("Failed to delete category")}};return Q(()=>{S()}),(n,t)=>{var m,_;return o(),i("div",H,[e("div",J,[t[11]||(t[11]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Manage Categories",-1)),e("button",{onClick:t[0]||(t[0]=l=>k(null)),class:"btn-primary"},[c(p(j),{class:"w-5 h-5 mr-2"}),t[10]||(t[10]=V(" Add Category ",-1))])]),e("div",O,[M.value?(o(),i("div",R," Loading... ")):h.value.length?(o(),i("div",X,[(o(!0),i($,null,U(h.value,l=>{var f,u;return o(),i("div",{key:l.id,class:"p-4"},[e("div",Y,[e("div",Z,[e("span",ee,a(l.icon),1),e("div",null,[e("p",te,a(l.name),1),e("p",se,[V(a(l.listings_count||0)+" listings ",1),(f=l.children)!=null&&f.length?(o(),i("span",le," â€¢ "+a(l.children.length)+" subcategories ",1)):w("",!0)])])]),e("div",ne,[e("button",{onClick:d=>k(l),class:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Edit"},[c(p(B),{class:"w-5 h-5"})],8,ie),e("button",{onClick:d=>k(null,l.id),class:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Add Subcategory"},[c(p(j),{class:"w-5 h-5"})],8,oe),e("button",{onClick:d=>N(l),class:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete"},[c(p(D),{class:"w-5 h-5"})],8,ae)])]),(u=l.children)!=null&&u.length?(o(),i("div",de,[(o(!0),i($,null,U(l.children,d=>(o(),i("div",{key:d.id,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[e("div",re,[e("span",null,a(d.icon||"ðŸ“"),1),e("div",null,[e("p",ue,a(d.name),1),e("p",ce,a(d.listings_count||0)+" listings",1)])]),e("div",pe,[e("button",{onClick:z=>k(d),class:"p-1 text-blue-600 hover:bg-blue-100 rounded",title:"Edit"},[c(p(B),{class:"w-4 h-4"})],8,me),e("button",{onClick:z=>N(d),class:"p-1 text-red-600 hover:bg-red-100 rounded",title:"Delete"},[c(p(D),{class:"w-4 h-4"})],8,ve)])]))),128))])):w("",!0)])}),128))])):(o(),i("div",W," No categories yet. Create your first category! "))]),v.value?(o(),i("div",be,[e("div",{class:"absolute inset-0 bg-black/50",onClick:t[1]||(t[1]=l=>v.value=!1)}),e("div",_e,[e("h3",fe,a((m=b.value)!=null&&m.id?"Edit Category":"Add Category"),1),e("form",{onSubmit:G(q,["prevent"]),class:"space-y-4"},[e("div",null,[t[12]||(t[12]=e("label",{class:"label"},"Name",-1)),r(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>s.name=l),type:"text",class:"input",required:""},null,512),[[x,s.name]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"label"},"Slug",-1)),r(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>s.slug=l),type:"text",class:"input",placeholder:"auto-generated if empty"},null,512),[[x,s.slug]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"label"},"Icon (emoji)",-1)),r(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>s.icon=l),type:"text",class:"input",placeholder:"ðŸ“±"},null,512),[[x,s.icon]])]),(_=b.value)!=null&&_.id?w("",!0):(o(),i("div",ge,[t[16]||(t[16]=e("label",{class:"label"},"Parent Category",-1)),r(e("select",{"onUpdate:modelValue":t[5]||(t[5]=l=>s.parent_id=l),class:"input"},[t[15]||(t[15]=e("option",{value:null},"None (Top Level)",-1)),(o(!0),i($,null,U(E.value,l=>(o(),i("option",{key:l.id,value:l.id},a(l.name),9,xe))),128))],512),[[A,s.parent_id]])])),e("div",null,[t[17]||(t[17]=e("label",{class:"label"},"Description",-1)),r(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=l=>s.description=l),rows:"2",class:"input"},null,512),[[x,s.description]])]),e("div",ye,[e("label",Ce,[r(e("input",{"onUpdate:modelValue":t[7]||(t[7]=l=>s.is_active=l),type:"checkbox",class:"rounded text-primary-600"},null,512),[[T,s.is_active]]),t[18]||(t[18]=V(" Active ",-1))]),e("label",he,[r(e("input",{"onUpdate:modelValue":t[8]||(t[8]=l=>s.is_featured=l),type:"checkbox",class:"rounded text-primary-600"},null,512),[[T,s.is_featured]]),t[19]||(t[19]=V(" Featured ",-1))])]),e("div",ke,[e("div",{class:"flex items-center justify-between mb-3"},[t[20]||(t[20]=e("label",{class:"label mb-0"},"Custom Fields",-1)),e("button",{type:"button",onClick:L,class:"text-sm text-primary-600 hover:underline"}," + Add Field ")]),(o(!0),i($,null,U(s.custom_fields,(l,f)=>(o(),i("div",{key:f,class:"flex gap-2 mb-2"},[r(e("input",{"onUpdate:modelValue":u=>l.name=u,type:"text",class:"input flex-1",placeholder:"Field name"},null,8,we),[[x,l.name]]),r(e("select",{"onUpdate:modelValue":u=>l.type=u,class:"input w-32"},[...t[21]||(t[21]=[e("option",{value:"text"},"Text",-1),e("option",{value:"number"},"Number",-1),e("option",{value:"select"},"Select",-1),e("option",{value:"checkbox"},"Checkbox",-1)])],8,Ve),[[A,l.type]]),e("button",{type:"button",onClick:u=>P(f),class:"p-2 text-red-600 hover:bg-red-50 rounded"},[c(p(D),{class:"w-4 h-4"})],8,$e)]))),128))]),e("div",Ue,[e("button",{type:"button",onClick:t[9]||(t[9]=l=>v.value=!1),class:"btn-secondary flex-1"}," Cancel "),e("button",{type:"submit",disabled:C.value,class:"btn-primary flex-1"},a(C.value?"Saving...":"Save Category"),9,Fe)])],32)])])):w("",!0)])}}};export{Ne as default};
