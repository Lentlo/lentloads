import{c as n,o,a,E as O,r as i,d as _,y as P,f,F as y,h as x,t as g,g as h,j as w,k as b,B as d,C as R,p,m as T,n as z,S as U,l as W,D as Z}from"./main-DdZfx2Js.js";import{d as k}from"./dayjs.min-zY7PfvS3.js";import{r as q}from"./relativeTime-BFRLY0ae.js";import{r as C}from"./CheckCircleIcon-B3NzeHRa.js";import{r as G}from"./TagIcon-BPzuRZOE.js";import{r as H}from"./ChatBubbleLeftIcon-kXfEzjjr.js";import{r as $}from"./ClockIcon-B-7tY-R8.js";function N(j,c){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}const J={class:"min-h-screen bg-gray-50"},K={class:"container-app py-4 max-w-2xl"},Q={class:"flex items-center justify-between mb-4"},X={key:0,class:"space-y-3"},Y={key:1,class:"space-y-2"},ee=["onClick"],te={class:"flex gap-3"},se={class:"flex-1 min-w-0"},ae={class:"text-xs text-gray-500 mt-1"},re=["onClick"],oe={key:0,class:"text-center pt-4"},ne=["disabled"],le={key:2,class:"card p-12 text-center"},ve={__name:"Notifications",setup(j){k.extend(q);const c=O(),l=i(!0),r=i([]),u=i(1),m=i(1),M=_(()=>u.value<m.value),S=_(()=>r.value.some(e=>!e.read_at)),B=e=>k(e).fromNow(),D=e=>({listing_approved:C,listing_rejected:N,listing_pending:$,listing_expired:$,new_message:H,new_offer:G,offer_accepted:C,offer_rejected:N,new_favorite:Z})[e]||b,I=e=>({listing_approved:"bg-green-100 text-green-600",listing_rejected:"bg-red-100 text-red-600",listing_pending:"bg-yellow-100 text-yellow-600",listing_expired:"bg-gray-100 text-gray-600",new_message:"bg-blue-100 text-blue-600",new_offer:"bg-purple-100 text-purple-600",offer_accepted:"bg-green-100 text-green-600",offer_rejected:"bg-red-100 text-red-600",new_favorite:"bg-pink-100 text-pink-600"})[e]||"bg-gray-100 text-gray-600",v=async(e=!1)=>{l.value=!0;try{const t=await d.get("/notifications",{params:{page:e?u.value+1:1}}),s=t.data.data;e?r.value=[...r.value,...s]:r.value=s,u.value=t.data.meta.current_page,m.value=t.data.meta.last_page}finally{l.value=!1}},V=()=>v(!0),E=async e=>{if(!e.read_at)try{await d.post(`/notifications/${e.id}/read`),e.read_at=new Date().toISOString()}catch{}const t=e.data;t.listing_slug?c.push(`/listing/${t.listing_slug}`):t.conversation_uuid&&c.push(`/messages/${t.conversation_uuid}`)},L=async()=>{try{await d.post("/notifications/read-all"),r.value.forEach(e=>e.read_at=new Date().toISOString())}catch{}},A=async e=>{try{await d.delete(`/notifications/${e}`),r.value=r.value.filter(t=>t.id!==e)}catch{}};return P(()=>v()),(e,t)=>(o(),n("div",J,[a("div",K,[a("div",Q,[t[0]||(t[0]=a("h1",{class:"text-xl font-bold text-gray-900"},"Notifications",-1)),r.value.length&&S.value?(o(),n("button",{key:0,onClick:L,class:"text-sm text-primary-600 hover:underline"}," Mark all as read ")):f("",!0)]),l.value&&!r.value.length?(o(),n("div",X,[(o(),n(y,null,x(5,s=>a("div",{key:s,class:"card p-4"},[...t[1]||(t[1]=[R('<div class="flex gap-3"><div class="skeleton w-10 h-10 rounded-full"></div><div class="flex-1"><div class="skeleton h-4 w-3/4 mb-2"></div><div class="skeleton h-3 w-1/2"></div></div></div>',1)])])),64))])):r.value.length?(o(),n("div",Y,[(o(!0),n(y,null,x(r.value,s=>(o(),n("div",{key:s.id,onClick:F=>E(s),class:p(["card p-4 cursor-pointer hover:bg-gray-50 transition",s.read_at?"":"border-l-4 border-l-primary-500 bg-primary-50/30"])},[a("div",te,[a("div",{class:p(["w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0",I(s.data.type)])},[(o(),T(z(D(s.data.type)),{class:"w-5 h-5"}))],2),a("div",se,[a("p",{class:p(["text-sm text-gray-900",s.read_at?"":"font-medium"])},g(s.data.message),3),a("p",ae,g(B(s.created_at)),1)]),a("button",{onClick:U(F=>A(s.id),["stop"]),class:"p-1 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded"},[h(w(W),{class:"w-4 h-4"})],8,re)])],10,ee))),128)),M.value?(o(),n("div",oe,[a("button",{onClick:V,disabled:l.value,class:"btn-secondary"},g(l.value?"Loading...":"Load More"),9,ne)])):f("",!0)])):(o(),n("div",le,[h(w(b),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),t[2]||(t[2]=a("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No notifications yet",-1)),t[3]||(t[3]=a("p",{class:"text-gray-500"},"We'll notify you about your listings and messages",-1))]))])]))}};export{ve as default};
