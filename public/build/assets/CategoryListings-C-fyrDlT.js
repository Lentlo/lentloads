var f=(C,g,l)=>new Promise((i,n)=>{var p=a=>{try{d(l.next(a))}catch(m){n(m)}},v=a=>{try{d(l.throw(a))}catch(m){n(m)}},d=a=>a.done?i(a.value):Promise.resolve(a.value).then(p,v);d((l=l.apply(C,g)).next())});import{q as $,f as c,b as j,s as q,o as z,v as A,k as r,l as s,p as t,x as F,a as P,y as h,C as k,B as _,D as E,Q as I,F as b,I as w,z as D}from"./vue-vendor-Clry8SR-.js";import{u as Q,b as H}from"./main-capacitor-BlsodQL6.js";import{L as R}from"./ListingCard-CI6r3vMz.js";import"./ui-vendor-B7DvqItC.js";import"./listings-BycPGJTy.js";import"./dayjs.min-_KBCEsvO.js";import"./relativeTime-2Po48zfX.js";import"./SparklesIcon-BKZY3LMx.js";const T={class:"category-page min-h-screen bg-gray-50"},U={class:"container-app py-6"},G={class:"flex items-center gap-2 text-sm mb-4"},J={class:"text-gray-900"},K={class:"flex items-center justify-between mb-6"},O={class:"text-2xl font-bold text-gray-900"},W={class:"text-gray-500"},X={key:0,class:"flex flex-wrap gap-2 mb-6"},Y={key:1,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},Z={key:2,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},ee={key:3,class:"card p-12 text-center"},te={key:4,class:"mt-6 text-center"},se=["disabled"],ge={__name:"CategoryListings",setup(C){const g=$();Q();const l=c(!0),i=c(null),n=c([]),p=c("newest"),v=c(1),d=c(1),a=c(0),m=j(()=>v.value<d.value),L=()=>f(this,null,function*(){try{const u=yield H.get(`/categories/${g.params.slug}`);i.value=u.data.data.category}catch(u){console.error("Failed to fetch category")}}),y=(u=!1)=>f(this,null,function*(){l.value=!0;try{const e=yield H.get("/listings",{params:{category:g.params.slug,sort:p.value,page:u?v.value+1:1}});u?n.value=[...n.value,...e.data.data]:n.value=e.data.data,a.value=e.data.meta.total,v.value=e.data.meta.current_page,d.value=e.data.meta.last_page}finally{l.value=!1}}),S=()=>{y(!0)};return q(()=>g.params.slug,()=>{L(),y()}),z(()=>{L(),y()}),(u,e)=>{var N,B,M,V;const x=A("router-link");return s(),r("div",T,[t("div",U,[t("nav",G,[P(x,{to:"/",class:"text-gray-500 hover:text-gray-700"},{default:h(()=>[...e[1]||(e[1]=[k("Home",-1)])]),_:1}),e[3]||(e[3]=t("span",{class:"text-gray-400"},"/",-1)),P(x,{to:"/categories",class:"text-gray-500 hover:text-gray-700"},{default:h(()=>[...e[2]||(e[2]=[k("Categories",-1)])]),_:1}),e[4]||(e[4]=t("span",{class:"text-gray-400"},"/",-1)),t("span",J,_((N=i.value)==null?void 0:N.name),1)]),t("div",K,[t("div",null,[t("h1",O,_((B=i.value)==null?void 0:B.name),1),t("p",W,_(a.value)+" ads found",1)]),E(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>p.value=o),onChange:y,class:"input w-auto"},[...e[5]||(e[5]=[t("option",{value:"newest"},"Newest First",-1),t("option",{value:"price_low"},"Price: Low to High",-1),t("option",{value:"price_high"},"Price: High to Low",-1)])],544),[[I,p.value]])]),(V=(M=i.value)==null?void 0:M.children)!=null&&V.length?(s(),r("div",X,[(s(!0),r(b,null,w(i.value.children,o=>(s(),D(x,{key:o.id,to:`/category/${o.slug}`,class:"px-4 py-2 bg-white rounded-full border hover:border-primary-500 hover:text-primary-600 text-sm"},{default:h(()=>[k(_(o.name),1)]),_:2},1032,["to"]))),128))])):F("",!0),l.value?(s(),r("div",Y,[(s(),r(b,null,w(8,o=>t("div",{key:o,class:"card p-4"},[...e[6]||(e[6]=[t("div",{class:"skeleton h-40 mb-3"},null,-1),t("div",{class:"skeleton h-4 w-20 mb-2"},null,-1),t("div",{class:"skeleton h-4 w-full"},null,-1)])])),64))])):n.value.length?(s(),r("div",Z,[(s(!0),r(b,null,w(n.value,o=>(s(),D(R,{key:o.id,listing:o},null,8,["listing"]))),128))])):(s(),r("div",ee,[...e[7]||(e[7]=[t("p",{class:"text-gray-500"},"No listings in this category yet",-1)])])),m.value?(s(),r("div",te,[t("button",{onClick:S,disabled:l.value,class:"btn-secondary"}," Load More ",8,se)])):F("",!0)])])}}};export{ge as default};
