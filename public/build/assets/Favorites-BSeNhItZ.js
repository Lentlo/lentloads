import{u as B}from"./listings-DNbKQ79n.js";import{r as i,d as D,y as V,e as $,c as a,o,a as t,f,t as n,F as b,h as k,g as c,j as g,D as A,w,i as F,N as v,l as P,I as T}from"./main-CQnRCcw5.js";import{d as C}from"./dayjs.min-CUz-Fjy8.js";import{r as z}from"./relativeTime-BU1bjuJH.js";const E={class:"min-h-screen bg-gray-50 py-6"},O={class:"container-app"},R={class:"flex items-center justify-between mb-6"},q={class:"text-gray-500"},G={key:0,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},H={key:1,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},I=["onClick"],J={class:"aspect-[4/3] bg-gray-100"},K=["src","alt"],Q={key:0,class:"absolute inset-0 bg-black/50 flex items-center justify-center"},U={class:"p-4"},W={class:"text-lg font-bold text-gray-900"},X={class:"text-gray-700 font-medium line-clamp-2 mt-1"},Y={class:"flex items-center mt-2 text-sm text-gray-500"},Z={class:"text-xs text-gray-400 mt-1"},ee={key:2,class:"card p-12 text-center"},te={key:3,class:"mt-6 text-center"},se=["disabled"],ce={__name:"Favorites",setup(ae){C.extend(z);const y=B(),m=i(!0),d=i(!1),r=i([]),u=i(0),_=i(1),p=i(1),N=D(()=>_.value<p.value),j=l=>C(l).fromNow(),h=async(l=!1)=>{l?d.value=!0:m.value=!0;try{const e=await y.fetchFavorites();l?r.value=[...r.value,...e.data]:r.value=e.data,u.value=e.meta.total,_.value=e.meta.current_page,p.value=e.meta.last_page}finally{m.value=!1,d.value=!1}},L=async l=>{try{await y.toggleFavorite(l),r.value=r.value.filter(e=>e.id!==l),u.value--,v.success("Removed from favorites")}catch{v.error("Failed to remove from favorites")}},M=async()=>{if(confirm("Are you sure you want to clear all favorites?"))try{await api.delete("/favorites/clear"),r.value=[],u.value=0,v.success("All favorites cleared")}catch{v.error("Failed to clear favorites")}},S=()=>{h(!0)};return V(()=>{h()}),(l,e)=>{const x=$("router-link");return o(),a("div",E,[t("div",O,[t("div",R,[t("div",null,[e[0]||(e[0]=t("h1",{class:"text-2xl font-bold text-gray-900"},"My Favorites",-1)),t("p",q,n(u.value)+" saved items",1)]),r.value.length?(o(),a("button",{key:0,onClick:M,class:"text-sm text-red-600 hover:underline"}," Clear all ")):f("",!0)]),m.value?(o(),a("div",G,[(o(),a(b,null,k(8,s=>t("div",{key:s,class:"card p-4"},[...e[1]||(e[1]=[t("div",{class:"skeleton h-40 mb-3"},null,-1),t("div",{class:"skeleton h-4 w-20 mb-2"},null,-1),t("div",{class:"skeleton h-4 w-full"},null,-1)])])),64))])):r.value.length?(o(),a("div",H,[(o(!0),a(b,null,k(r.value,s=>(o(),a("div",{key:s.id,class:"card-hover group relative"},[t("button",{onClick:oe=>L(s.id),class:"absolute top-2 right-2 z-10 w-8 h-8 bg-white rounded-full shadow flex items-center justify-center opacity-0 group-hover:opacity-100 transition"},[c(g(P),{class:"w-5 h-5 text-gray-600"})],8,I),c(x,{to:`/listing/${s.slug}`},{default:w(()=>[t("div",J,[t("img",{src:s.primary_image_url,alt:s.title,class:"w-full h-full object-cover"},null,8,K),s.status==="sold"?(o(),a("div",Q,[...e[2]||(e[2]=[t("span",{class:"bg-white text-gray-900 px-4 py-2 rounded-lg font-semibold"}," SOLD ",-1)])])):f("",!0)]),t("div",U,[t("p",W,n(s.formatted_price),1),t("h3",X,n(s.title),1),t("div",Y,[c(g(T),{class:"w-4 h-4 mr-1"}),F(" "+n(s.location),1)]),t("p",Z," Saved "+n(j(s.favorited_at)),1)])]),_:2},1032,["to"])]))),128))])):(o(),a("div",ee,[c(g(A),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e[4]||(e[4]=t("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No favorites yet",-1)),e[5]||(e[5]=t("p",{class:"text-gray-500 mb-4"},"Save items you like by clicking the heart icon",-1)),c(x,{to:"/search",class:"btn-primary"},{default:w(()=>[...e[3]||(e[3]=[F(" Browse Listings ",-1)])]),_:1})])),N.value?(o(),a("div",te,[t("button",{onClick:S,disabled:d.value,class:"btn-secondary"},n(d.value?"Loading...":"Load More"),9,se)])):f("",!0)])])}}};export{ce as default};
