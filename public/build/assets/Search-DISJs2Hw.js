import{c as o,o as a,a as s,_ as se,u as ie,C as le,x as ae,b as oe,r as d,K as re,d as h,D as ne,L as ce,f as u,g as m,j as p,t as r,y as n,M as P,G as de,i as M,l as V,F as x,h as g,A as y,z as ue,p as $,B as E,N as A,O as me,m as pe}from"./main-Bps2kPvF.js";import{u as ve}from"./listings-BQG0w22u.js";import{_ as xe}from"./ListingCard-Cqpm1Fkg.js";import"./dayjs.min-iy57P9mS.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./relativeTime-D5nU98bY.js";import"./SparklesIcon-CggIKuMj.js";import"./BoltIcon-qEusvzG_.js";import"./MapPinIcon-Ccg2HSKl.js";import"./ClockIcon-BEnbDLjN.js";function ge(j,C){return a(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0m3 0a1.5 1.5 0 1 0-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-9.75 0h9.75"})])}function G(j,C){return a(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0 1 11.186 0Z"})])}const ye={class:"min-h-screen bg-gray-50"},fe={class:"container-app py-4"},be={class:"lg:hidden mb-4"},_e={class:"flex items-center gap-2 overflow-x-auto pb-2 scrollbar-hide"},he={key:0,class:"w-5 h-5 bg-primary-600 text-white text-xs rounded-full flex items-center justify-center"},ke={class:"relative flex-shrink-0"},we={key:0,class:"px-3 py-2 bg-primary-100 text-primary-700 rounded-full text-sm flex items-center gap-1 flex-shrink-0"},Ce={key:1,class:"px-3 py-2 bg-primary-100 text-primary-700 rounded-full text-sm flex items-center gap-1 flex-shrink-0"},Se={key:2,class:"px-3 py-2 bg-primary-100 text-primary-700 rounded-full text-sm flex items-center gap-1 flex-shrink-0"},qe={class:"flex flex-col lg:flex-row gap-6"},Fe={class:"hidden lg:block lg:w-64 flex-shrink-0"},Me={class:"card p-4 sticky top-20"},Ve={class:"mb-5"},$e=["value"],Le={class:"mb-5"},Ne={class:"mb-5"},Ue={class:"flex items-center gap-2"},Pe={class:"mb-5"},Ae={class:"space-y-2"},je=["onUpdate:modelValue","value"],Be={class:"ml-2 text-sm text-gray-600"},Ke={class:"flex-1"},Re={class:"flex items-center justify-between mb-4"},He={class:"text-lg lg:text-xl font-bold text-gray-900"},Te={class:"text-sm text-gray-500"},ze={class:"hidden lg:flex items-center gap-3"},De={key:0,class:"grid grid-cols-2 md:grid-cols-3 gap-3"},Ee={key:1,class:"grid grid-cols-2 md:grid-cols-3 gap-3"},Ge={key:2,class:"card p-8 text-center"},Ie={key:3,class:"mt-6 text-center"},Oe=["disabled"],Ye={key:0,class:"filter-modal lg:hidden"},Ze={class:"filter-sheet"},Je={class:"filter-header"},We={class:"flex items-center gap-2"},Xe={class:"filter-content"},Qe={class:"mb-6"},et={class:"flex flex-wrap gap-2"},tt=["onClick"],st={class:"mb-6"},it={class:"mb-6"},lt={class:"flex flex-wrap gap-2 mb-3"},at=["onClick"],ot={class:"flex items-center gap-3"},rt={class:"mb-6"},nt={class:"flex flex-wrap gap-2"},ct=["onClick"],dt={class:"filter-actions"},ut={key:1,class:"fixed inset-0 z-50 flex items-end sm:items-center justify-center"},mt={class:"relative bg-white w-full sm:max-w-sm sm:rounded-xl rounded-t-2xl p-6 safe-area-bottom animate-slide-up"},pt={class:"mb-4"},vt={class:"flex gap-3"},xt=["disabled"],gt={__name:"Search",setup(j){const C=ie(),I=le(),O=ae(),Y=oe();ve();const k=d(!1),f=d([]),S=d(0),L=d(1),B=d(1),w=d(!1),b=d(!1),_=d(""),q=d(!1),t=re({q:"",category:"",city:"",min_price:"",max_price:"",condition:"",sort:"newest"}),K=[{value:"",label:"All"},{value:"new",label:"New"},{value:"like_new",label:"Like New"},{value:"good",label:"Good"},{value:"fair",label:"Fair"}],Z=[{label:"Under ₹1K",min:"",max:1e3},{label:"₹1K - ₹5K",min:1e3,max:5e3},{label:"₹5K - ₹10K",min:5e3,max:1e4},{label:"₹10K+",min:1e4,max:""}],F=h(()=>O.categories),R=h(()=>Y.isAuthenticated),H=h(()=>t.q),J=h(()=>L.value<B.value),T=h(()=>{let l=0;return t.category&&l++,t.city&&l++,(t.min_price||t.max_price)&&l++,t.condition&&l++,l}),z=h(()=>t.q||t.category||t.city||t.min_price||t.max_price||t.condition),W=l=>{const e=F.value.find(i=>i.slug===l);return(e==null?void 0:e.name)||l},X=l=>{t.min_price=l.min,t.max_price=l.max},D=l=>{t[l]="",c()},Q=()=>{t.min_price="",t.max_price="",c()},c=async(l=!1)=>{k.value=!0;try{const e={page:l?L.value+1:1,sort:t.sort};t.q&&(e.q=t.q),t.category&&(e.category=t.category),t.city&&(e.city=t.city),t.min_price&&(e.min_price=t.min_price),t.max_price&&(e.max_price=t.max_price),t.condition&&(e.condition=t.condition);const i=await E.get("/listings",{params:e});l?f.value=[...f.value,...i.data.data]:f.value=i.data.data,S.value=i.data.meta.total,L.value=i.data.meta.current_page,B.value=i.data.meta.last_page;const v={...e};delete v.page,e.page>1&&(v.page=e.page),I.replace({query:v})}catch{A.error("Failed to fetch listings")}finally{k.value=!1}},ee=()=>c(!0),N=()=>{w.value=!1,c()},U=()=>{t.category="",t.city="",t.min_price="",t.max_price="",t.condition="",t.sort="newest",w.value=!1,c()},te=async()=>{var l;if(_.value){q.value=!0;try{await E.post("/saved-searches",{name:_.value,query:t.q||null,category_id:((l=F.value.find(e=>e.slug===t.category))==null?void 0:l.id)||null,city:t.city||null,min_price:t.min_price||null,max_price:t.max_price||null,condition:t.condition||null}),A.success("Search saved! You'll be notified of new listings."),b.value=!1,_.value=""}catch{A.error("Failed to save search")}finally{q.value=!1}}};return ne(()=>{const l=C.query;l.q&&(t.q=l.q),l.category&&(t.category=l.category),l.city&&(t.city=l.city),l.min_price&&(t.min_price=l.min_price),l.max_price&&(t.max_price=l.max_price),l.condition&&(t.condition=l.condition),l.sort&&(t.sort=l.sort),c()}),ce(()=>C.query,l=>{let e=!1;l.q!==t.q&&(t.q=l.q||"",e=!0),l.category!==t.category&&(t.category=l.category||"",e=!0),l.city!==t.city&&(t.city=l.city||"",e=!0),l.min_price!==t.min_price&&(t.min_price=l.min_price||"",e=!0),l.max_price!==t.max_price&&(t.max_price=l.max_price||"",e=!0),l.condition!==t.condition&&(t.condition=l.condition||"",e=!0),l.sort!==t.sort&&l.sort&&(t.sort=l.sort,e=!0),e&&c()},{deep:!0}),(l,e)=>(a(),o("div",ye,[s("div",fe,[s("div",be,[s("div",_e,[s("button",{onClick:e[0]||(e[0]=i=>w.value=!0),class:"flex items-center gap-2 px-4 py-2.5 bg-white rounded-full border shadow-sm flex-shrink-0"},[m(p(ge),{class:"w-5 h-5 text-gray-600"}),e[18]||(e[18]=s("span",{class:"text-sm font-medium"},"Filters",-1)),T.value>0?(a(),o("span",he,r(T.value),1)):u("",!0)]),s("div",ke,[n(s("select",{"onUpdate:modelValue":e[1]||(e[1]=i=>t.sort=i),onChange:c,class:"appearance-none px-4 py-2.5 pr-8 bg-white rounded-full border shadow-sm text-sm font-medium"},[...e[19]||(e[19]=[s("option",{value:"newest"},"Newest",-1),s("option",{value:"price_low"},"Price: Low",-1),s("option",{value:"price_high"},"Price: High",-1)])],544),[[P,t.sort]]),m(p(de),{class:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"})]),t.category?(a(),o("span",we,[M(r(W(t.category))+" ",1),s("button",{onClick:e[2]||(e[2]=i=>D("category"))},[m(p(V),{class:"w-4 h-4"})])])):u("",!0),t.city?(a(),o("span",Ce,[M(r(t.city)+" ",1),s("button",{onClick:e[3]||(e[3]=i=>D("city"))},[m(p(V),{class:"w-4 h-4"})])])):u("",!0),t.min_price||t.max_price?(a(),o("span",Se,[M(" ₹"+r(t.min_price||0)+" - "+r(t.max_price||"∞")+" ",1),s("button",{onClick:Q},[m(p(V),{class:"w-4 h-4"})])])):u("",!0)])]),s("div",qe,[s("aside",Fe,[s("div",Me,[s("div",{class:"flex items-center justify-between mb-4"},[e[20]||(e[20]=s("h3",{class:"font-semibold text-gray-900"},"Filters",-1)),s("button",{onClick:U,class:"text-sm text-primary-600 hover:underline"}," Clear all ")]),s("div",Ve,[e[22]||(e[22]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Category",-1)),n(s("select",{"onUpdate:modelValue":e[4]||(e[4]=i=>t.category=i),class:"input text-sm"},[e[21]||(e[21]=s("option",{value:""},"All Categories",-1)),(a(!0),o(x,null,g(F.value,i=>(a(),o("option",{key:i.id,value:i.slug},r(i.name),9,$e))),128))],512),[[P,t.category]])]),s("div",Le,[e[23]||(e[23]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"City",-1)),n(s("input",{"onUpdate:modelValue":e[5]||(e[5]=i=>t.city=i),type:"text",placeholder:"Enter city",class:"input text-sm"},null,512),[[y,t.city]])]),s("div",Ne,[e[25]||(e[25]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Price Range",-1)),s("div",Ue,[n(s("input",{"onUpdate:modelValue":e[6]||(e[6]=i=>t.min_price=i),type:"number",placeholder:"Min",class:"input text-sm"},null,512),[[y,t.min_price]]),e[24]||(e[24]=s("span",{class:"text-gray-400"},"-",-1)),n(s("input",{"onUpdate:modelValue":e[7]||(e[7]=i=>t.max_price=i),type:"number",placeholder:"Max",class:"input text-sm"},null,512),[[y,t.max_price]])])]),s("div",Pe,[e[26]||(e[26]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Condition",-1)),s("div",Ae,[(a(),o(x,null,g(K,i=>s("label",{key:i.value,class:"flex items-center"},[n(s("input",{type:"radio","onUpdate:modelValue":v=>t.condition=v,value:i.value,class:"text-primary-600"},null,8,je),[[me,t.condition]]),s("span",Be,r(i.label),1)])),64))])]),s("button",{onClick:c,class:"btn-primary w-full mb-3"}," Apply Filters "),R.value&&z.value?(a(),o("button",{key:0,onClick:e[8]||(e[8]=i=>b.value=!0),class:"btn-secondary w-full text-sm"},[m(p(G),{class:"w-4 h-4 mr-2"}),e[27]||(e[27]=M(" Save This Search ",-1))])):u("",!0)])]),s("main",Ke,[s("div",Re,[s("div",null,[s("h1",He,r(H.value?`"${H.value}"`:"All Listings"),1),s("p",Te,r(S.value)+" results",1)]),s("div",ze,[n(s("select",{"onUpdate:modelValue":e[9]||(e[9]=i=>t.sort=i),onChange:c,class:"input w-auto text-sm"},[...e[28]||(e[28]=[s("option",{value:"newest"},"Newest First",-1),s("option",{value:"price_low"},"Price: Low to High",-1),s("option",{value:"price_high"},"Price: High to Low",-1)])],544),[[P,t.sort]])])]),k.value&&!f.value.length?(a(),o("div",De,[(a(),o(x,null,g(6,i=>s("div",{key:i,class:"card p-3"},[...e[29]||(e[29]=[s("div",{class:"skeleton aspect-square mb-2 rounded-lg"},null,-1),s("div",{class:"skeleton h-4 w-16 mb-1"},null,-1),s("div",{class:"skeleton h-4 w-full mb-1"},null,-1),s("div",{class:"skeleton h-3 w-20"},null,-1)])])),64))])):f.value.length?(a(),o("div",Ee,[(a(!0),o(x,null,g(f.value,i=>(a(),pe(xe,{key:i.id,listing:i},null,8,["listing"]))),128))])):(a(),o("div",Ge,[m(p(ue),{class:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e[30]||(e[30]=s("h3",{class:"font-medium text-gray-900 mb-1"},"No results found",-1)),e[31]||(e[31]=s("p",{class:"text-sm text-gray-500 mb-4"},"Try adjusting your filters",-1)),s("button",{onClick:U,class:"btn-primary"},"Clear Filters")])),J.value?(a(),o("div",Ie,[s("button",{onClick:ee,disabled:k.value,class:"btn-secondary"},r(k.value?"Loading...":"Load More"),9,Oe)])):u("",!0)])])]),w.value?(a(),o("div",Ye,[s("div",{class:"filter-backdrop",onClick:N}),s("div",Ze,[s("div",Je,[e[32]||(e[32]=s("h3",{class:"text-lg font-semibold"},"Filters",-1)),s("div",We,[s("button",{onClick:U,class:"text-sm text-primary-600 font-medium"},"Clear all"),s("button",{onClick:N,class:"p-2 hover:bg-gray-100 rounded-full"},[m(p(V),{class:"w-5 h-5"})])])]),s("div",Xe,[s("div",Qe,[e[33]||(e[33]=s("h4",{class:"font-medium text-gray-900 mb-3"},"Category",-1)),s("div",et,[s("button",{onClick:e[10]||(e[10]=i=>t.category=""),class:$(["px-4 py-2 rounded-full border text-sm transition",t.category?"hover:bg-gray-50":"border-primary-500 bg-primary-50 text-primary-700"])}," All ",2),(a(!0),o(x,null,g(F.value,i=>(a(),o("button",{key:i.id,onClick:v=>t.category=i.slug,class:$(["px-4 py-2 rounded-full border text-sm transition",t.category===i.slug?"border-primary-500 bg-primary-50 text-primary-700":"hover:bg-gray-50"])},r(i.name),11,tt))),128))])]),s("div",st,[e[34]||(e[34]=s("h4",{class:"font-medium text-gray-900 mb-3"},"City",-1)),n(s("input",{"onUpdate:modelValue":e[11]||(e[11]=i=>t.city=i),type:"text",placeholder:"Enter city name",class:"input"},null,512),[[y,t.city]])]),s("div",it,[e[36]||(e[36]=s("h4",{class:"font-medium text-gray-900 mb-3"},"Price Range",-1)),s("div",lt,[(a(),o(x,null,g(Z,i=>s("button",{key:i.label,onClick:v=>X(i),class:$(["px-3 py-2 text-sm border rounded-full transition",String(t.min_price)===String(i.min)&&String(t.max_price)===String(i.max)?"border-primary-500 bg-primary-50 text-primary-700":"hover:bg-gray-50"])},r(i.label),11,at)),64))]),s("div",ot,[n(s("input",{"onUpdate:modelValue":e[12]||(e[12]=i=>t.min_price=i),type:"number",placeholder:"Min",class:"input text-center"},null,512),[[y,t.min_price]]),e[35]||(e[35]=s("span",{class:"text-gray-400"},"to",-1)),n(s("input",{"onUpdate:modelValue":e[13]||(e[13]=i=>t.max_price=i),type:"number",placeholder:"Max",class:"input text-center"},null,512),[[y,t.max_price]])])]),s("div",rt,[e[37]||(e[37]=s("h4",{class:"font-medium text-gray-900 mb-3"},"Condition",-1)),s("div",nt,[(a(),o(x,null,g(K,i=>s("button",{key:i.value,onClick:v=>t.condition=i.value,class:$(["px-4 py-2 rounded-full border text-sm transition",t.condition===i.value?"border-primary-500 bg-primary-50 text-primary-700":"hover:bg-gray-50"])},r(i.label),11,ct)),64))])])]),s("div",dt,[R.value&&z.value?(a(),o("button",{key:0,onClick:e[14]||(e[14]=i=>{b.value=!0,w.value=!1}),class:"btn-secondary"},[m(p(G),{class:"w-4 h-4"})])):u("",!0),s("button",{onClick:N,class:"btn-primary flex-1"}," Show "+r(S.value>0?S.value.toLocaleString()+" ":"")+"Results ",1)])])])):u("",!0),b.value?(a(),o("div",ut,[s("div",{class:"absolute inset-0 bg-black/50",onClick:e[15]||(e[15]=i=>b.value=!1)}),s("div",mt,[e[39]||(e[39]=s("h3",{class:"text-lg font-semibold mb-4"},"Save This Search",-1)),e[40]||(e[40]=s("p",{class:"text-sm text-gray-500 mb-4"},"Get notified when new listings match your search criteria.",-1)),s("div",pt,[e[38]||(e[38]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Search Name",-1)),n(s("input",{"onUpdate:modelValue":e[16]||(e[16]=i=>_.value=i),type:"text",class:"input",placeholder:"e.g., iPhone in Mumbai"},null,512),[[y,_.value]])]),s("div",vt,[s("button",{onClick:e[17]||(e[17]=i=>b.value=!1),class:"btn-secondary flex-1"},"Cancel"),s("button",{onClick:te,disabled:!_.value||q.value,class:"btn-primary flex-1"},r(q.value?"Saving...":"Save Search"),9,xt)])])])):u("",!0)]))}},Ft=se(gt,[["__scopeId","data-v-92b71fce"]]);export{Ft as default};
