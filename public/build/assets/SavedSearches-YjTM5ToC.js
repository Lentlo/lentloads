var R=Object.defineProperty,T=Object.defineProperties;var z=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var D=(r,o,n)=>o in r?R(r,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[o]=n,$=(r,o)=>{for(var n in o||(o={}))A.call(o,n)&&D(r,n,o[n]);if(V)for(var n of V(o))G.call(o,n)&&D(r,n,o[n]);return r},E=(r,o)=>T(r,z(o));var _=(r,o,n)=>new Promise((v,i)=>{var C=y=>{try{g(n.next(y))}catch(k){i(k)}},S=y=>{try{g(n.throw(y))}catch(k){i(k)}},g=y=>y.done?v(y.value):Promise.resolve(y.value).then(C,S);g((n=n.apply(r,o)).next())});import{u as H,f as x,o as P,v as Q,k as d,l as c,p as t,x as w,F as B,I,a as u,A as p,y as W,C as q,L as j,D as M,E as J,B as f,H as U,Q as K}from"./vue-vendor-Clry8SR-.js";import{_ as O,r as F,f as X,b,e as Y,k as Z}from"./main-capacitor-BlsodQL6.js";import{toast as h}from"./ui-vendor-B7DvqItC.js";import{r as ee}from"./BookmarkIcon-DAXHbkCs.js";import{r as te}from"./PencilIcon-DHh9NmAM.js";import{r as se}from"./TrashIcon-DHtKWE65.js";import{r as ae}from"./EnvelopeIcon-Cxp5hExn.js";const ne={class:"saved-searches-page"},oe={class:"container-app py-6"},ie={key:0,class:"searches-list"},le={key:1,class:"searches-list"},re={class:"search-header"},de={class:"search-info"},ce={class:"search-name"},ue={class:"search-tags"},pe={key:0,class:"tag primary"},ve={key:1,class:"tag"},ye={key:2,class:"tag"},me={key:3,class:"tag"},_e={class:"search-actions"},fe=["onClick"],he=["onClick"],ge=["onClick"],ke={class:"notification-settings"},we={class:"notification-toggles"},be=["checked","onChange"],Ce=["checked","onChange"],Se=["onUpdate:modelValue","onChange"],$e={key:2,class:"empty-state"},xe={class:"empty-icon"},qe={class:"modal-content"},Fe={class:"modal-header"},Ne={class:"modal-body"},Ve={class:"modal-footer"},De={__name:"SavedSearches",setup(r){const o=H(),n=x(!0),v=x([]),i=x(null),C=()=>_(this,null,function*(){try{const a=yield b.get("/saved-searches");v.value=a.data.data.map(e=>{var l,s;return E($({},e),{notify_push:(l=e.notify_push)!=null?l:!0,notify_email:(s=e.notify_email)!=null?s:!0})})}finally{n.value=!1}}),S=a=>{var l;const e={};a.query&&(e.q=a.query),a.category_id&&(e.category=(l=a.category)==null?void 0:l.slug),a.city&&(e.city=a.city),a.min_price&&(e.min_price=a.min_price),a.max_price&&(e.max_price=a.max_price),o.push({path:"/search",query:e})},g=a=>{i.value=$({},a)},y=()=>_(this,null,function*(){try{yield b.put(`/saved-searches/${i.value.id}`,{name:i.value.name});const a=v.value.findIndex(e=>e.id===i.value.id);a!==-1&&(v.value[a].name=i.value.name),i.value=null,h.success("Search updated")}catch(a){h.error("Failed to update search")}}),k=a=>_(this,null,function*(){if(confirm("Delete this saved search?"))try{yield b.delete(`/saved-searches/${a}`),v.value=v.value.filter(e=>e.id!==a),h.success("Search deleted")}catch(e){h.error("Failed to delete search")}}),N=(a,e)=>_(this,null,function*(){const l=e==="push"?"notify_push":"notify_email";a[l]=!a[l];try{yield b.put(`/saved-searches/${a.id}`,{[l]:a[l]})}catch(s){a[l]=!a[l],h.error("Failed to update notification settings")}}),L=a=>_(this,null,function*(){try{yield b.put(`/saved-searches/${a.id}`,{notify_frequency:a.notify_frequency})}catch(e){h.error("Failed to update frequency")}});return P(()=>{C()}),(a,e)=>{const l=Q("router-link");return c(),d("div",ne,[t("div",oe,[e[11]||(e[11]=t("div",{class:"page-header"},[t("div",null,[t("h1",null,"Saved Searches"),t("p",null,"Get notified when new items match your criteria")])],-1)),n.value?(c(),d("div",ie,[(c(),d(B,null,I(3,s=>t("div",{key:s,class:"search-card-skeleton"},[...e[4]||(e[4]=[t("div",{class:"skeleton h-6 w-1/3 mb-3"},null,-1),t("div",{class:"skeleton h-4 w-2/3 mb-4"},null,-1),t("div",{class:"skeleton h-10 w-full"},null,-1)])])),64))])):v.value.length?(c(),d("div",le,[(c(!0),d(B,null,I(v.value,s=>(c(),d("div",{key:s.id,class:"search-card"},[t("div",re,[t("div",de,[t("h3",ce,f(s.name),1),t("div",ue,[s.query?(c(),d("span",pe,[u(p(F),{class:"w-3 h-3"}),q(" "+f(s.query),1)])):w("",!0),s.category?(c(),d("span",ve,f(s.category.name),1)):w("",!0),s.city?(c(),d("span",ye,[u(p(Y),{class:"w-3 h-3"}),q(" "+f(s.city),1)])):w("",!0),s.min_price||s.max_price?(c(),d("span",me," ₹"+f(s.min_price||0)+" - ₹"+f(s.max_price||"∞"),1)):w("",!0)])]),t("div",_e,[t("button",{onClick:m=>S(s),class:"action-btn primary",title:"Run search"},[u(p(F),{class:"w-5 h-5"})],8,fe),t("button",{onClick:m=>g(s),class:"action-btn",title:"Edit"},[u(p(te),{class:"w-5 h-5"})],8,he),t("button",{onClick:m=>k(s.id),class:"action-btn danger",title:"Delete"},[u(p(se),{class:"w-5 h-5"})],8,ge)])]),t("div",ke,[t("div",we,[t("label",{class:U(["toggle-item",{active:s.notify_push}])},[t("input",{type:"checkbox",checked:s.notify_push,onChange:m=>N(s,"push")},null,40,be),u(p(Z),{class:"w-4 h-4"}),e[5]||(e[5]=t("span",null,"Push",-1))],2),t("label",{class:U(["toggle-item",{active:s.notify_email}])},[t("input",{type:"checkbox",checked:s.notify_email,onChange:m=>N(s,"email")},null,40,Ce),u(p(ae),{class:"w-4 h-4"}),e[6]||(e[6]=t("span",null,"Email",-1))],2)]),M(t("select",{"onUpdate:modelValue":m=>s.notify_frequency=m,onChange:m=>L(s),class:"frequency-select"},[...e[7]||(e[7]=[t("option",{value:"instant"},"Instant",-1),t("option",{value:"daily"},"Daily",-1),t("option",{value:"weekly"},"Weekly",-1)])],40,Se),[[K,s.notify_frequency]])])]))),128))])):(c(),d("div",$e,[t("div",xe,[u(p(ee),{class:"w-16 h-16"})]),e[9]||(e[9]=t("h3",null,"No saved searches",-1)),e[10]||(e[10]=t("p",null,"Save a search to get notified when new items are posted",-1)),u(l,{to:"/search",class:"btn-primary"},{default:W(()=>[u(p(F),{class:"w-5 h-5"}),e[8]||(e[8]=q(" Start Searching ",-1))]),_:1})]))]),i.value?(c(),d("div",{key:0,class:"modal-overlay",onClick:e[3]||(e[3]=j(s=>i.value=null,["self"]))},[t("div",qe,[t("div",Fe,[e[12]||(e[12]=t("h3",null,"Edit Saved Search",-1)),t("button",{onClick:e[0]||(e[0]=s=>i.value=null),class:"modal-close"},[u(p(X),{class:"w-6 h-6"})])]),t("div",Ne,[e[13]||(e[13]=t("label",{class:"input-label"},"Search Name",-1)),M(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>i.value.name=s),type:"text",class:"input",placeholder:"Enter a name"},null,512),[[J,i.value.name]])]),t("div",Ve,[t("button",{onClick:e[2]||(e[2]=s=>i.value=null),class:"btn-secondary"},"Cancel"),t("button",{onClick:y,class:"btn-primary"},"Save Changes")])])])):w("",!0)])}}},ze=O(De,[["__scopeId","data-v-b11a6631"]]);export{ze as default};
