import{W as r,B as a}from"./main-DSRIuYMi.js";const o=r("listings",{state:()=>({listings:[],currentListing:null,myListings:[],favorites:[],filters:{q:"",category:null,city:null,min_price:null,max_price:null,condition:null,sort:"newest"},pagination:{current_page:1,last_page:1,per_page:20,total:0},loading:!1}),getters:{hasMore:t=>t.pagination.current_page<t.pagination.last_page},actions:{async fetchListings(t={},s=!1){this.loading=!0;try{const i=await a.get("/listings",{params:{...this.filters,...t}});return s?this.listings=[...this.listings,...i.data.data]:this.listings=i.data.data,this.pagination=i.data.meta,i.data}finally{this.loading=!1}},async fetchListing(t){this.loading=!0;try{const s=await a.get(`/listings/${t}`);return this.currentListing=s.data.data.listing,s.data.data}finally{this.loading=!1}},async createListing(t){const s=new FormData;return Object.keys(t).forEach(e=>{e==="images"?t.images.forEach(n=>{s.append("images[]",n)}):e==="attributes"&&t.attributes?s.append("attributes",JSON.stringify(t.attributes)):t[e]!==null&&t[e]!==void 0&&s.append(e,t[e])}),(await a.post("/listings",s,{headers:{"Content-Type":"multipart/form-data"}})).data},async updateListing(t,s){return(await a.put(`/listings/${t}`,s)).data},async deleteListing(t){await a.delete(`/listings/${t}`),this.myListings=this.myListings.filter(s=>s.id!==t)},async markAsSold(t){const s=await a.post(`/listings/${t}/sold`),i=this.myListings.findIndex(e=>e.id===t);return i!==-1&&(this.myListings[i]=s.data.data),s.data},async renewListing(t){return(await a.post(`/listings/${t}/renew`)).data},async fetchMyListings(t={}){this.loading=!0;try{const s=await a.get("/my-listings",{params:t});return this.myListings=s.data.data,this.pagination=s.data.meta,s.data}finally{this.loading=!1}},async fetchFavorites(){this.loading=!0;try{const t=await a.get("/favorites");return this.favorites=t.data.data,this.pagination=t.data.meta,t.data}finally{this.loading=!1}},async toggleFavorite(t){return(await a.post(`/favorites/toggle/${t}`)).data.data},async addImages(t,s){const i=new FormData;return s.forEach(e=>{i.append("images[]",e)}),await a.post(`/listings/${t}/images`,i,{headers:{"Content-Type":"multipart/form-data"}})},async deleteImage(t,s){return await a.delete(`/listings/${t}/images/${s}`)},setFilters(t){this.filters={...this.filters,...t}},resetFilters(){this.filters={q:"",category:null,city:null,min_price:null,max_price:null,condition:null,sort:"newest"}},clearListing(){this.currentListing=null}}});export{o as u};
