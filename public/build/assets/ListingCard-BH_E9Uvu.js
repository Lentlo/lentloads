var k=(s,o,l)=>new Promise((_,c)=>{var w=a=>{try{u(l.next(a))}catch(g){c(g)}},f=a=>{try{u(l.throw(a))}catch(g){c(g)}},u=a=>a.done?_(a.value):Promise.resolve(a.value).then(w,f);u((l=l.apply(s,o)).next())});import{k as r,l as n,p as i,f as F,b as m,v as N,z as $,y as B,x as h,a as v,A as p,H as y,L as S,B as d}from"./vue-vendor-Clry8SR-.js";import{_ as M,d as j,c as V,e as z}from"./main-capacitor-rPhIOL4v.js";import{u as A}from"./listings-BoIexBmh.js";import{d as b}from"./dayjs.min-VXSoyYVV.js";import{r as D}from"./relativeTime-BN4FbP67.js";import{r as E}from"./SparklesIcon-BKZY3LMx.js";function I(s,o){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"})])}const H={class:"card-image"},P=["src","alt"],R={key:0,class:"badge-featured"},q={key:1,class:"badge-urgent"},G={class:"card-content"},O={class:"price-row"},T={class:"price"},U={key:0,class:"condition-badge"},Z={class:"card-title"},J={class:"meta-row"},K={class:"location"},Q={key:0,class:"distance"},W={key:1,class:"time"},X={__name:"ListingCard",props:{listing:{type:Object,required:!0},showFavorite:{type:Boolean,default:!0}},setup(s){b.extend(D);const o=s,l=j(),_=A(),c=F(o.listing.is_favorited||!1),w=m(()=>{var e;return(o.listing.formatted_price||`â‚¹${(e=o.listing.price)==null?void 0:e.toLocaleString()}`).replace(/\s*\(Negotiable\)/gi,"").trim()}),f=m(()=>{const t=o.listing.condition;return t?{new:"New",like_new:"Like New",good:"Good",fair:"Fair",poor:"Poor"}[t.toLowerCase()]||t.replace(/_/g," "):""}),u=m(()=>{const e=(o.listing.location||o.listing.city||"").split(",")[0].trim();return e.length>15?e.substring(0,15)+"...":e}),a=m(()=>{const t=o.listing.distance;return t==null?"":t<1?`${Math.round(t*1e3)}m away`:t<10?`${t.toFixed(1)} km`:`${Math.round(t)} km`}),g=()=>k(this,null,function*(){if(!l.isAuthenticated)return;const t=yield _.toggleFavorite(o.listing.id);c.value=t.is_favorited}),x=t=>{if(!t)return"Recently";const e=b(t);return e.isValid()?e.fromNow():"Recently"},L=t=>{t.target.dataset.fallback||(t.target.dataset.fallback="true",t.target.src="https://placehold.co/400x400/e2e8f0/64748b?text=No+Image")};return(t,e)=>{const C=N("router-link");return n(),$(C,{to:`/listing/${s.listing.slug}`,class:"listing-card group"},{default:B(()=>[i("div",H,[i("img",{src:s.listing.primary_image_url,alt:s.listing.title,class:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105",loading:"lazy",onError:L},null,40,P),s.listing.is_featured?(n(),r("div",R,[v(p(E),{class:"w-3 h-3"}),e[0]||(e[0]=i("span",null,"Featured",-1))])):h("",!0),s.listing.is_urgent?(n(),r("div",q,[v(p(I),{class:"w-3 h-3"}),e[1]||(e[1]=i("span",null,"Urgent",-1))])):h("",!0),s.showFavorite?(n(),r("button",{key:2,onClick:S(g,["prevent"]),class:y(["btn-favorite",{"is-favorited":c.value}])},[v(p(V),{class:y(["w-5 h-5",c.value?"fill-current":""])},null,8,["class"])],2)):h("",!0)]),i("div",G,[i("div",O,[i("span",T,d(w.value),1),f.value?(n(),r("span",U,d(f.value),1)):h("",!0)]),i("h3",Z,d(s.listing.title),1),i("div",J,[i("span",K,[v(p(z),{class:"w-3.5 h-3.5"}),i("span",null,d(u.value),1)]),a.value?(n(),r("span",Q,d(a.value),1)):(n(),r("span",W,d(x(s.listing.published_at||s.listing.created_at)),1))])])]),_:1},8,["to"])}}},nt=M(X,[["__scopeId","data-v-ca433a40"]]);export{nt as L};
