import{u as D,r as n,c as S,o as B,d as o,e as s,f as a,h as u,F as f,m as _,i as I,j as F,Q as y,t as m,q as p,G as x,g as L,s as V}from"./main-CrvqE6re.js";import{d as h}from"./dayjs.min-Bof1u0Bp.js";import{r as O}from"./relativeTime-Ckc_g6N8.js";import{r as P}from"./ShoppingBagIcon-BFy_iZsg.js";import{r as R}from"./ExclamationCircleIcon-Dm_ISJnD.js";import{r as q}from"./CheckCircleIcon-CS0iuDML.js";import{r as z}from"./HeartIcon-gvSuGTeP.js";import{r as A}from"./ChatBubbleLeftIcon-uvxb0gzU.js";const E={class:"min-h-screen bg-gray-50 py-6"},G={class:"container-app max-w-2xl"},Q={class:"flex items-center justify-between mb-6"},T={key:0,class:"space-y-2"},Y={key:1,class:"space-y-2"},H=["onClick"],J={class:"flex-1 min-w-0"},K={class:"text-gray-900"},U={class:"text-sm text-gray-500 mt-1"},W={key:0,class:"w-2 h-2 bg-primary-600 rounded-full"},X={key:2,class:"card p-12 text-center"},Z={key:3,class:"mt-6 text-center"},ee=["disabled"],ue={__name:"Notifications",setup(te){h.extend(O);const b=D(),i=n(!0),d=n(!1),l=n([]),c=n(1),g=n(1),k=S(()=>c.value<g.value),w=e=>h(e).fromNow(),C=e=>({message:A,favorite:z,listing_approved:q,listing_rejected:R,sold:P})[e]||y,N=e=>({message:"bg-blue-100 text-blue-600",favorite:"bg-red-100 text-red-600",listing_approved:"bg-green-100 text-green-600",listing_rejected:"bg-red-100 text-red-600",sold:"bg-purple-100 text-purple-600"})[e]||"bg-gray-100 text-gray-600",v=async(e=!1)=>{e?d.value=!0:i.value=!0;try{const t=await p.get("/notifications",{params:{page:e?c.value+1:1}});e?l.value=[...l.value,...t.data.data]:l.value=t.data.data,c.value=t.data.meta.current_page,g.value=t.data.meta.last_page}finally{i.value=!1,d.value=!1}},$=async e=>{e.read_at||(await p.post(`/notifications/${e.id}/read`),e.read_at=new Date().toISOString()),e.data.url&&b.push(e.data.url)},j=async()=>{try{await p.post("/notifications/read-all"),l.value=l.value.map(e=>({...e,read_at:e.read_at||new Date().toISOString()}))}catch{console.error("Failed to mark all as read")}},M=()=>{v(!0)};return B(()=>{v()}),(e,t)=>(s(),o("div",E,[a("div",G,[a("div",Q,[t[0]||(t[0]=a("h1",{class:"text-2xl font-bold text-gray-900"},"Notifications",-1)),l.value.length?(s(),o("button",{key:0,onClick:j,class:"text-sm text-primary-600 hover:underline"}," Mark all as read ")):u("",!0)]),i.value?(s(),o("div",T,[(s(),o(f,null,_(5,r=>a("div",{key:r,class:"card p-4 flex gap-4"},[...t[1]||(t[1]=[a("div",{class:"skeleton w-10 h-10 rounded-full"},null,-1),a("div",{class:"flex-1"},[a("div",{class:"skeleton h-4 w-3/4 mb-2"}),a("div",{class:"skeleton h-3 w-1/4"})],-1)])])),64))])):l.value.length?(s(),o("div",Y,[(s(!0),o(f,null,_(l.value,r=>(s(),o("div",{key:r.id,class:x(["card p-4 flex gap-4 cursor-pointer hover:shadow-md transition",r.read_at?"":"bg-primary-50 border-primary-200"]),onClick:ae=>$(r)},[a("div",{class:x(["w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0",N(r.data.type)])},[(s(),L(V(C(r.data.type)),{class:"w-5 h-5"}))],2),a("div",J,[a("p",K,m(r.data.message),1),a("p",U,m(w(r.created_at)),1)]),r.read_at?u("",!0):(s(),o("div",W))],10,H))),128))])):(s(),o("div",X,[I(F(y),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),t[2]||(t[2]=a("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No notifications",-1)),t[3]||(t[3]=a("p",{class:"text-gray-500"},"You're all caught up!",-1))])),k.value?(s(),o("div",Z,[a("button",{onClick:M,disabled:d.value,class:"btn-secondary"},m(d.value?"Loading...":"Load More"),9,ee)])):u("",!0)])]))}};export{ue as default};
