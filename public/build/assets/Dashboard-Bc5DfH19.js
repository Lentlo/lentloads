import{c as a,o as r,a as t,r as y,K,D as Q,e as G,y as I,M as X,p as H,g as c,j as m,t as o,F as x,h as p,f as _,w as v,i as N,v as Y,B as Z,J as w}from"./main-DdfwsRgo.js";import{d as O}from"./dayjs.min-iy57P9mS.js";import{r as tt}from"./relativeTime-D5nU98bY.js";import{r as st}from"./ArrowPathIcon-D574hopR.js";import{r as et,a as ot}from"./UsersIcon-BIHWEw7X.js";import{r as at}from"./TagIcon-CwL-ONAw.js";import{r as rt}from"./ClockIcon-5XHKyaL8.js";import{r as nt}from"./FlagIcon-DceU_C-n.js";import"./_commonjsHelpers-Cpj98o6Y.js";function it(A,u){return r(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M11.35 3.836c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m8.9-4.414c.376.023.75.05 1.124.08 1.131.094 1.976 1.057 1.976 2.192V16.5A2.25 2.25 0 0 1 18 18.75h-2.25m-7.5-10.5H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V18.75m-7.5-10.5h6.375c.621 0 1.125.504 1.125 1.125v9.375m-8.25-3 1.5 1.5 3-3.75"})])}function lt(A,u){return r(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"})])}const dt={class:"p-6"},ct={class:"flex items-center justify-between mb-6"},ut={class:"flex items-center gap-2"},gt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},mt={class:"card p-6 hover:shadow-md transition-shadow"},xt={class:"flex items-center justify-between"},pt={class:"text-2xl font-bold text-gray-900"},vt={class:"flex items-center gap-2 mt-1"},yt={class:"text-sm text-green-600"},ht={class:"text-xs text-gray-400"},ft={class:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center"},_t={class:"mt-3 pt-3 border-t"},bt={class:"flex justify-between text-sm"},wt={class:"font-medium"},kt={class:"card p-6 hover:shadow-md transition-shadow"},jt={class:"flex items-center justify-between"},Ct={class:"text-2xl font-bold text-gray-900"},Mt={class:"flex items-center gap-2 mt-1"},$t={class:"text-sm text-green-600"},Nt={class:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center"},At={class:"mt-3 pt-3 border-t"},Lt={class:"flex justify-between text-sm"},Vt={class:"font-medium text-green-600"},Ut={class:"flex items-center justify-between"},Bt={class:"text-2xl font-bold text-gray-900"},Dt={class:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center"},Rt={class:"flex items-center justify-between"},St={class:"text-2xl font-bold text-gray-900"},Tt={class:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center"},Ft={class:"mt-3 pt-3 border-t"},Pt={class:"flex justify-between text-sm"},zt={class:"font-medium"},Ht={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8"},Zt={class:"card p-6"},Ot={class:"h-48"},Wt={key:0,class:"flex items-end justify-between h-full gap-1"},qt={class:"absolute -top-8 left-1/2 -translate-x-1/2 bg-gray-800 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap"},Et={key:1,class:"h-full flex items-center justify-center text-gray-400"},Jt={class:"flex justify-between mt-2 text-xs text-gray-500"},Kt={class:"card p-6"},Qt={class:"h-48"},Gt={key:0,class:"flex items-end justify-between h-full gap-1"},It={class:"absolute -top-8 left-1/2 -translate-x-1/2 bg-gray-800 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap"},Xt={key:1,class:"h-full flex items-center justify-center text-gray-400"},Yt={class:"flex justify-between mt-2 text-xs text-gray-500"},ts={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8"},ss={class:"card p-6"},es={class:"space-y-3"},os={class:"flex-1"},as={class:"flex justify-between text-sm mb-1"},rs={class:"text-gray-700"},ns={class:"font-medium"},is={class:"h-2 bg-gray-100 rounded-full overflow-hidden"},ls={key:0,class:"text-center text-gray-400 py-4"},ds={class:"card p-6"},cs={class:"space-y-3"},us={class:"w-6 h-6 bg-gray-100 rounded-full flex items-center justify-center text-xs font-medium text-gray-600"},gs={class:"flex-1"},ms={class:"flex justify-between text-sm mb-1"},xs={class:"text-gray-700"},ps={class:"font-medium"},vs={class:"h-2 bg-gray-100 rounded-full overflow-hidden"},ys={key:0,class:"text-center text-gray-400 py-4"},hs={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},fs={class:"card"},_s={class:"p-4 border-b flex items-center justify-between"},bs={class:"divide-y max-h-80 overflow-y-auto"},ws=["onClick"],ks={class:"flex-1 min-w-0"},js={class:"font-medium text-gray-900 truncate text-sm"},Cs={class:"text-xs text-gray-500"},Ms={key:0,class:"p-8 text-center text-gray-500"},$s={class:"card"},Ns={class:"p-4 border-b flex items-center justify-between"},As={class:"divide-y max-h-80 overflow-y-auto"},Ls={class:"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center text-gray-600 font-medium"},Vs={class:"flex-1 min-w-0"},Us={class:"font-medium text-gray-900 truncate text-sm"},Bs={class:"text-xs text-gray-500"},Ds={class:"text-xs text-gray-400"},Rs={key:0,class:"p-8 text-center text-gray-500"},Ss={class:"card"},Ts={class:"p-4 border-b flex items-center justify-between"},Fs={class:"divide-y max-h-80 overflow-y-auto"},Ps={class:"flex items-center justify-between mb-2"},zs={class:"badge bg-red-100 text-red-700 text-xs"},Hs={class:"text-xs text-gray-500"},Zs={class:"text-xs text-gray-600 line-clamp-2"},Os={class:"text-xs text-gray-400 mt-1"},Ws={key:0,class:"p-8 text-center text-gray-500"},qs={class:"mt-8"},Es={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},Js={class:"text-xs text-gray-500 mt-1"},Ks={class:"text-xs text-gray-500 mt-1"},ae={__name:"Dashboard",setup(A){O.extend(tt);const u=y({}),k=y([]),j=y([]),C=y([]),h=y("7"),M=y(!1),n=K({listings:[],listingsMax:0,users:[],usersMax:0,categories:[],cities:[]}),L=i=>O(i).fromNow(),W=i=>({active:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",rejected:"bg-red-100 text-red-800",sold:"bg-blue-100 text-blue-800",expired:"bg-gray-100 text-gray-800"})[i]||"bg-gray-100 text-gray-800",V=(i,s)=>s?Math.max(i/s*100,5):5,q=i=>{if(!n.categories.length)return 0;const s=Math.max(...n.categories.map(l=>l.count));return i/s*100},E=i=>{if(!n.cities.length)return 0;const s=Math.max(...n.cities.map(l=>l.count));return i/s*100},U=async()=>{var i,s,l,f;try{const g=await Z.get("/admin/dashboard");u.value=((i=g.data.data)==null?void 0:i.stats)||g.data.stats||{},k.value=((s=g.data.data)==null?void 0:s.recent_listings)||g.data.recent_listings||[],j.value=((l=g.data.data)==null?void 0:l.recent_users)||g.data.recent_users||[],C.value=((f=g.data.data)==null?void 0:f.pending_reports)||g.data.pending_reports||[]}catch(g){console.error("Failed to fetch dashboard data",g)}},$=async()=>{try{const i=await Z.get("/admin/stats",{params:{period:h.value}}),s=i.data.data||i.data;n.listings=s.listings_chart||[],n.listingsMax=Math.max(...n.listings.map(l=>l.count),1),n.users=s.users_chart||[],n.usersMax=Math.max(...n.users.map(l=>l.count),1),n.categories=s.category_distribution||[],n.cities=s.top_cities||[]}catch(i){console.error("Failed to fetch stats",i)}},J=async()=>{M.value=!0,await Promise.all([U(),$()]),M.value=!1};return Q(()=>{U(),$()}),(i,s)=>{var f,g,B,D,R,S,T,F,P,z;const l=G("router-link");return r(),a("div",dt,[t("div",ct,[s[5]||(s[5]=t("h1",{class:"text-2xl font-bold text-gray-900"},"Dashboard",-1)),t("div",ut,[I(t("select",{"onUpdate:modelValue":s[0]||(s[0]=e=>h.value=e),onChange:$,class:"text-sm border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"},[...s[4]||(s[4]=[t("option",{value:"7"},"Last 7 days",-1),t("option",{value:"14"},"Last 14 days",-1),t("option",{value:"30"},"Last 30 days",-1),t("option",{value:"90"},"Last 90 days",-1)])],544),[[X,h.value]]),t("button",{onClick:J,class:H(["p-2 text-gray-600 hover:bg-gray-100 rounded-lg",{"animate-spin":M.value}])},[c(m(st),{class:"w-5 h-5"})],2)])]),t("div",gt,[t("div",mt,[t("div",xt,[t("div",null,[s[6]||(s[6]=t("p",{class:"text-sm text-gray-500"},"Total Users",-1)),t("p",pt,o(((f=u.value.users)==null?void 0:f.total)||0),1),t("div",vt,[t("span",yt,"+"+o(((g=u.value.users)==null?void 0:g.new_today)||0)+" today",1),t("span",ht,o(((B=u.value.users)==null?void 0:B.new_this_week)||0)+" this week",1)])]),t("div",ft,[c(m(et),{class:"w-6 h-6 text-blue-600"})])]),t("div",_t,[t("div",bt,[s[7]||(s[7]=t("span",{class:"text-gray-500"},"Active",-1)),t("span",wt,o(((D=u.value.users)==null?void 0:D.active)||0),1)])])]),t("div",kt,[t("div",jt,[t("div",null,[s[8]||(s[8]=t("p",{class:"text-sm text-gray-500"},"Listings",-1)),t("p",Ct,o(((R=u.value.listings)==null?void 0:R.total)||0),1),t("div",Mt,[t("span",$t,"+"+o(((S=u.value.listings)==null?void 0:S.new_today)||0)+" today",1)])]),t("div",Nt,[c(m(at),{class:"w-6 h-6 text-green-600"})])]),t("div",At,[t("div",Lt,[s[9]||(s[9]=t("span",{class:"text-gray-500"},"Active",-1)),t("span",Vt,o(((T=u.value.listings)==null?void 0:T.active)||0),1)])])]),t("div",{class:"card p-6 hover:shadow-md transition-shadow cursor-pointer",onClick:s[1]||(s[1]=e=>i.$router.push("/admin/listings?status=pending"))},[t("div",Ut,[t("div",null,[s[10]||(s[10]=t("p",{class:"text-sm text-gray-500"},"Pending Approval",-1)),t("p",Bt,o(((F=u.value.listings)==null?void 0:F.pending)||0),1),s[11]||(s[11]=t("p",{class:"text-sm text-yellow-600 mt-1"},"Needs attention",-1))]),t("div",Dt,[c(m(rt),{class:"w-6 h-6 text-yellow-600"})])]),s[12]||(s[12]=t("div",{class:"mt-3 pt-3 border-t"},[t("span",{class:"text-sm text-primary-600 hover:underline"},"Review pending â†’")],-1))]),t("div",{class:"card p-6 hover:shadow-md transition-shadow cursor-pointer",onClick:s[2]||(s[2]=e=>i.$router.push("/admin/reports"))},[t("div",Rt,[t("div",null,[s[13]||(s[13]=t("p",{class:"text-sm text-gray-500"},"Open Reports",-1)),t("p",St,o(((P=u.value.reports)==null?void 0:P.pending)||0),1),s[14]||(s[14]=t("p",{class:"text-sm text-red-600 mt-1"},"Requires review",-1))]),t("div",Tt,[c(m(nt),{class:"w-6 h-6 text-red-600"})])]),t("div",Ft,[t("div",Pt,[s[15]||(s[15]=t("span",{class:"text-gray-500"},"Total",-1)),t("span",zt,o(((z=u.value.reports)==null?void 0:z.total)||0),1)])])])]),t("div",Ht,[t("div",Zt,[s[17]||(s[17]=t("h3",{class:"font-semibold text-gray-900 mb-4"},"New Listings",-1)),t("div",Ot,[n.listings.length?(r(),a("div",Wt,[(r(!0),a(x,null,p(n.listings,(e,d)=>(r(),a("div",{key:d,class:"flex-1 bg-primary-100 hover:bg-primary-200 rounded-t transition-colors relative group",style:w({height:V(e.count,n.listingsMax)+"%"})},[t("div",qt,o(e.count)+" listings ",1)],4))),128))])):(r(),a("div",Et," No data for selected period "))]),t("div",Jt,[t("span",null,o(h.value)+" days ago",1),s[16]||(s[16]=t("span",null,"Today",-1))])]),t("div",Kt,[s[19]||(s[19]=t("h3",{class:"font-semibold text-gray-900 mb-4"},"New Users",-1)),t("div",Qt,[n.users.length?(r(),a("div",Gt,[(r(!0),a(x,null,p(n.users,(e,d)=>(r(),a("div",{key:d,class:"flex-1 bg-blue-100 hover:bg-blue-200 rounded-t transition-colors relative group",style:w({height:V(e.count,n.usersMax)+"%"})},[t("div",It,o(e.count)+" users ",1)],4))),128))])):(r(),a("div",Xt," No data for selected period "))]),t("div",Yt,[t("span",null,o(h.value)+" days ago",1),s[18]||(s[18]=t("span",null,"Today",-1))])])]),t("div",ts,[t("div",ss,[s[20]||(s[20]=t("h3",{class:"font-semibold text-gray-900 mb-4"},"Listings by Category",-1)),t("div",es,[(r(!0),a(x,null,p(n.categories,e=>{var d;return r(),a("div",{key:e.category_id,class:"flex items-center gap-3"},[t("div",os,[t("div",as,[t("span",rs,o(((d=e.category)==null?void 0:d.name)||"Unknown"),1),t("span",ns,o(e.count),1)]),t("div",is,[t("div",{class:"h-full bg-primary-500 rounded-full",style:w({width:q(e.count)+"%"})},null,4)])])])}),128)),n.categories.length?_("",!0):(r(),a("div",ls," No category data "))])]),t("div",ds,[s[21]||(s[21]=t("h3",{class:"font-semibold text-gray-900 mb-4"},"Top Cities",-1)),t("div",cs,[(r(!0),a(x,null,p(n.cities,(e,d)=>(r(),a("div",{key:e.city,class:"flex items-center gap-3"},[t("span",us,o(d+1),1),t("div",gs,[t("div",ms,[t("span",xs,o(e.city||"Unknown"),1),t("span",ps,o(e.count)+" listings",1)]),t("div",vs,[t("div",{class:"h-full bg-green-500 rounded-full",style:w({width:E(e.count)+"%"})},null,4)])])]))),128)),n.cities.length?_("",!0):(r(),a("div",ys," No city data "))])])]),t("div",hs,[t("div",fs,[t("div",_s,[s[23]||(s[23]=t("h2",{class:"font-semibold text-gray-900"},"Recent Listings",-1)),c(l,{to:"/admin/listings",class:"text-sm text-primary-600 hover:underline"},{default:v(()=>[...s[22]||(s[22]=[N(" View all ",-1)])]),_:1})]),t("div",bs,[(r(!0),a(x,null,p(k.value,e=>{var d;return r(),a("div",{key:e.id,class:"p-4 flex items-center gap-3 hover:bg-gray-50 cursor-pointer",onClick:b=>i.$router.push(`/admin/listings?search=${e.title}`)},[t("div",ks,[t("p",js,o(e.title),1),t("p",Cs,"by "+o((d=e.user)==null?void 0:d.name),1)]),t("span",{class:H(["badge text-xs",W(e.status)])},o(e.status),3)],8,ws)}),128)),k.value.length?_("",!0):(r(),a("div",Ms," No recent listings "))])]),t("div",$s,[t("div",Ns,[s[25]||(s[25]=t("h2",{class:"font-semibold text-gray-900"},"Recent Users",-1)),c(l,{to:"/admin/users",class:"text-sm text-primary-600 hover:underline"},{default:v(()=>[...s[24]||(s[24]=[N(" View all ",-1)])]),_:1})]),t("div",As,[(r(!0),a(x,null,p(j.value,e=>{var d,b;return r(),a("div",{key:e.id,class:"p-4 flex items-center gap-3 hover:bg-gray-50"},[t("div",Ls,o(((b=(d=e.name)==null?void 0:d.charAt(0))==null?void 0:b.toUpperCase())||"?"),1),t("div",Vs,[t("p",Us,o(e.name),1),t("p",Bs,o(e.email),1)]),t("span",Ds,o(L(e.created_at)),1)])}),128)),j.value.length?_("",!0):(r(),a("div",Rs," No recent users "))])]),t("div",Ss,[t("div",Ts,[s[27]||(s[27]=t("h2",{class:"font-semibold text-gray-900"},"Pending Reports",-1)),c(l,{to:"/admin/reports",class:"text-sm text-primary-600 hover:underline"},{default:v(()=>[...s[26]||(s[26]=[N(" View all ",-1)])]),_:1})]),t("div",Fs,[(r(!0),a(x,null,p(C.value,e=>{var d;return r(),a("div",{key:e.id,class:"p-4 hover:bg-gray-50 cursor-pointer",onClick:s[3]||(s[3]=b=>i.$router.push("/admin/reports"))},[t("div",Ps,[t("span",zs,o(e.reason),1),t("span",Hs,o(L(e.created_at)),1)]),t("p",Zs,o(e.description||"No description provided"),1),t("p",Os," By "+o((d=e.reporter)==null?void 0:d.name),1)])}),128)),C.value.length?_("",!0):(r(),a("div",Ws," No pending reports "))])])]),t("div",qs,[s[34]||(s[34]=t("h2",{class:"font-semibold text-gray-900 mb-4"},"Quick Actions",-1)),t("div",Es,[c(l,{to:"/admin/listings?status=pending",class:"card p-4 text-center hover:shadow-md transition group"},{default:v(()=>{var e;return[c(m(it),{class:"w-8 h-8 text-yellow-600 mx-auto mb-2 group-hover:scale-110 transition-transform"}),s[28]||(s[28]=t("p",{class:"font-medium"},"Review Listings",-1)),t("p",Js,o(((e=u.value.listings)==null?void 0:e.pending)||0)+" pending",1)]}),_:1}),c(l,{to:"/admin/users",class:"card p-4 text-center hover:shadow-md transition group"},{default:v(()=>{var e;return[c(m(lt),{class:"w-8 h-8 text-blue-600 mx-auto mb-2 group-hover:scale-110 transition-transform"}),s[29]||(s[29]=t("p",{class:"font-medium"},"Manage Users",-1)),t("p",Ks,o(((e=u.value.users)==null?void 0:e.total)||0)+" users",1)]}),_:1}),c(l,{to:"/admin/categories",class:"card p-4 text-center hover:shadow-md transition group"},{default:v(()=>[c(m(ot),{class:"w-8 h-8 text-green-600 mx-auto mb-2 group-hover:scale-110 transition-transform"}),s[30]||(s[30]=t("p",{class:"font-medium"},"Categories",-1)),s[31]||(s[31]=t("p",{class:"text-xs text-gray-500 mt-1"},"Organize listings",-1))]),_:1}),c(l,{to:"/admin/settings",class:"card p-4 text-center hover:shadow-md transition group"},{default:v(()=>[c(m(Y),{class:"w-8 h-8 text-gray-600 mx-auto mb-2 group-hover:scale-110 transition-transform"}),s[32]||(s[32]=t("p",{class:"font-medium"},"Settings",-1)),s[33]||(s[33]=t("p",{class:"text-xs text-gray-500 mt-1"},"Site configuration",-1))]),_:1})])])])}}};export{ae as default};
