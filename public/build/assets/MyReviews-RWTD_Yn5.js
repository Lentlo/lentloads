import{r as c,D as Y,E as U,m as q,n as A,c as l,o,a as t,g as m,I as h,t as r,F as _,j as p,d as f,e as C,k as F,B as G,q as K,y as L,h as P,w as W,v as H,K as S}from"./main-Dzo1rjju.js";import{d as J}from"./dayjs.min-Bof1u0Bp.js";import{r as R}from"./StarIcon-CpRfxzT-.js";const O={class:"min-h-screen bg-gray-50 py-6"},Q={class:"container-app max-w-2xl"},X={class:"flex gap-4 mb-6"},Z={key:0,class:"card p-6 mb-6"},I={class:"flex items-center gap-6"},ee={class:"text-center"},te={class:"text-4xl font-bold text-primary-600"},se={class:"flex justify-center mt-1"},ae={class:"text-sm text-gray-500 mt-1"},le={class:"flex-1"},oe={class:"text-sm w-8"},ne={class:"flex-1 bg-gray-200 rounded-full h-2"},re={class:"text-sm text-gray-500 w-8"},ie={key:1,class:"space-y-4"},de={key:2,class:"space-y-4"},ce={class:"flex items-start gap-4"},ue=["src","alt"],ve={class:"flex-1"},me={class:"flex items-center justify-between"},_e={class:"flex items-center gap-1 mt-1"},pe={class:"text-sm text-gray-500"},ye={key:0,class:"text-gray-600 mt-2"},xe={key:1,class:"text-sm text-gray-500 mt-2"},ge={key:2,class:"mt-4 pl-4 border-l-2 border-gray-200"},he={class:"text-sm text-gray-600"},fe={key:3,class:"mt-4"},be=["onClick"],ke={key:4,class:"mt-4"},we=["onUpdate:modelValue"],Ce={class:"flex gap-2 mt-2"},Re=["onClick"],Me=["onClick"],Ve={key:3,class:"card p-12 text-center"},$e={class:"text-gray-500"},Ye={__name:"MyReviews",setup(Ne){const b=c(!0),n=c("received"),y=c([]),u=Y({received:0,given:0}),k=c(0),w=c({}),d=c([]),x=Y({}),T=a=>J(a).format("MMM D, YYYY"),z=a=>{const s=u.received;return s?(w.value[a]||0)/s*100:0},M=async()=>{b.value=!0;try{const a=await F.get("/reviews/my",{params:{type:n.value}});y.value=a.data.data,n.value==="received"&&a.data.stats&&(k.value=a.data.stats.average||0,w.value=a.data.stats.breakdown||{},u.received=a.data.stats.total||0)}finally{b.value=!1}},E=async a=>{const s=x[a];if(s!=null&&s.trim())try{await F.post(`/reviews/${a}/respond`,{response:s});const v=y.value.find(e=>e.id===a);v&&(v.seller_response=s),d.value=d.value.filter(e=>e!==a),delete x[a],S.success("Response added")}catch{S.error("Failed to add response")}};return U(n,()=>{M()}),q(()=>{M()}),(a,s)=>{const v=A("router-link");return o(),l("div",O,[t("div",Q,[s[5]||(s[5]=t("h1",{class:"text-2xl font-bold text-gray-900 mb-6"},"My Reviews",-1)),t("div",X,[t("button",{onClick:s[0]||(s[0]=e=>n.value="received"),class:h(["px-4 py-2 rounded-lg font-medium",n.value==="received"?"bg-primary-600 text-white":"bg-white text-gray-600"])}," Received ("+r(u.received)+") ",3),t("button",{onClick:s[1]||(s[1]=e=>n.value="given"),class:h(["px-4 py-2 rounded-lg font-medium",n.value==="given"?"bg-primary-600 text-white":"bg-white text-gray-600"])}," Given ("+r(u.given)+") ",3)]),n.value==="received"?(o(),l("div",Z,[t("div",I,[t("div",ee,[t("p",te,r(k.value),1),t("div",se,[(o(),l(_,null,p(5,e=>f(C(R),{key:e,class:h(["w-5 h-5",e<=Math.round(k.value)?"text-yellow-400 fill-current":"text-gray-300"])},null,8,["class"])),64))]),t("p",ae,r(u.received)+" reviews",1)]),t("div",le,[(o(),l(_,null,p(5,e=>t("div",{key:e,class:"flex items-center gap-2 mb-1"},[t("span",oe,r(6-e),1),t("div",ne,[t("div",{class:"bg-yellow-400 h-2 rounded-full",style:G({width:z(6-e)+"%"})},null,4)]),t("span",re,r(w.value[6-e]||0),1)])),64))])])])):m("",!0),b.value?(o(),l("div",ie,[(o(),l(_,null,p(3,e=>t("div",{key:e,class:"card p-4"},[...s[2]||(s[2]=[K('<div class="flex gap-4"><div class="skeleton w-10 h-10 rounded-full"></div><div class="flex-1"><div class="skeleton h-4 w-1/4 mb-2"></div><div class="skeleton h-3 w-full"></div></div></div>',1)])])),64))])):y.value.length?(o(),l("div",de,[(o(!0),l(_,null,p(y.value,e=>{var V,$,N,j,B,D;return o(),l("div",{key:e.id,class:"card p-4"},[t("div",ce,[t("img",{src:n.value==="received"?(V=e.reviewer)==null?void 0:V.avatar_url:($=e.reviewed)==null?void 0:$.avatar_url,alt:n.value==="received"?(N=e.reviewer)==null?void 0:N.name:(j=e.reviewed)==null?void 0:j.name,class:"w-10 h-10 rounded-full object-cover"},null,8,ue),t("div",ve,[t("div",me,[t("div",null,[f(v,{to:`/user/${n.value==="received"?(B=e.reviewer)==null?void 0:B.id:(D=e.reviewed)==null?void 0:D.id}`,class:"font-semibold text-gray-900 hover:text-primary-600"},{default:L(()=>{var i,g;return[P(r(n.value==="received"?(i=e.reviewer)==null?void 0:i.name:(g=e.reviewed)==null?void 0:g.name),1)]}),_:2},1032,["to"]),t("div",_e,[(o(),l(_,null,p(5,i=>f(C(R),{key:i,class:h(["w-4 h-4",i<=e.rating?"text-yellow-400 fill-current":"text-gray-300"])},null,8,["class"])),64))])]),t("span",pe,r(T(e.created_at)),1)]),e.comment?(o(),l("p",ye,r(e.comment),1)):m("",!0),e.listing?(o(),l("p",xe," Re: "+r(e.listing.title),1)):m("",!0),e.seller_response?(o(),l("div",ge,[s[3]||(s[3]=t("p",{class:"text-sm font-medium text-gray-900"},"Your response:",-1)),t("p",he,r(e.seller_response),1)])):n.value==="received"&&!d.value.includes(e.id)?(o(),l("div",fe,[t("button",{onClick:i=>d.value.push(e.id),class:"text-sm text-primary-600 hover:underline"}," Add response ",8,be)])):m("",!0),d.value.includes(e.id)?(o(),l("div",ke,[W(t("textarea",{"onUpdate:modelValue":i=>x[e.id]=i,rows:"2",class:"input text-sm",placeholder:"Write your response..."},null,8,we),[[H,x[e.id]]]),t("div",Ce,[t("button",{onClick:i=>d.value=d.value.filter(g=>g!==e.id),class:"btn-secondary btn-sm"}," Cancel ",8,Re),t("button",{onClick:i=>E(e.id),class:"btn-primary btn-sm"}," Submit ",8,Me)])])):m("",!0)])])])}),128))])):(o(),l("div",Ve,[f(C(R),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s[4]||(s[4]=t("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No reviews yet",-1)),t("p",$e,r(n.value==="received"?"Complete transactions to receive reviews":"Rate your transactions"),1)]))])])}}};export{Ye as default};
